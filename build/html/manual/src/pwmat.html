<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; q-cad 0.1 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="PWmat" href="../../PWmat.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> q-cad
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../PWmat.html">PWmat</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../PWmat.html#download">download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PWmat.html#installation">installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../PWmat.html#manual">manual</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-files">Input files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#etot-input">etot.input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-input-setting">Default input setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#atom-config">atom.config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pseudo-potential-files-atom-xxxx-upf">Pseudo-potential files: Atom.XXXX.UPF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-kpt-out-kpt">IN.KPT(OUT.KPT)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-symm-out-symm">IN.SYMM(OUT.SYMM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-input-files">Other input files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#output-files">Output files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#standard-output">Standard output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#report">REPORT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relaxsteps">RELAXSTEPS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neb-barrier">NEB.BARRIER</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mdsteps">MDSTEPS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#movement">MOVEMENT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-output-files">other output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-basic-calculations">The basic calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#self-consistent-calculations-job-scf">Self-consistent calculations(JOB=SCF)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#none-self-consist-calculations-job-nonscf">None self-consist calculations(JOB=NONSCF)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#density-of-states-calculations-job-dos">Density of States Calculations(JOB=DOS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#atomic-relaxation-job-relax">Atomic Relaxation(JOB=RELAX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nudged-elastic-band-calculations-job-neb">Nudged Elastic Band Calculations(JOB=NEB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecular-dynamics-job-md">Molecular Dynamics(JOB=MD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#noncollinear-magnetic-moment">Noncollinear magnetic moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#f-states">f-states</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optical-spectrum">optical spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compatible-runs-with-pwscf">Compatible runs with PWSCF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utility-programs">utility programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#format-conversion">Format conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-visualization">Data visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-processing">post processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#work-flow-and-websites">Work Flow and Websites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#work-flow">Work Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#useful-websites">Useful Websites</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tddft-and-namd-manual-and-examples">TDDFT and NAMD Manual and Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#job-tddft">JOB=TDDFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tddft-detail">TDDFT_DETAIL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#out-tddft-1">OUT.TDDFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tddft-space-1">TDDFT_SPACE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-a-field-1">IN.A_FIELD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tddft-time-1">TDDFT_TIME</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-occ-in-occ-2">IN.OCC/IN.OCC_2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-cc-in-cc-2">IN.CC/IN.CC_2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#md-detail-md-mstep-dt-temp1-temp2">MD_DETAIL = MD, MSTEP, DT, TEMP1, TEMP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restart">RESTART</a></li>
<li class="toctree-l4"><a class="reference internal" href="#show-results">SHOW_RESULTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stability">Stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-field-x-1">add_field.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#job-namd">JOB=NAMD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-occ-t">IN.OCC_T</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-tddftopt">IN.TDDFTOPT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#more-output-files">MORE OUTPUT FILES</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../PWmat.html#module">module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PWmat.html#utility">utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PWmat.html#cases">cases</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">q-cad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../PWmat.html">PWmat</a> &raquo;</li>
      <li>Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/manual/src/pwmat.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>PWmat is a plane wave pseudopotential package for density functional
theory (DFT) calculations. The best explanation of the algorithms used
in PWmat can be found in Ref.:raw-latex:<cite>cite{pwmat1,pwmat2}</cite>. These
two papers have more technical details than this manual. PWmat can
perform the following calculations (indicated by the “JOB” flag in
etot.input): SCF (self-consistent-field calculation); NONSCF
(non-self-consistent-field calculations, e.g. for band structure or
density of state calculations); DOS (density of state calculation, which
is usually done following a NONSCF or SCF calculation, it is used to do
partial density of state, or k-point interpolation); RELAX (atomic
relaxation calculation and cell relaxation); EGGFIT (a preprocess
fitting procedure to remove the egghead problem in RELAX); MD (ab initio
molecular dynamics calculation); NEB (nudged elastic band calculation
for barrier heights); TDDFT (real-time time dependent density functional
theory calculations); NAMD (non-adiabatic molecular dynamics, which is
used to study carrier dynamics following a Born-Oppenheimer molecular
dynamics); POTENTIAL (generate DFT potential from input charge density);
SCFEP (electron-phonon coupling constant calculation for a given pair of
input electron states for all the phonon modes); WKM (a special Wannier
Koopmann’s method calculation for DFT band gap correction).</p>
<p>PWmat is designed to run efficiently on CPU/GPU processors. In a GPU
run, one CPU is bundled with one GPU. The package also comes with
well-tested pseudopotential libraries in the upf (unified
pseudopotential format) for norm-conserving pseudopotentials
(Atom.NCPP.UPF) and ultrasoft pseudopotentials (Atom.USPP.UPF). However,
not all the functionalities work for ultrasoft pseudopotentials, and
there is usually no advantages in terms of speed to use ultrasoft
pseudopotentials. So, we encourage user to use norm conserving
pseudopotential. The recent “norm conserving vanderbilt pseudopotential”
(NCVP) released by D.R. Hamann made the norm conserving pseudopotential
very reliable. PWmat currently does not support the “projector augmented
wave” (PAW) pseudopotential. PWmat is fully compatible with the popular
open source code “Quantum Espresso”(QE) module PWscf (with exchangeable
data files). For example, it can generate the QE output file (using
option PWSCF_OUTPUT = T), this makes it possible to use other open
source packages which already have the IO with the QE output (for
example, Wannier90 for Wannier function calculation, and YAMBO for GW
calculation). Nevertheless, PWmat can be an order of magnitude faster
than pwscf since it runs on GPU.</p>
<p>Besides to run PWmat alone, LongXun Inc. has prepared many “modules”
(please check the <a class="reference external" href="http://www.pwmat.com/module-download">http://www.pwmat.com/module-download</a>). These modules
are recipes to carry out actual calculations for different scientific
tasks. For example, this could be how to calculate defect level
energies, or how to calculate the catalytic process in electrochemistry.
These are designed as tutorials to help users to finish the actual
tasks. It can also be packages for more sophisticated tasks, e.g., using
calyso for structure search; pypwmat for phonon spectrum calculation, or
using YAMBO for GW calculation. The corresponding codes are provided on
the website. But the Modules can also be step-by-step procedures, to
teach the user how to study a specific scientific problem using PWmat.
We will develop more modules in the future, we also welcome our users to
provide their own modules.</p>
<p>In order to run PWmat, one needs to provide the following input files in
the running directory: etot.input (the PWmat control file); atom.config
(the atomic position file, the name of this file is defined inside
etot.input); element.upf (pseudopotential files, they can be copied from
the provided pseudopotential libraries, you can get pseudopotential
libraries from PWmat website: <a class="reference external" href="http://www.pwmat.com/potential-download">http://www.pwmat.com/potential-download</a>).</p>
<p>Optionally, one might also need to provide IN.KPT (k-point file),
IN.SYMM (symmetry file), IN.VR (potential input file), IN.WG (wave
function input file) and IN.RHO (charge density input file). These files
can be generated from the previous calculations (copied from OUT.KPT,
OUT.SYMM, OUT.VR, OUT.WG, OUT.RHO of the previous runs). The k-points
can also be specified using the Monkhorst-Pack parameter MP_N123 in
etot.input. In that case, the IN.KPT and IN.SYMM will not be used,
instead, the k-points and symmetry (space group) operations will be
generated during the run, and they will be output in OUT.KPT, OUT.SYMM.
If no IN.SYMM is specified, the PWmat will automatically check the
symmetry, generate the symmetry file and the reduced k-point file, and
output them in OUT.KPT and OUT.SYMM. Special attention needs to be paied
for the symmetry operation when magnetic system is calculated, e.g.,
when calculating antiferromagnetic system, since the symmetry operation
might ignore the magnetic moment difference between different atoms.</p>
<p>We also provided many utility programs, mostly for preparation of PWmat
input (e.g., format conversion from the format of other packages to
PWmat atom.config format), and post processing (e.g., for plotting
charge density and wave functions). There are also relatively heavy
packages are also povided in utility package, e.g., for the nonadiabaitc
molecular dynamics simulation after the JOB=NAMD run.</p>
<p>There are three steps to use PWmat:</p>
<ol class="arabic simple">
<li><p>Prepare atom.config, etot.input, and copy Atom.XXXX.UPF;</p></li>
<li><p>Run PWmat;</p></li>
<li><p>Post-process, visualization.</p></li>
</ol>
<p>We provide suggestions for how to generate atom.config, e.g., through
open-source visualization tools. One can also write atom.config by hand.
The etot.input (which tells PWmat what to do) can be very simple,
consisted with only a few lines (e.g., 4 lines, see below) while other
PW calculation parameters will be provided by default. In order to see a
long version of etot.input for manual editing, one can simply run PWmat
itself, it will generate the REPORT file. The header part of the REPORT
file is the long version of etot.input. If you want, you can copy the
REPORT to etot.input, delete the lower part of REPORT, then run PWmat.
In this way, you can see the different default parameter used, so you
can edit them if you like. For most cases, a short etot.input (4-5
lines) will be sufficient. That will use all the default values for
other parameters. At most cases, in additional to the required 4-5 lines
in the etot.input file, one might want to consider to choose: PRECISION
(single, double, auto), which controls the precision of floating point
operation; ACCURACY (norm, high, veryhigh), which controls the plane
wave expansion cut-off parameters (e.g., the Ecut,Ecut2,Ecut2L);
CONVERGENCE (easy, difficult),which controls the self-consistent
calculation convergence parameters. For most challenging run, one can
set: PRECISION=double; ACCURACY=high, CONVERGENCE=difficult. Our default
setting is: PRECISION=single; ACCURACY=norm; CONVERGENCE=easy. This
setting will work for most cases and pseudopotentials, and it will be
fastest. However, for sg15, pd03 pseudopotentials for atomic relaxation
runs, we suggest to use ACCURACY=high to avoid the egghead problem.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span> <span class="o">=</span> <span class="n">SCF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">NCPP</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>We suggest the following specific steps to run PWmat, from the beginning
to the end.</p>
<ol class="arabic simple">
<li><p>Prepare atomic position file atom.config from online database, or/and
visualization packages (e.g., VESTA; Avogadro). The output system
file format from these packages could be: system.xsf, or system.vasp.</p></li>
<li><p>Convert the system.xsf, system.vasp format into atom.config by
running our serial utility code: “<span class="math notranslate nohighlight">\(&gt;\)</span>xsf2config.x <span class="math notranslate nohighlight">\(&lt;\)</span>
system.xsf; <span class="math notranslate nohighlight">\(&gt;\)</span>poscar2config.x <span class="math notranslate nohighlight">\(&lt;\)</span> system.vasp”. It
will generate atom.config file. Note, atom.config can also be
prepared by hand, or user’s own software.</p></li>
<li><p>Prepare etot.input (see detail explanation in the next
section<a class="reference external" href="#section:etot.input">2.1</a>).</p></li>
<li><p>Run PWmat, e.g., “<span class="math notranslate nohighlight">\(&gt;\)</span>mpirun -np Np PWmat” (or just
“<span class="math notranslate nohighlight">\(&gt;\)</span>PWmat <span class="math notranslate nohighlight">\(&gt;\)</span> out &amp;” when there is only one GPU
avaliable in the machine). Note, Np: the number of GPU/CPU
processors, must be equal to NODE1*NODE2. In our code, one CPU is
bundled with one GPU. You can also use &gt;qsub job.sh, for torque job
submission on Mstation.</p></li>
<li><p>Post-processing, e.g., “<span class="math notranslate nohighlight">\(&gt;\)</span>convert_from_config.x <span class="math notranslate nohighlight">\(&lt;\)</span>
MOVEMENT” or “<span class="math notranslate nohighlight">\(&gt;\)</span> convert_from_config.x <span class="math notranslate nohighlight">\(&lt;\)</span> atom.config”
or “<span class="math notranslate nohighlight">\(&gt;\)</span>convert_from_config.x <span class="math notranslate nohighlight">\(&lt;\)</span> final.config”, will
change the .config, or MOVEMENT file to .xyz, and .xsf file for
visualization. One can also run: “<span class="math notranslate nohighlight">\(&gt;\)</span>convert_rho.x OUT.RHO”
() to generate RHO.xsf for isosurface plot of the charge density).</p></li>
<li><p>Visualize the structure, or make an animation with the .xyz and .xsf
file, using: VMD to watch the animation, and VEST to view one
configuration.</p></li>
</ol>
<p>For Mstation users, all the above programs are pre-installed in the
Mstation.</p>
<p>As discussed above, besides the main code PWmat, we also provide many
utility codes ( poscar2config.x, convert_from_config.x, etc). Our
utility programs, for which the source codes are available to the users,
are an important part of our package. It provides many post-processing
functions, and also tools for how to manipulate the output of PWmat.
These tools include: how to calculate density of state and optical
absorption spectrum using k-point interpolation; how to calculate the
optical coupling constant (oscillator strength) between different
states; how to carry out the non-adiabatic MD using the NAMD results;
how to plot out the charge density; how to plot the wave functions. For
more detailed information, please refer to PWmat website
(<a class="reference external" href="http://www.pwmat.com/utility-download">http://www.pwmat.com/utility-download</a>).</p>
<p>In the online page (<a class="reference external" href="http://www.pwmat.com:3389/#/">http://www.pwmat.com:3389/#/</a>), we provide detail
tutorials for how to use a few open-source visualization software
packages, both for preparing the input files (pre-processing), and
analyzing and viewing the results (post-processing). (). In the PWmat2.0
releasing package, we also include one directory: EXAMPLES, which
contains example cases for carrying out different JOBs. The beginner can
repeat these examples, and get familiar with PWmat. We also
pre-installed open-source visualization tools (VESTA, Avogadro) on
Mstation, and we provide the utility routines to link them together, to
convert the PWmat output file into the formatted readable by these
visualization packages. Please check the workflow in
<a class="reference external" href="#appendix:workflow">7.1</a>.</p>
</div>
<div class="section" id="input-files">
<h1>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h1>
<p>PWmat needs a few basic input files to start the calculation:
atom.config, etot.input, and element.upf (pseudopotential files). While
the pseudopotential files can be copied from the library for the
required atoms, atom.config and etot.input have to be prepared
specifically for the calculation. In the following, we explain the long
version of the etot.input and atom.config files.</p>
<div class="section" id="etot-input">
<span id="section-etot-input"></span><h2>etot.input<a class="headerlink" href="#etot-input" title="Permalink to this headline">¶</a></h2>
<p>The etot.input is the most essential file controlling how to run PWmat,
and what are the names of the other input files. Here is an example of a
short (essential) etot.input file.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span> <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span> <span class="o">=</span> <span class="n">SCF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">NCPP</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>The first two numbers are “NODE1, NODE2”. NODE1*NODE2 must equal to the
number of processor used to run PWmat (e.g., the Np in: “mpirun -n Np
PWmat”). NODE1 is the number of processors for plane wave
parallelization. NODE1 should be able to divide n1*n2 (n1,n2,n3 are FFT
grid in real space). NODE2 is the number of processor groups for k-point
parallelization. It will divide the number of k-points (nkpoints) into
NODE2 groups. So, if you only have one kpoint, please use NODE2=1. If
your the nkpoints is greater than 1, it will be most efficient if you
choose a NODE2 which can divide nkpoints(although this is not a
requirement). Since k-point parallelization is efficient, so speed wise,
using NODE2 is a good idea. However, using NODE2 can also increase the
usage of memory in some degree.</p>
<p>IN.ATOM indicates the atomic position file (atom.config) (as an
PWmat/etot.input convention, all the input file tags will have the form:
IN.XXX, while all the output file tags will have the form OUT.XXX). JOB
tells the PWmat what kind of jobs to run. IN.PSP1 indicates the name of
pseudopotential file of first atom type (the second atom type will be
IN.PSP2). The etot.input has a format of “tag_name = xxx_value”. The
orders of different tags can be arbitrarily changed, except the first
line “NODE1, NODE2”. The names of the variables are case insensitive.
Line which starts with # will be an annotation line. After the
xxx_value, one can add annotations in the same line as well, e.g.,
“MP_N123=4,4,4,0,0,0 ! Monkhorst-Pack parameter without shift”.</p>
<p>One check the header of the REPORT file and can copy them as etot.input,
used as the input file (after you delete the rest of the file below the
header part). The REPORT header gives an explicit form for most the
parameters to be used in the calculation (generated by defaults). An
experienced user can change some of these parameters according to the
need. However, one can also just use the short version etot.input to run
PWmat, using the default values for most parameters.</p>
<p>One example of the header of REPORT file looks like this:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">PRECISION</span>  <span class="o">=</span> <span class="n">AUTO</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">SCF</span>
<span class="n">CONVERGENCE</span>  <span class="o">=</span> <span class="n">EASY</span>
<span class="n">ACCURACY</span>  <span class="o">=</span> <span class="n">NORM</span>
<span class="n">DOS_DETAIL</span>    <span class="o">=</span> <span class="mi">0</span>        <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="n">Ga</span><span class="o">.</span><span class="n">PD03</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="n">As</span><span class="o">.</span><span class="n">PD03</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">SPIN</span>      <span class="o">=</span>   <span class="mi">1</span>
<span class="n">QIJ_DETAIL</span> <span class="o">=</span>   <span class="mi">0</span>  <span class="mi">1</span>
<span class="n">MIX</span>       <span class="o">=</span> <span class="n">CHARGE</span>
<span class="n">PWSCF_OUTPUT</span>     <span class="o">=</span>  <span class="n">F</span>
<span class="n">Ecut</span>      <span class="o">=</span>    <span class="mf">60.0000000000000</span>
<span class="n">Ecut2</span>     <span class="o">=</span>    <span class="mf">120.000000000000</span>
<span class="n">Ecut2L</span>    <span class="o">=</span>    <span class="mf">120.000000000000</span>
<span class="n">N123</span>      <span class="o">=</span>    <span class="mi">27</span>    <span class="mi">27</span>    <span class="mi">27</span>
<span class="n">NS123</span>     <span class="o">=</span>    <span class="mi">27</span>    <span class="mi">27</span>    <span class="mi">27</span>
<span class="n">N123L</span>     <span class="o">=</span>    <span class="mi">27</span>    <span class="mi">27</span>    <span class="mi">27</span>
<span class="n">XCFUNCTIONAL</span> <span class="o">=</span> <span class="n">LDA</span>
<span class="n">HSE_DETAIL</span>    <span class="o">=</span>      <span class="mf">1.00000000</span>    <span class="mi">1</span>     <span class="mf">0.00001000</span>    <span class="mi">6</span>
<span class="n">RELAX_HSE</span>    <span class="o">=</span>     <span class="mi">0</span>   <span class="mf">0.00000E+00</span>     <span class="mi">1</span>
<span class="n">VDW</span>       <span class="o">=</span>  <span class="n">NONE</span>
<span class="n">COULOMB</span>   <span class="o">=</span>    <span class="mi">0</span>
<span class="n">IN</span><span class="o">.</span><span class="n">WG</span>     <span class="o">=</span>  <span class="n">F</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">WG</span>    <span class="o">=</span>  <span class="n">T</span>
<span class="n">IN</span><span class="o">.</span><span class="n">RHO</span>    <span class="o">=</span>  <span class="n">F</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">RHO</span>   <span class="o">=</span> <span class="n">T</span>
<span class="n">IN</span><span class="o">.</span><span class="n">VR</span>     <span class="o">=</span>  <span class="n">F</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">VR</span>    <span class="o">=</span>  <span class="n">T</span>
<span class="n">IN</span><span class="o">.</span><span class="n">VEXT</span>   <span class="o">=</span>  <span class="n">F</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">RHOWF_SP</span><span class="o">=</span> <span class="mi">0</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">FORCE</span> <span class="o">=</span>  <span class="n">F</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">STRESS</span> <span class="o">=</span>  <span class="n">F</span>
<span class="n">IN</span><span class="o">.</span><span class="n">SYMM</span>   <span class="o">=</span>  <span class="n">F</span>
<span class="n">IN</span><span class="o">.</span><span class="n">KPT</span>    <span class="o">=</span>  <span class="n">F</span>
<span class="n">NUM_ELECTRON</span> <span class="o">=</span>   <span class="mf">28.0000000000000</span>
<span class="n">NUM_BAND</span>  <span class="o">=</span>    <span class="mi">24</span>
<span class="n">WG_ERROR</span>  <span class="o">=</span>   <span class="mf">1.000000000000000E-004</span>
<span class="n">E_ERROR</span>   <span class="o">=</span>   <span class="mf">7.619188085599999E-005</span>
<span class="n">RHO_ERROR</span> <span class="o">=</span>   <span class="mf">5.000000000000000E-005</span>
<span class="n">RHO_RELATIVE_ERROR</span>      <span class="o">=</span>   <span class="mf">7.000000000000001E-002</span>
<span class="n">FORCE_RELATIVE_ERROR</span>     <span class="o">=</span>   <span class="mf">0.000000000000000E+000</span>
<span class="n">SCF_ITER0_1</span> <span class="o">=</span>    <span class="mi">6</span>   <span class="mi">4</span>    <span class="mi">3</span>    <span class="mf">0.0000</span>     <span class="mf">0.02500</span>    <span class="mi">1</span>
<span class="n">SCF_ITER0_2</span> <span class="o">=</span>   <span class="mi">90</span>   <span class="mi">4</span>    <span class="mi">3</span>    <span class="mf">1.0000</span>     <span class="mf">0.02500</span>    <span class="mi">1</span>
<span class="n">SCF_ITER1_1</span> <span class="o">=</span>   <span class="mi">10</span>   <span class="mi">4</span>    <span class="mi">3</span>    <span class="mf">1.0000</span>     <span class="mf">0.02500</span>    <span class="mi">1</span>
<span class="n">NONLOCAL</span>  <span class="o">=</span>  <span class="mi">2</span>
<span class="n">RCUT</span>      <span class="o">=</span>    <span class="mf">3.50000000000000</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP_RCUT1</span>   <span class="o">=</span>    <span class="mf">3.50000000000000</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP_RCUT2</span>   <span class="o">=</span>    <span class="mf">3.50000000000000</span>
<span class="n">MD_VV_SCALE</span> <span class="o">=</span>          <span class="mi">100</span>
<span class="n">NUM_BLOCKED_PSI</span><span class="o">=</span>            <span class="n">F</span>
<span class="n">WF_STORE2DISK</span>  <span class="o">=</span>            <span class="mi">0</span>
<span class="n">NUM_DOS_GRID</span> <span class="o">=</span>         <span class="mi">1500</span>
</pre></div>
</div>
</div>
<p>In the following, we explain the meaning of each tag that can be set in
etot.input. The tags in red are the mandatory tags, the tags in blue are
“JOB” tag dependent mandatory tags (e.g., if JOB=MD, then MD_Detail is
mandatorily needed), and all the others are optional (will be set
automatically by default values).</p>
<p>The number of processors to divide the G-space sphere and N1*N2*N3 FFT
grid. NODE1 must evenly divides N1*N2. However, if you didn’t specify
N1,N2,N3, the code will automatically generate them, and make sure N1*N2
can be divided by NODE1. <strong>(WARNING)</strong>: <em>As a result of this, if you run
two different jobs, with different NODE1, and automatically generate
N1,N2,N3, the N1,N2,N3 might be different, and the results might be
slightly different.</em></p>
<p id="section-1">The number of processor groups to divide the k-points. The best is to
have NODE2 evenly (or almost evenly) divide the number of k-points for
high efficiency. Note, the total number of processors (the Np in the
“<span class="math notranslate nohighlight">\(&gt;\)</span> mpirun -np Np PWmat” command) must equal to: NODE1*NODE2.
Also, since k-points parallelization is more efficient that the G-space
parallelization, so if possible, one should use NODE2 to speed up the
caalculation. However, this also use more memory and for XCFUNCTIONAL =
HSE, k-point parallelization do not support, so NODE2 must be set as 1.
Please keep this in mind.</p>
<p id="section-2"><strong>IN.ATOM = atom.config</strong></p>
<p>IN.ATOM tage is used to read the atomic positions file, this file
contains the lattice geomery and ionic positions, optinally tags force,
velocity, magnetic, constraint_mag, magnetic_xyz, langevin_atomfact_tg,
stress_mask, et al. Its specification is described in the section
<a class="reference external" href="#section:atom.config">2.3</a> of this manual.</p>
<p id="section-3">The names of the pseudopotential files. Such as</p>
<p><strong>IN.PSP1 = Na.NCPP.UPF</strong> # for norm conserving</p>
<p><strong>IN.PSP1 = Na.USPP.UPF</strong> # for ultra-soft</p>
<p>Currently, different types of pseudopotentials cannot be mixed (i.e,
either all atoms are in norm-conserving PSP, or all in ultra-soft). The
PWmat can only use norm-conserving or ultrasoft pseudopotentials. We do
not use PAW pseudopotential. We only read upf formatted pseudopotential
files. UPF format is the Quantum Espresso format. In the utility
package, we provide a few programs to convert the psuedopotential of
other formats (e.g., vwr2upf.90, uspp2upf.f90) into the UPF format. We
provide a few sets of pseudopotentials. One can also copy
pseudopotential files from the Quantum Espresso website, and use it as
it is. However, for spin-orbit coupling (SOC) pseudopotentials, our
implementation is different from that in PWscf. As a result, we cannot
use the current SOC UPF format. The format we use is slightly different
(it is also called UPF). We have provided one set of SOC
pseudopotential. We also provide a conversion utility program
UPF2UPFSO.x to convert the PWscf style SOC UPF file into the PWmat style
SOC UPF file. Please see chapter <a class="reference external" href="#chapter:Pseudopotentials">5</a> for a
discussion of different pseudopotentials.</p>
<p><strong>(WARNING)</strong>: <em>many of the PWmat functions cannot be run using
ultra-soft pseudopotential. Besides the ultra-soft pseudopotential is
often slower than the norm conserving pseudopotential. So we encourage
users to use norm conserving pseudopotential as much as possible</em>.</p>
<p id="section-4">Controls what PWmat will do.</p>
<p><strong>JOB = SCF</strong>, do only the self-consistent field iterations,
self-consistently determine the charge density, will output the total
energy. It will not move atoms.</p>
<p>Related input lines: SCF_MIX, HSE_DETAIL, XCFUNCTIONAL, WG_ERROR,
E_ERROR, RHO_ERROR, SCF_ITER0_1, SCF_ITER0_2, SCF_ITER1_1.</p>
<p><strong>Frequeuntly used etot.input settings for SCF calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = SCF</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify xxx according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE #replace “PBE” with “HSE” for HSE SCF
calculation</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #modify “NK1 NK2 NK3” according to
structure lattice</div>
</div>
</div>
</div>
<p><strong>JOB = NONSCF</strong>, do non-self-consistent calculations.</p>
<p>Related input lines: IN.KPT</p>
<p>It requires an input potential (via “IN.VR = T”), usually from a
previous SCF calculation. It only calculates the eigen wave functions
non-self-consistently. It will not calculate total energy, but it can be
used to calculate band structure or density of state. The IN.VR needs to
be copied from OUT.VR from previous JOB = SCF run. The purpose of doing
one NONSCF following a SCF job, is usually to include more k-points
(either in density of state calculation, or band structure calculation).
The k-points for NONSCF can be achieved through a few different ways.
For density of state calculate, this can be done with the “MP_N123”
variable in etot.input (the Monkhorst-Pack). The k-points can also be
input explicitly by using IN.KPT. This is usually necessary for band
structure calculation. In that case, the IN.KPT file can be generated by
using utility program “split_kp.x”.</p>
<p><strong>(WARNING)</strong>: <em>When running NONSCF HSE (“XCFUNCTIONAL = HSE”)
calculation, there need some special attention. Besides the input
potential IN.VR, we also need the input wave function OUT.HSEWR1,
OUT.HSEWR2, etc, which are output from a previous SCF HSE calculation</em>.
The OUT.HSEWR(i) are real space wave functions for the Fock exchange
kernel for all the extended k-points on GPU(i).</p>
<p>Some options can be set for the JOB=NONSCF in the optional file
IN.NONSCF(need to set IN.NONSCF=T in etot.input). The IN.NONSCF is as
follows:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">NONSCF_METH = 0</div>
<div class="line"><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">``</span></a>! 0 – the conventional NONSCF calculation</div>
<div class="line"><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">``</span></a>! 1 – calculate minimal eigen energy</div>
<div class="line"><a href="#id9"><span class="problematic" id="id10">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line"><a href="#id11"><span class="problematic" id="id12">``</span></a><a href="#id13"><span class="problematic" id="id14">``</span></a>! -1 – calculate maximal eigen energy</div>
<div class="line"><a href="#id15"><span class="problematic" id="id16">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line"><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">``</span></a>! 2 – the escan calculation based on
<span class="math notranslate nohighlight">\((H-FSM\_EREF)^2\)</span>, using folded spectrum method</div>
<div class="line"><a href="#id21"><span class="problematic" id="id22">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line"><a href="#id23"><span class="problematic" id="id24">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set NUM_BAND explicity in etot.input</div>
<div class="line"><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">``</span></a>! 3 – the DOS calculation using generalized moments method</div>
<div class="line"><a href="#id29"><span class="problematic" id="id30">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line"><a href="#id31"><span class="problematic" id="id32">``</span></a><a href="#id33"><span class="problematic" id="id34">``</span></a>! 4 – the OAS(optical absorption spectrum) calculation using
generalized moments method</div>
<div class="line"><a href="#id35"><span class="problematic" id="id36">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line"><a href="#id37"><span class="problematic" id="id38">``</span></a><a href="#id39"><span class="problematic" id="id40">``</span></a>! 5 – the chebyshev filter method to calculate eigen
energies within specified range</div>
<div class="line"><a href="#id41"><span class="problematic" id="id42">``</span></a><code class="docutils literal notranslate"><span class="pre">!\</span> <span class="pre">``</span></code>must set PRECISION=DOUBLE in etot.input</div>
<div class="line">FSM_EREF = 0.0</div>
<div class="line"><a href="#id43"><span class="problematic" id="id44">``</span></a><a href="#id45"><span class="problematic" id="id46">``</span></a>! the reference energy used in <span class="math notranslate nohighlight">\((H-FSM\_EREF)^2\)</span> for
NONSCF_METH=2</div>
<div class="line"><a href="#id47"><span class="problematic" id="id48">``</span></a><a href="#id49"><span class="problematic" id="id50">``</span></a>! unit eV.</div>
<div class="line">GMM_DOS_EMIN = 0.0</div>
<div class="line"><a href="#id51"><span class="problematic" id="id52">``</span></a><a href="#id53"><span class="problematic" id="id54">``</span></a>! the minimal energy of DOS range, must be smaller than the
mininal eigen energy calculated by NONSCF_METH=1</div>
<div class="line"><a href="#id55"><span class="problematic" id="id56">``</span></a><a href="#id57"><span class="problematic" id="id58">``</span></a>! only used by NONSCF_METH=3</div>
<div class="line"><a href="#id59"><span class="problematic" id="id60">``</span></a><a href="#id61"><span class="problematic" id="id62">``</span></a>! unit eV.</div>
<div class="line">GMM_DOS_EMAX = 0.0</div>
<div class="line"><a href="#id63"><span class="problematic" id="id64">``</span></a><a href="#id65"><span class="problematic" id="id66">``</span></a>! the maximal energy of DOS range, must be larger than the
maxinal eigen energy calculated by NONSCF_METH=-1</div>
<div class="line"><a href="#id67"><span class="problematic" id="id68">``</span></a><a href="#id69"><span class="problematic" id="id70">``</span></a>! only used by NONSCF_METH=3</div>
<div class="line"><a href="#id71"><span class="problematic" id="id72">``</span></a><a href="#id73"><span class="problematic" id="id74">``</span></a>! unit eV.</div>
<div class="line">GMM_DOS_MMAX = 3000</div>
<div class="line"><a href="#id75"><span class="problematic" id="id76">``</span></a><a href="#id77"><span class="problematic" id="id78">``</span></a>! the total number of moments for the moments method. The
energy resolution is roughly <span class="math notranslate nohighlight">\((EMAX-EMIN)/MMAX\)</span></div>
<div class="line">GMM_DOS_IRANDOM = 2019</div>
<div class="line"><a href="#id79"><span class="problematic" id="id80">``</span></a><a href="#id81"><span class="problematic" id="id82">``</span></a>! random number seed</div>
<div class="line">GMM_DOS_mx_ab = 20</div>
<div class="line"><a href="#id83"><span class="problematic" id="id84">``</span></a><a href="#id85"><span class="problematic" id="id86">``</span></a>! used by nonscf_meth=5, the number of wave functions to be
stored in the memory.</div>
<div class="line"><a href="#id87"><span class="problematic" id="id88">``</span></a><a href="#id89"><span class="problematic" id="id90">``</span></a>! larger mx_ab will require more memory, but it will reduce
the number of I/O</div>
<div class="line">GMM_DOS_ipxyz = 0</div>
<div class="line"><a href="#id91"><span class="problematic" id="id92">``</span></a><a href="#id93"><span class="problematic" id="id94">``</span></a>! used by nonscf_meth=5, the absorption polarization in x,
y, z</div>
<div class="line"><a href="#id95"><span class="problematic" id="id96">``</span></a><a href="#id97"><span class="problematic" id="id98">``</span></a>! ipxyz=1, x polarization only, output Tm.store.1</div>
<div class="line"><a href="#id99"><span class="problematic" id="id100">``</span></a><a href="#id101"><span class="problematic" id="id102">``</span></a>! ipxyz=2, y polarization only, output Tm.store.2</div>
<div class="line"><a href="#id103"><span class="problematic" id="id104">``</span></a><a href="#id105"><span class="problematic" id="id106">``</span></a>! ipxyz=3, z polarization only, output Tm.store.3</div>
<div class="line"><a href="#id107"><span class="problematic" id="id108">``</span></a><a href="#id109"><span class="problematic" id="id110">``</span></a>! ipxyz=0, x, y, z polarizations, output Tm.store.1,
Tm.store.2, Tm.store.3</div>
<div class="line">ESCAN_DETAIL = E_window_start, E_window_end, degree_cheb,
niter_lanczos</div>
<div class="line"><a href="#id111"><span class="problematic" id="id112">``</span></a><a href="#id113"><span class="problematic" id="id114">``</span></a>! used by nonscf_meth=5, unit of E_window_start and
E_window_end is eV.</div>
<div class="line"><a href="#id115"><span class="problematic" id="id116">``</span></a><a href="#id117"><span class="problematic" id="id118">``</span></a>! PWmat well calculate eigen states with energy in range
(E_window_start, E_window_end)</div>
<div class="line"><a href="#id119"><span class="problematic" id="id120">``</span></a><a href="#id121"><span class="problematic" id="id122">``</span></a>! default is 0,0,1000,20; Please check ref paper for last
two parameters. <a href="#id123"><span class="problematic" id="id124">:raw-latex:`\cite{chefd}`</span></a></div>
<div class="line"><a href="#id125"><span class="problematic" id="id126">``</span></a><a href="#id127"><span class="problematic" id="id128">``</span></a>! E_window_start should not be equal to E_window_end for
actrual use.</div>
</div>
</div>
</div>
<p><strong>Frequeuntly used etot.input settings for NONSCF calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = NONSCF</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">IN.KPT = T #prepared by utility program “split_kp.x”</div>
<div class="line">IN.VR = T #copied from previous SCF calculation OUT.VR</div>
</div>
</div>
</div>
<p>For NONSCF_METH=5, the chebyshev filter method:raw-latex:<cite>cite{chefd}</cite>,
one should use just one nonscf with larger nline by setting SCF_ITER0 as
following (NITER0=1,NLINE0=10), you can always increase NLINE0 to get
more converged results:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<p>SCF_ITER0_1 = 1 10 3 0.0 0.025 1</p>
</div>
</div>
<p>For NONSCF_METH=5, you also need to estimate the NUM_BAND, especially
for large systems.</p>
<p><strong>JOB = DOS</strong>, do density of state (DOS) calculation based on wave
function and eigen energy input from previous SCF or NONSCF calculations
(must have IN.WG=T in etot.input, which is also default, and OUT.EIGEN
(no need to be copied to IN.EIGEN), from previous step calculations).
Note, please don’t confuse JOB=DOS with JOB=NONSCF. Usually JOB=DOS can
also be done after JOB=NONSCF. In previous SCF or NONSCF, the eigen
energies and wave functions have already been calculated, and JOB=DOS is
just to use those these wave functions to calculate their projections on
atomic orbitals, so one can do partial DOS (for atomic states, or
selective atoms) using utility post process utility program: plot_DOS.py
or plot_DOS_interp.x.</p>
<p>Related input lines: DOS_DETAIL.</p>
<p>JOB = DOS mostly follows one previous JOB = SCF or JOB = NONSCF
calculation. The purpose is to do a wave function to local atomic
orbital projection, so partial density of state (e.g., on different
atoms, and different orbital of the atoms) can be calculated. One can
even consider this as an post-processing step of JOB = SCF or JOB =
NONSCF. Note, to calculate a density-of-state, it is not enough just to
do JOB = DOS. Instead, one must first do one JOB = SCF or JOB = NONSCF,
then do one JOB = DOS. The reason for this as a separated step is
because the nonlocal potential projector in this step is different from
NONSCF and SCF steps.</p>
<p>There are two ways to calculate DOS, one is conventional DOS
calculation, the other is k-point interpolation scheme for DOS
calculation (which can get a smooth DOS with very few k-points). For
conventional DOS calculation, output files inculde “DOS.totalspin”,
“bpsiiofil10000x”, and you can use utility program “plot_DOS.py” to plot
DOS.</p>
<p><strong>Frequently used etot.input settings for conventional DOS calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = DOS</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #keep “NK1 NK2 NK3” consistent with
SCF or NONSCF</div>
<div class="line">IN.WG = T #copied from previous SCF or NONSCF calculation OUT.WG</div>
</div>
</div>
</div>
<p>For k-point interpolation scheme method, you must set “DOS_DETAIL”
(refer to section <a class="reference external" href="#text:DOSDETAIL">[text:DOSDETAIL]</a>) in etot.input,
in that case, in addition to DOS.totalspin, bpsiiofil10000x, it will
generate a OUT.overlap_uk file, containing information for Bloch state
overlap between different k-points. The OUT.overlap_uk, together with
OUT.EIGEN can be used by the utility file: plot_DOS_interp.x to generate
a DOS based on k-space interpolation.</p>
<p><strong>Frequently used etot.input settings for k-point interpolation scheme
DOS calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = DOS</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE #replace “PBE” with “HSE” for HSE SCF
calculation</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #keep “NK1 NK2 NK3” consistent with
SCF or NONSCF</div>
<div class="line">DOS_DETAIL = 1 NK1 NK2 NK3</div>
<div class="line">IN.WG = T #copied from previous SCF calculation OUT.WG</div>
</div>
</div>
</div>
<p><strong>JOB = MOMENT</strong>, calculates the momentum matrix (oscillator strength)
between Kohn-Sham orbitals. To calculate the optical absorption
spectrum, or dielectric constant, the momentum matrix between Kohn-Sham
orbitals <span class="math notranslate nohighlight">\(\{ \psi_i \}\)</span> needs to be calculated. Formally, this
momentum matrix can be expressed as:
<span class="math notranslate nohighlight">\(M_x(i,j)=&lt;\psi_i|P_x|\psi_j&gt;=-&lt;\psi_i|{\partial H[k]/\partial k_x}|\psi_j&gt;=-i &lt;\psi_i|[H,r_x]|\psi_j&gt;\)</span>.
here subscript x actually stands for x, y, z directions. So, there are
three matrix (in Cartesian coordinates). <span class="math notranslate nohighlight">\(P_x\)</span> is the momentum
operator. In the case there is no nonlocal potential,
<span class="math notranslate nohighlight">\(P_x=i \nabla_x\)</span>. If only the <span class="math notranslate nohighlight">\(i \nabla_x\)</span> is needed in the
calculation, one can use utility routine ug_moment.f90 to calculate the
matrix based on the output wave function OUT.WG. However, if the
nonlocal potential needs to be taken into account, there is an
additional term <span class="math notranslate nohighlight">\(i(V_{NL}r_x - r_x V_{NL})\)</span>, which cannot be
calculated easily. The JOB=MOMENT is to solve this problem, to include
this additional term. The resulting momentum matrix is output in
OUT.MOMENT_EXT_KPT. For example, it can be used for RPA calculation for
absorption spectrum or dielectric constant calculations. Including this
nonlocal term can increase the oscillator strength <span class="math notranslate nohighlight">\(|M_x|^2\)</span> by
about <span class="math notranslate nohighlight">\(10\%\)</span>. The output OUT.MOMENT_EXT_KPT is based on the
extended (expanded) kpt set, not for the reduced kpt set. It is a
unformatted file, it has the following structure (here
M_x(mx,mx,kpt,spin) is a complex*16 matrix) :</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">num_ext_kpt, mx, islda</div>
<div class="line">do kpt=1,num_ext_kpt</div>
<div class="line">do spin=1,islda</div>
<div class="line">M_x(:,:,kpt,spin)</div>
<div class="line">M_y(:,:,kpt,spin)</div>
<div class="line">M_z(:,:,kpt,spin)</div>
<div class="line">enddo</div>
<div class="line">enddo</div>
</div>
</div>
</div>
<p>Note, the relationship between the reduced kpt, and the extended kpt,
and the symmetry operation which rotates the reduced kpt to the extended
kpt is given in OUT.IND_EXT_KPT.</p>
<p>To run JOB=MOMENT, one needs to use: IN.WG = T, just like in the JOB=DOS
calculation. If one needs to calculate the optical absorption spectrum
including the nonlocal potential effect, one needs first to run
JOB=MOMENT, then run RPA_absorpt.f90, or RPA_DIEL_G1G2.f90.</p>
<p><strong>JOB = RELAX</strong>, do atomic position relaxations and cell relaxation
using DFT force and total energy.</p>
<p>Related input lines: RELAX_DETAIL, RELAX_HSE.</p>
<p>Inside the atom.config, in the POSITION section, the last three columns
1,1,1, determine whether this atom will move in the x,y,z directions
(see section <a class="reference external" href="#section:atom.config">2.3</a>): 1,1,1, means move, 0,0,0
means fix. Similarly, if cell relaxation is specified in RELAX_DETAIL,
then a STRESS_MASK section in atom.config can be used to specified
whether one wants to relax all components of the unit cell vector, or
only selective components of the cell. Also, if cell relaxation is
specified, during the relaxation, the number of plane wave G-vectors are
kept unchanged. As a result, after the relaxation, if one wants to redo
a calculation with the same Ecut, then due to the change of the cell,
the number of G-vector will be different, and the energy, stress etc
might be different from the previous relaxation runs. So, one might want
to do a relaxation again. Or, one can use a larger Ecut to do the cell
relaxation. Another option is to use STRESS_CORR (see section
<a class="reference external" href="#subsection:CORR">2.1.95</a>) to make a correction for stress
calculation, taking into account the effect of finite Ecut to the
calculation of stress.</p>
<p>Each atomic relaxation step will do one SCF calculation. Optionally you
can also have “RELAX_DETAIL” (for general RELAX) and “RELAX_HSE” (for
RELAX in the case of HSE calculation) in the etot.input. See
below<a class="reference external" href="#section:relaxdetail">2.1.12</a>. A concise result will be
reported in RELAXSTEPS. The atomic movements for each relaxation step
will be reported in MOVEMENT, and final atomic configuration is reported
in final.config.</p>
<p><strong>Frequently used etot.input settings for atomic relaxation
calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = RELAX</div>
<div class="line">RELAX_DETAIL = 1 500 0.01</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #modify “NK1 NK2 NK3” according to
structure lattice</div>
</div>
</div>
</div>
<p><strong>Frequently used etot.input settings for cell relaxation calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = RELAX</div>
<div class="line">RELAX_DETAIL = 1 500 0.01 1 0.01</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 70</div>
<div class="line">Ecut2 = 280</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #modify “NK1 NK2 NK3” according to
structure lattice</div>
</div>
</div>
</div>
<p><strong>JOB = EGGFIT</strong>, This is a way to fix the “egghead” problem in atomic
relaxation.</p>
<p>Related input line: EGG_DETAIL (required), EGG_CORR.</p>
<p>The egghead problem is caused by the numerical discretization of the
real space using grid n1*n2*n3. As a result, the atom can have an
artificial force towards or away from the grid point. In many cases this
problem can cause the system relaxing very slowly when the force is
small, or the relaxation energy curve become not smooth. In most cases,
this problem can be removed by using Ecut2=4Ecut, Ecut2L=Ecut2 (for norm
conserving pseudopotential, NC-PSP). However, sometime even this cannot
remove the “egghead” problem. In that case, the Ecut2=4Ecut,
Ecut2L=4Ecut2 will almost always remove the egghead problem. But the
“Ecut2=4Ecut,Ecut2L=4Ecut2” could be rather expensive. To keep the
calculation in “Ecut2=4Ecut, Ecut2L=Ecut2” (for NC-PSP), we provide a
JOB=EGGFIT procedure to remove the egghead problem. This can be useful
for large system relaxation runs. In order to use this procedure, one
needs to do the relaxation in two steps:</p>
<ol class="arabic">
<li><p>set the JOB = EGGFIT in the etot.input and give an additional
setting: egg_detail = np1, np2, np3; ECUT2 = 4ECUT, ECUT2L = ECUT2;
Here, np1, np2, np3 indicates the point to probe inside a grid,
usually they are 2,2,2 or 4,4,4. After running PWmat, it will give a
new file “CC.egghead” which will be used in the following step.</p>
<p><strong>Frequently used etot.input settings for eggfit calculation</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = EGGFIT</div>
<div class="line">EGG_DETAIL = 2 2 2</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #modify “NK1 NK2 NK3” according
to structure lattice</div>
</div>
</div>
</div>
</li>
<li><div class="line-block">
<div class="line">set the JOB = RELAX with an additional setting: EGG_CORR = T, ECUT2
= 4ECUT, ECUT2L = ECUT2. EGG_CORR = T means PWmat will read
“CC.egghead” to do the eggLarger MD_NPT_GAMMA, faster it reaches
cell equilibrium.</div>
<div class="line">head correction during relaxation.</div>
</div>
<p><strong>Frequently used etot.input settings for atomic elaxation with
egg_corr</strong></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">4 1</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">JOB = RELAX</div>
<div class="line">RELAX_DETAIL = 1 500 0.01 1</div>
<div class="line">IN.PSP1 = XXX.SG15.PBE.UPF #modify XXX according to your
structure</div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line">Ecut = 50</div>
<div class="line">Ecut2 = 200</div>
<div class="line">EGG_CORR = T #read “CC.egghead” file from previous
“JOB=EGGFIT”</div>
<div class="line">MP_N123 = NK1 NK2 NK3 0 0 0 #modify “NK1 NK2 NK3” according
to structure lattice</div>
</div>
</div>
</div>
</li>
</ol>
<p><strong>JOB = NEB</strong>, calculate the energy barriers using nudged elastic band
method.</p>
<p>Related input line: NEB_DETAIL (required).</p>
<p>It must have a variable “NEB_DETAIL” in etot.input file. Besides
IN.ATOM, which gives the first valley site atomic position, there must
be a second valley site position given in the NEB_DETAIL line. One must
precalculate (e.g., using JOB=RELAX) the atomic configuration of these
two valley sites before using JOB=NEB to calculate their barrier. See
NEB_DETAIL (see section <a class="reference external" href="#subsection:NEBDETAIL">2.1.8</a>) for more
details and how to set up the calculations. Output files: RELAXSTEPS,
NEB.BARRIER, MOVEMENT. NEB.BARRIER gives the barrier height information,
while MOVEMENT gives all the image atom.config files within each NEB
step. <strong>(WARNING)</strong>: During NEB calculation, if you encounter the
following error: “equivalent atom not found under symm op, stop”, please
turn off the symmetry, just set “MP_N123 = NK1 NK2 NK3 0 0 0 2” (see
section <a class="reference external" href="#subsection:MPN123">2.1.25</a>)</p>
<p><strong>JOB = MD</strong>, do Born-Oppenheimer molecular dynamics (MD) simulations.</p>
<p>Related input lines: MD_DETAILS (required); IN.MDOPT.</p>
<p>Must have variable “MD_DETAIL” in etot.input (see section
<a class="reference external" href="#subsection:MDDETAIL">[subsection:MDDETAIL]</a>). The PWmat can
perform: Verlet, Nose-Hoover, Langevin, Berendsen dynsmics. We have a
concise output as reported in MDSTEPS. The atomic movements for every
step are reported in MOVEMENT. One can also do special MD, e.g., with
applied different force on each atom, or different specified temperature
on each atom within the Langevin dynamics. Inside the atom.config, in
the POSITION section, the last three column 1,1,1, determines whether
this atom will move in the x,y,z directions (see section
<a class="reference external" href="#section:atom.config">2.3</a>): 1,1,1, means move, 0,0,0 means fix. If
dynamics can change the unit cell vector (e.g., in NPT calculation), one
can also use STRESS_MASK section in atom.config to specify which cell
vector component to change.</p>
<p><strong>JOB = TDDFT</strong>, do real-time time-dependent DFT calculation (rt-TDDFT).</p>
<div class="line-block">
<div class="line">Related input line: MD_DETAIL (required); TDDFT_DETAIL (required);</div>
<div class="line">TDDFT_TIME; TDDFT_SPACE; IN.A_FIELD; TDDFT_BOLTZMANN; IN.TDDFTOPT.</div>
</div>
<p>This is a major functionality in PWmat. It uses a new algorithm as
reported in Ref.:raw-latex:<cite>cite{pwmat3}</cite>. The detail of this JOB is
described separately in Appendix B. The rt-TDDFT can be used to simulate
the dynamic process where both nuclei and electron movements are
important, and the electron is no longer in the ground state during the
nuclear movement (for example, in a high speed ion collision with a
material). It can also be used to study optics (absorption spectrum, or
nonlinear optics). It includes both the electron-electron interaction,
and electron-phonon interaction. The TDDFT simulation is more expensive
than the NAMD calculation. Mostly this is because one needs to use a
smaller time step dt (e.g., 0.1 fs), and calculate more electron
adiabatic states (to expand the time evolving wave functions).</p>
<p><strong>JOB = NAMD</strong>, non-adiabatic molecular dynamics.</p>
<div class="line-block">
<div class="line">Related input line: MD_DETAIL (required); NAMD_DETAIL (required);</div>
<div class="line">TDDFT_TIME; TDDFT_SPACE; TDDFT_STIME; IN.A_FIELD; IN.MDOPT.</div>
</div>
<p>This is done under the approximation of Born-Oppenbeimer MD (BO-MD) for
nuclear movement. So the time to do NAMD is almost the same as that for
MD. The actual NAMD simulation is done as a post-processing after the
DFT BO-MD. It will generate a file OUT.NAMD. Some post-processing
program (e.g., the NAMD_Boltzman.f90 in the utility directory) can be
used to study the single carrier dynamics during the BO-MD process. It
only simulates the behavior of a single carrier. While it takes into
account the effects from other electron and phonon to the dynamics of
this single carrier (hence, include the electron-phonon coupling etc),
it ignores the effects of this carrier to the dynamics of other electron
and phonon (i.e, there is no feedback from carrier to phonon, or carrier
to other electron, thus it cannot be used to study polaron effect).
Advantageously, it also does not have the erroneous carrier
self-interaction. It is suitable to study the carrier dynamics (e.g.,
charge transfer between molecule, or spin dynamics of one defect) of
some large systems. Compare to TDDFT, one advantage is that it can do
much bigger system with much longer time. The details are also described
in Appendix B (see section <a class="reference external" href="#section:NAMD">8.14</a>).</p>
<p><strong>JOB = SCFEP</strong>, This will carry out an electron-phonon coupling
calculation.</p>
<p>Related input line: SCFEP_DETAIL (required).</p>
<p>The procedure is the following, one first carries out a JOB = SCF
calculation, and OUT.FORCE = T, so there will be atomic forces (or
perhaps before that, there will be a JOB = RELAX, to relax the atoms).
Copy OUT.FORCE file into IN.FORCE (and set IN.FORCE = T). For JOB =
SCFEP, we must have IN.WG = T, here IN.WG is copied from the OUT.WG from
the previous JOB = SCF calculation. Now, in JOB = SCFEP calculation, the
state <span class="math notranslate nohighlight">\(\psi(ist1,ikpt,ispin)\)</span>, and <span class="math notranslate nohighlight">\(\psi(ist2,kpt,ispin)\)</span>
(to be specied in the line of SCFEP_DETAIL) will be used to calculate:
<span class="math notranslate nohighlight">\(&lt;\psi(ist1,ikpt,ispin)|\delta{H}/\delta{R}|\psi(ist2,ikpt,ispin)&gt;\)</span>,
this result will be represented as an perturbed atomic forces (the
perturbation is proportional to <span class="math notranslate nohighlight">\(\alpha\)</span> as specified in
SCFEP_DETAIL), and reported in OUT.FORCE. The actual coupling constants
will be reported in OUT.EP_COEFF (here the FORCE_new has already be
subtracted by IN.FORCE, and divided by <span class="math notranslate nohighlight">\(\alpha\)</span>).</p>
<p>The <span class="math notranslate nohighlight">\(\alpha\)</span> should be small, something like 0.1, 0.2.</p>
<p>The electron-phonon coupling constant reported in OUT.EP_COEFF, together
with phonon calculations can be used to study non-adiabatic decay and
charge trapping by defect states.</p>
<p><strong>JOB = POTENTIAL</strong>, it take the input charge, IN.RHO=T, output the
potential: out.vr, out.vr_hion, then stop. It will be useful for charge
patching and defect calculation. Basically it is a simple Poisson
solver. In particular, for isolated systems, one can specify COULOMB=1
for Poisson solver without periodic image potential. This can be a very
quick calculation.</p>
<p><strong>JOB = HPSI</strong>, this is used to calculate <span class="math notranslate nohighlight">\(hpsi_i=H\psi_i\)</span> and
output the wave function <span class="math notranslate nohighlight">\(hpsi_i\)</span> in OUT.HPSI (and OUT.HPSI_2 for
spin=2). It must has a <span class="math notranslate nohighlight">\(IN.WG=T\)</span>, and have <span class="math notranslate nohighlight">\(IN.VR=T\)</span> or
<span class="math notranslate nohighlight">\(IN.RHO=T\)</span> to have the proper Hamiltonian. This is provided, so
one can carry out some analysis, for example to calculate the
electron-phonon coupling.</p>
<p><strong>JOB = WKM</strong>, this is a special calculation for Wannier Koopmann method
(WKM):raw-latex:<cite>cite{WKMCITE1,WKMCITE2}</cite>. When we do a DFT
calculations, one difficulty is to calculate a right band structure with
right band gaps which can agree well with experimental results. However,
it is a common sense that LDA, PBE and even HSE (when <span class="math notranslate nohighlight">\(\alpha\)</span> is
set to be 0.25) ofter nderestimate band gap results. For band gap
calculation, we often define the band gap as the difference between the
electron affinity (EA) energy and the ionization energy (IE). Here, EA
can be expressed as E(N+1)-E(N) and IE as E(N)-E(N-1). N is the number
of electrons in the neutral system, and N+1 and N-1 indicate the system
has one more or one less electron respectively. E(N) is the
self-consistent energy of the system with N electrons.</p>
<p>total energy profile describes an LDA total energy calculation and an
“exact” energy result for an open system</p>
<p>One possible way to overcome this underestimation is to perform a
Koopmans condition on normal DFT calculations. If we plot E(N) as a
function of N in LDA calculations, a black parabola in the above figure
can be plotted. However, this seems to be unphysical. If we want to
calculate E(N+s), which 0 &lt; s &lt;1 , the total energy of a system with a
fractional number of electrons can be defined as a statistical mixture
of the N electron and N+/-1 electron state.This leads to a linear
segment total energy function of s, which is plotted in red “exact”
straight lines in the above figure.This linear segment property is also
called Koopmans condition.</p>
<p>However, if we just add s electrons in a unit cell, as a result,
accordingto Janak’s theory, the total energy difference is the same
asKohn-Sham orbital eigen energy. To overcome this problem, we added an
electron into a localized Wannier function instead of the extended
Kohn-Sham orbitals. As a result, the WKM total energy can beexpressedas:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        E_{WKM}(\{s_k\}) = E_{LDA}(\{s_k\}) + \sum\limits_{k}E_k(s_k)
    \end{aligned}\]</div>
<p>Here, w indicates the wannier functions. s<span class="math notranslate nohighlight">\(_k\)</span> (0 &lt;
s<span class="math notranslate nohighlight">\(_k\)</span> &lt; 1) indicates the occupation number of this Wannier
function. During the LDA calculation, we add or remove the electron from
<span class="math notranslate nohighlight">\(\phi_k\)</span> of one spin channel and all the other orbitals in this
spin channel should be orthogonal to this Wannier function
<span class="math notranslate nohighlight">\(\phi_k\)</span>. All the other orbitals (except this oneWannier function)
are variationally changed to minimize the total energy, which results in
the ground state energy E<span class="math notranslate nohighlight">\(_{LDA}\)</span>(s<span class="math notranslate nohighlight">\(_k\)</span>). Thus, a
simple analytical expression of E<span class="math notranslate nohighlight">\(_{LDA}\)</span>(s<span class="math notranslate nohighlight">\(_k\)</span>) can
be writen as</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        E_k(s_k) = \lambda_ks_k(1 - s_k)
    \end{aligned}\]</div>
<p>The <span class="math notranslate nohighlight">\(\lambda_k\)</span> can be determined from
E<span class="math notranslate nohighlight">\(_{LDA}\)</span>(s<span class="math notranslate nohighlight">\(_k\)</span>) (to make
E<span class="math notranslate nohighlight">\(_{WKM}\)</span>(s<span class="math notranslate nohighlight">\(_k\)</span>) a straight line vs. s<span class="math notranslate nohighlight">\(_k\)</span>).
<span class="math notranslate nohighlight">\(\lambda_k\)</span> can be calculate by PWmat JOB = WKM mode.</p>
<p>It requires the input of Wannier wave functions (in real space),
provided by files in the name of IN.WANNIER_00001.u, IN.WANNIER_00002.u
IN.WANNIER_00001.d IN.WANNIER_00002.d etc. They are written in the same
format as the charge density IN.RHO (thus the Wannier wave functions are
real). Each of this file contain only one Wannier function
<span class="math notranslate nohighlight">\(\phi_k\)</span>. The information for these Wannier functions are provided
in a file called: IN.S_WKM. They look like</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S_WKM1</span>
<span class="mi">2</span>            <span class="p">:</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Wannier</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">up</span> <span class="n">spin</span>
<span class="mf">0.5</span>   <span class="mf">1.0</span>    <span class="p">:</span> <span class="n">s1_u</span> <span class="n">ss1_u</span> <span class="p">:</span> <span class="n">the</span> <span class="n">occupation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">up</span> <span class="n">wannier</span> <span class="n">function</span>
<span class="mf">0.0</span>   <span class="mf">0.0</span>    <span class="p">:</span> <span class="n">s2_u</span> <span class="n">ss2_u</span> <span class="p">:</span> <span class="n">the</span> <span class="n">occupation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">second</span> <span class="n">up</span> <span class="n">wannier</span> <span class="n">function</span>
<span class="n">S_WKM2</span>
<span class="mi">1</span>            <span class="p">:</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">Wannier</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">down</span> <span class="n">spin</span>
<span class="mf">0.9</span>   <span class="mf">1.9</span>    <span class="p">:</span> <span class="n">s1_d</span><span class="p">,</span> <span class="n">ss1_d</span> <span class="p">:</span> <span class="n">the</span> <span class="n">occupation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">down</span> <span class="n">wannier</span> <span class="n">function</span>
<span class="n">M_FIX_WKM</span>    <span class="p">:</span> <span class="n">This</span> <span class="n">section</span> <span class="ow">is</span> <span class="n">optional</span>
<span class="n">nb_fix1</span><span class="p">,</span><span class="n">nb_fix2</span><span class="p">,</span><span class="n">iflag_wkm_Hxc</span><span class="p">,</span><span class="n">nb_exclude_Hxc</span>
</pre></div>
</div>
</div>
<p>In the WKM calculation, the Wannier function <span class="math notranslate nohighlight">\(\phi_k\)</span> will be
occupied according to s1_u, or s2_u. The occupation ss1_u, ss2_u is used
to make the system a full shell. This is only used when there is a
special treatment for the exchange-correlatin functional by exclude some
core level charge densities. Otherwise, they are not really used. In the
WKM calculation, the other “normal” wave functions <span class="math notranslate nohighlight">\(\{ \psi_i \}\)</span>
will be orthogonal to the Wannier functions <span class="math notranslate nohighlight">\(\phi_k\)</span> included in
the IN.S_WKM file. Their total charge (from <span class="math notranslate nohighlight">\(\{ \psi_i \}\)</span>) is
determined by <span class="math notranslate nohighlight">\(NUM\_ELECTRON\)</span>. So, the total charge is
<span class="math notranslate nohighlight">\(NUM\_ELECTRON\)</span> plus the s1_u etc. It is a good idea to always
include <span class="math notranslate nohighlight">\(NUM\_ELECTRON\)</span> in the WKM calculation.</p>
<p>The optional session <span class="math notranslate nohighlight">\(M\_FIX\_WKM\)</span> is used for a special
exchange-correlation functional treatmenf for the WKM calculation with
semicore states (the states very deep in energy). We found that, in WKM
calculation for the lambda for a Wannier function <span class="math notranslate nohighlight">\(\phi_k\)</span>, it
might be necessary to fix some deep level bands (so they do not change
during the SCF calculation. These bands are indicated by
<span class="math notranslate nohighlight">\([nb\_fix1.nb\_fix2]\)</span>. If <span class="math notranslate nohighlight">\(iflag\_wkm\_Hxc=1\)</span>, then the
bands: <span class="math notranslate nohighlight">\([1, nb\_exclude\_Hxc]\)</span> counted from the bottom will not be
included in the exchange-correlation function evaluations, and in this
case the <span class="math notranslate nohighlight">\(ss1\_u\)</span> and <span class="math notranslate nohighlight">\(ss2\_u\)</span> are used to occupy the
Wannier function so to get a closed shell structure.</p>
<p>Note, one can also use JOB=WKM to do some other calculations. For
example, to fix some wave function without change during SCF, but to
relax all the other wave functions, while keeping all of them orthogonal
at the same time. It is not straightforward to do due to the real space
form in IN.WANNIER_00001.u etc, but it can be done.</p>
<p>Note, there is another related calculation, that is the SCF WKM
calculation. For that calculation, it is done not by JOB=WKM, instead it
is done by using JOB=SCF, and XCFUNCTIONAL = LDAWKM, or XCFUNCTIONAL =
LDAWKM2. Those are used to carry out SCF WKM calculation when the WKM
parameter <span class="math notranslate nohighlight">\(\lambda_k\)</span> has already been calculated, or they can be
used to carry out linear response WKM calculations. Please check the
XCFUNCTIONAL section for that. Detailed steps to perform a WKM
calculation in PWmat code, please refer to “<a class="reference external" href="http://www.pwmat.com/module-download">module
30</a>”.</p>
<p id="section-5"><strong>MD_DETAIL = MD, MSTEP, DT, TEMP1, TEMP2</strong></p>
<p>This line is required when JOB=MD, or JOB=TDDFT, or JOB=NAMD. There is
no default values, hence must be input by hand.</p>
<p><strong>MD</strong>: the method of MD algorithm</p>
<p>MD = 1 / 2 / 3 / 4 / 5 / 6 / 7 / 8 / 11 / 22 / 33 / 44 / 55 / 66 / 77 /
88 / 100 / 101 (if MD &gt; 10, that means the continue run of MD following
the previous runs.)</p>
<ol class="arabic simple">
<li><p>MD = 1, Verlet (NVE) <a href="#id129"><span class="problematic" id="id130">:raw-latex:`\cite{verlet}`</span></a>;</p></li>
<li><p>MD = 2, Nose-Hoover (NVT) <a href="#id131"><span class="problematic" id="id132">:raw-latex:`\cite{nose,hoover}`</span></a>;</p></li>
<li><p>MD = 3, Langevin (NVT) <a href="#id133"><span class="problematic" id="id134">:raw-latex:`\cite{langevin}`</span></a>;</p></li>
<li><p>MD = 4, Constant pressure Langevin dynamics (NPT)
<a href="#id135"><span class="problematic" id="id136">:raw-latex:`\cite{parrinello-rahman,quigley}`</span></a>;</p></li>
<li><p>MD = 5, Constant pressure Nose-Hoover dynamics (NPT)
<a href="#id137"><span class="problematic" id="id138">:raw-latex:`\cite{martyna}`</span></a>;</p></li>
<li><p>MD = 6, Berendsen dynamics (NVT) <a href="#id139"><span class="problematic" id="id140">:raw-latex:`\cite{Berendsen}`</span></a>;</p></li>
<li><p>MD = 7, Constant pressure Berendsen dynamics (NPT)
<a href="#id141"><span class="problematic" id="id142">:raw-latex:`\cite{Berendsen2}`</span></a>;</p></li>
<li><p>MD = 8, Multi-Scale Shock Technique (MSST) <a href="#id143"><span class="problematic" id="id144">:raw-latex:`\cite{Reed}`</span></a>.</p></li>
<li><p>MD = 100, 101, calculating multiple configurations stored in
IN.MOVEMENT</p></li>
</ol>
<p>Verlet is for NVE (fixed number of atom N, fixed volume V, and fixed
total energy E), Langevin and Nose-Hoover are for NVT (fixed number of
atom N, fixed volume, and fixed temperature T), and Constant pressure
Langevin or Nose-Hoover dynamics are for NPT (fixed number of atom N,
fixed pressure P, and fixed temperature T). Currently, we do not have
NPE. We also provide MSST (Multi-Scale Shock Technique) to simulate a
compressive shock wave passing over the system.</p>
<p>One can also set: MD=11,22,33,44,55,66,77,88 which means the continue
run of MD following the previous runs.</p>
<p><strong>MSTEP</strong>: the number of MD steps.</p>
<p><strong>DT</strong>: the time length for each MD step (in the unit of <span class="math notranslate nohighlight">\(fs\)</span>,
:math:<a href="#id145"><span class="problematic" id="id146">`</span></a>1fs</p>
<blockquote>
<div><p>=1times10^{-15}s`). Note, usually, with H atoms, dt should be</p>
</div></blockquote>
<p><span class="math notranslate nohighlight">\(1fs\)</span>, and with heavier atoms, dt could be <span class="math notranslate nohighlight">\(2fs\)</span>. However,
for rt-TDDFT run, dt should be much smaller, like 0.1 fs to 0.2 fs.</p>
<p><strong>TEMP1</strong>: the beginning temperature (in <span class="math notranslate nohighlight">\(Kevine\)</span>). When there is
no velocity session in the atom.config file, the TEMP1 will be used to
randomly generated an initial velocity (the initial kinetic energy is
generated as twice the 0.5*K*T, with the expectation that half of its
energy will be converted into potential energy). So, in the simulation,
the istep=1 temperature will be 2*TEMP1.</p>
<p><strong>TEMP2</strong>: the final temperature (in <span class="math notranslate nohighlight">\(Kevine\)</span>). TEMP2 will not be
used for MD=1, or 11 (NVE) (but still, it should be there as a place
holder). During the MD, the program will adjust the temperature
linearly, let it goes from TEMP1 to TEMP2. For MD=3,5 (Langevin), one
can use a LANGEVIN_ATOMFACT_TG section in the atom.config file to
specify a local atomic specified temperature (and Langevin parameter
gamma). In that case, the desired atomic temperature at a given time
equals the global desired temperature calculated from TEMP1 to TEMP2,
then multiplied by the atomic scaling factor specified in the
LANGEVIN_ATOMFACT_TG.</p>
<p>For method 1-8, one can use file IN.MDOPT to set detailed parameters by
setting IN.MDOPT=T, all the parameters will be written in file
OUT.MDOPT. The file and parameters(and the parameters’ default values)
are as follows,</p>
<p>IN.MDOPT:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">MD_CELL_TAU = 400*DT <a href="#id147"><span class="problematic" id="id148">``</span></a>`` !(for 4,5,8, LV,NH-cell)</div>
<div class="line"><a href="#id149"><span class="problematic" id="id150">``</span></a><a href="#id151"><span class="problematic" id="id152">``</span></a>! DT is the MD time step (<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id153"><span class="problematic" id="id154">``</span></a><a href="#id155"><span class="problematic" id="id156">``</span></a>! characteristic time for cell oscillations (<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id157"><span class="problematic" id="id158">``</span></a><a href="#id159"><span class="problematic" id="id160">``</span></a>! Larger MD_CELL_TAU results in a longer time to reach
equilibrium (both temperature and pressure) for the cell</div>
<div class="line">MD_ION_TAU = 40*DT <a href="#id161"><span class="problematic" id="id162">``</span></a>`` !(for 2,5, NH-ion)</div>
<div class="line"><a href="#id163"><span class="problematic" id="id164">``</span></a><a href="#id165"><span class="problematic" id="id166">``</span></a>! characteristic time for particles oscillations
(<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id167"><span class="problematic" id="id168">``</span></a><a href="#id169"><span class="problematic" id="id170">``</span></a>! This is for the NH algorithm, the time scale for the ion
movement to reach equilibrium for a given temperature. Longer
MD_ION_TAU, slower the particles to reach equilibrium.</div>
<div class="line"><a href="#id171"><span class="problematic" id="id172">``</span></a><a href="#id173"><span class="problematic" id="id174">``</span></a>! For more accurate simulation, one should use larger
MD_ION_TAU, but the fluctuation will also be larger.</div>
<div class="line">MD_LV_GAMMA = 0.01 <a href="#id175"><span class="problematic" id="id176">``</span></a>`` !(for 3,4, LV-ion)</div>
<div class="line"><a href="#id177"><span class="problematic" id="id178">``</span></a><a href="#id179"><span class="problematic" id="id180">``</span></a>! friction coefficient for particle movement in LV
(<span class="math notranslate nohighlight">\(fs^{-1}\)</span>).</div>
<div class="line"><a href="#id181"><span class="problematic" id="id182">``</span></a><a href="#id183"><span class="problematic" id="id184">``</span></a>! Larger MD_LV_GAMMA, faster it reaches equilibrium, but
then larger is the random noise in LV algorithm</div>
<div class="line"><a href="#id185"><span class="problematic" id="id186">``</span></a><a href="#id187"><span class="problematic" id="id188">``</span></a>! For more accurate, more realistic calculation, one needs
smaller MD_LV_GAMMA, but then the fluctuation will also be
bigger.</div>
<div class="line">MD_NPT_GAMMA= 0.01 <a href="#id189"><span class="problematic" id="id190">``</span></a>`` !(for 4, LV-NPT)</div>
<div class="line"><a href="#id191"><span class="problematic" id="id192">``</span></a><a href="#id193"><span class="problematic" id="id194">``</span></a>! friction coefficient for cell (<span class="math notranslate nohighlight">\(fs^{-1}\)</span>).</div>
<div class="line"><a href="#id195"><span class="problematic" id="id196">``</span></a><a href="#id197"><span class="problematic" id="id198">``</span></a>! Larger MD_NPT_GAMMA, faster it reaches cell equilibrium.</div>
<div class="line"><a href="#id199"><span class="problematic" id="id200">``</span></a><a href="#id201"><span class="problematic" id="id202">``</span></a>! For accurate calculation, one should use smaller
MD_NPT_GAMMA, but the fluctuation will also be larger.</div>
<div class="line">MD_NPT_PEXT= 0.0 <a href="#id203"><span class="problematic" id="id204">``</span></a>`` !(for 4,5,7, NPT)</div>
<div class="line"><a href="#id205"><span class="problematic" id="id206">``</span></a><a href="#id207"><span class="problematic" id="id208">``</span></a>! This is the applied external hydrastatic pressure (GPa).</div>
<div class="line">MD_NPT_PEXT_XYZ= 0.0 0.0 0.0 <a href="#id209"><span class="problematic" id="id210">``</span></a>`` !(for 4,5,7, NPT)</div>
<div class="line"><a href="#id211"><span class="problematic" id="id212">``</span></a><a href="#id213"><span class="problematic" id="id214">``</span></a>! external x,y,z pressure (GPa), over-write(higher priority
than) MD_NPT_PEXT.</div>
<div class="line">MD_BERENDSEN_TAU= 500*DT <a href="#id215"><span class="problematic" id="id216">``</span></a>`` !(for 6, 7, BR-ion)</div>
<div class="line"><a href="#id217"><span class="problematic" id="id218">``</span></a><a href="#id219"><span class="problematic" id="id220">``</span></a>! the atom velocity rescaling time in Berendsen method
(<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id221"><span class="problematic" id="id222">``</span></a><a href="#id223"><span class="problematic" id="id224">``</span></a>! Larger MD_BERENDSEN_TAU will be more accurate, but the
fluctuation will also be larger.</div>
<div class="line">MD_BERENDSEN_TAUP= 500*DT <a href="#id225"><span class="problematic" id="id226">``</span></a>`` !(for 7, BR-cell)</div>
<div class="line"><a href="#id227"><span class="problematic" id="id228">``</span></a><a href="#id229"><span class="problematic" id="id230">``</span></a>! the cell rescaling time in Berendsen method for MD=7
(<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id231"><span class="problematic" id="id232">``</span></a><a href="#id233"><span class="problematic" id="id234">``</span></a>! Larger MD_BERENDSEN_TAUP will be more accurate, but the
fluctuation will also be larger.</div>
<div class="line">MD_SEED= 12345 <a href="#id235"><span class="problematic" id="id236">``</span></a>`` !(for all)</div>
<div class="line"><a href="#id237"><span class="problematic" id="id238">``</span></a><a href="#id239"><span class="problematic" id="id240">``</span></a>! random seed for initializing the velocities</div>
<div class="line"><a href="#id241"><span class="problematic" id="id242">``</span></a><a href="#id243"><span class="problematic" id="id244">``</span></a>! when no velocities are specified in IN.ATOM file.</div>
<div class="line"><a href="#id245"><span class="problematic" id="id246">``</span></a><a href="#id247"><span class="problematic" id="id248">``</span></a>! if MD_SEED=-1, the random seed will be set using the
system_clock().</div>
<div class="line"><a href="#id249"><span class="problematic" id="id250">``</span></a><a href="#id251"><span class="problematic" id="id252">``</span></a>! if this is not set, a default 12345 will be used.</div>
<div class="line">MD_AVET_TIMEINTERVAL= 100*DT <a href="#id253"><span class="problematic" id="id254">``</span></a>`` !(for all)</div>
<div class="line"><a href="#id255"><span class="problematic" id="id256">``</span></a><a href="#id257"><span class="problematic" id="id258">``</span></a>! time interval to calculate average temperature and
pressure (<span class="math notranslate nohighlight">\(fs\)</span>).</div>
<div class="line"><a href="#id259"><span class="problematic" id="id260">``</span></a><a href="#id261"><span class="problematic" id="id262">``</span></a>! This is not for the instantaneous temperatur and pressure,
but the average values within the MD_AVET_TIMEINTERVAL time.</div>
<div class="line">MD_NPT_ISOSCALEV= 0 <a href="#id263"><span class="problematic" id="id264">``</span></a>`` !(for all)</div>
<div class="line"><a href="#id265"><span class="problematic" id="id266">``</span></a><a href="#id267"><span class="problematic" id="id268">``</span></a>! 1–overall scaling of the box; default=0</div>
<div class="line">NSTEP_OUTPUT_RHO= 100</div>
<div class="line"><a href="#id269"><span class="problematic" id="id270">``</span></a><a href="#id271"><span class="problematic" id="id272">``</span></a>! step interval to output the charge density</div>
<div class="line">MD_MSST_VS = 0.0</div>
<div class="line"><a href="#id273"><span class="problematic" id="id274">``</span></a><a href="#id275"><span class="problematic" id="id276">``</span></a>! velocity of shock wave (bohr/fs)</div>
<div class="line">MD_MSST_DIR = 0</div>
<div class="line"><a href="#id277"><span class="problematic" id="id278">``</span></a><a href="#id279"><span class="problematic" id="id280">``</span></a>! direction of shock wave (0–x, 1–y, 2–z)</div>
<div class="line">MD_ZERO_TOTMOMENT = F</div>
<div class="line"><a href="#id281"><span class="problematic" id="id282">``</span></a><a href="#id283"><span class="problematic" id="id284">``</span></a>! if MD_ZERO_TOTMOMENT=T, make system’s total momentum to
zero; default = F</div>
</div>
</div>
</div>
<div class="line-block">
<div class="line">In the Berendsen method (MD=6,7,66,77), the kinetic energy is scaled
at every MD step as (1+(Tdesired/Tcurrent-1)*dt/tau). For MD=7,77
(NPT), the cell box is scaled at every MD step as: cell(i1,i2) =
cell(i1,i2) * ( 1+(press(i1,i2) - press_ext(i1,i2)) *
stress_mask(i1,i2) * dt / tauP ). Here press, press_ext are pressures
in the unit of <span class="math notranslate nohighlight">\(eV/Angstrom^3\)</span>. Note, press(3,3) equals the
stress(3,3)/volume, so it is a 3x3 tensor. The external pressure
press_ext(i,j)=delta_i,j MD_NPT_PEXT_XYZ(i). Note, this is input from
IN.MDOPT, not the stress from the atom.config. If MD_NPT_PEXT_XYZ is
not specified, then MD_NPT_PEXT_XYZ(:) = MD_NPT_PEXT. If both</div>
<div class="line">MD_NPT_PEXT_XYZ and MD_NPT_PEXT are not speficied, then the external
pressure is zero. The stress_mask is from atom.config. The detault
value is stress_mask(i1,i2)=1 (for every element of the matrix).</div>
</div>
<p>One can always set MD_SEED and MD_AVET_TIMEINTERVAL. For MD=4 or 5, one
can check the internal pressure in file MDSTEPS and MOVEMENT.</p>
<p>In the MSST method(MD=8,88), you always need to set MD_TAU_CELL,
MD_MSST_VS, MD_MSST_DIR. MD_TAU_CELL will set the masslike parameter for
the simulation cell size, i.e. Q in paper <a href="#id285"><span class="problematic" id="id286">:raw-latex:`\cite{Reed}`</span></a>, but
MD_TAU_CELL itself is the time to arrive equilibrium. MD_MSST_VS is the
shock speed <span class="math notranslate nohighlight">\(v_s\)</span> in paper <a href="#id287"><span class="problematic" id="id288">:raw-latex:`\cite{Reed}`</span></a>. MD_MSST_DIR
is the shock direction, its value can be 0, 1 or 2 for in x, y or z
direction. IN file MOVEMENTS you can check MD_MSST_INFO for additional
outputs. IN file MDSTEPS there adds a new column “V/V0”, which shows the
change of vulome. In the process of MSST, if MD_MSST_VS is kind of large
in some way and the size of box changes alot, PWmat will hard to
converge or evan crash. You need to reduce the time step, i.e. use
smaller DT in MD_DETAIL.</p>
<p>When MD=11/22/33/44/55/66/77/88, it is a continue run for
Verlet/Langevin/Nose-Hoover constant pressure, Langevin/constant
pressure Nose-HooverNPT,Berendsen NVT, Berendsen NPT respectively. In
these cases, the atom.config file should include the velocity section.
Note, for JOB=MD, if there is velocity section in atom.config, the
velocity will be used, and there is no initial scaling of the velocity
using temperature TEMP1.</p>
<p><strong>SPECIAL LV</strong>: There is a special feature for LV dynamics (either 3 or
4). In this special feature, we can specify the desired temperature for
each atom. We can also specify the desired GAMMA value (the MD_LV_GAMMA)
for each atom. In another words, you can make one atom very hot, and let
the temperature decaying from this atom. The temperatue decaying length
will be controlled by the MD_LV_GAMMA. Smaller this value, decaying
length will be longer, i.e., more graduate. The atom specific
temperature and Gamma are controlled by scaling factors, they are
specified in the atom.config file, with a special session called:
“LANGEVIN_ATOMFACT_TG”. They have the following formats (see section
<a class="reference external" href="#section:atom.config">2.3</a>):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LANGEVIN_ATOMFACT_TG</span>
<span class="mi">30</span>  <span class="mf">0.5</span>   <span class="mf">1.0</span>
<span class="mi">30</span>  <span class="mf">0.2</span>   <span class="mf">1.2</span>
<span class="o">..............</span>
<span class="n">atom</span> <span class="n">scaleT</span>  <span class="n">scaleG</span>
</pre></div>
</div>
</div>
<p>Here the desired temperature for one atom equals the original desired
temperature specified by temp1, temp2 and the steps, then multiplied by
scaleT(iatom). The Gamma for one atom equals the MD_LV_GAMMA specified
in the above table, or its default value, multipled by scaleG(iatom).</p>
<p><strong>SPECIAL FORCE</strong>: In all the MD calculation, one can add atom specified
external force on each atom. This is done by using IN.EXT_FORCE=T in
etot.input. In that case, A file called IN.EXT_FORCE needs to be
provided, it will give the external force on each atom during the
molecular dynamics, or during atomic relaxation. Please see the section
IN.EXT_FORCE for more details.</p>
<p><strong>MD=100,101</strong>: for these choices, instead of doing an actual MD
simulation following the atomic forces, the multiple configurations
stored in a file IN.MOVEMENT will be calculated one after another, so
the forces will not really be used, and the trajectory follows the one
in IN.MOVEMENT. Note, in the running directory, a IN.MOVEMENT file need
to be provided. This is mostly used for some special purposes, for
example for machine learning force field development, while the
IN.MOVEMENT is generated by force field. For MD=101, the charge and wave
function interpolation is turned off. This might be useful if the
configures in IN.MOVEMENT change dramatically from one frame to another
frame. While the format in IN.MOVEMENT is the same as in the output
MOVEMENT, it must provide a header. It is like this:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The formate of IN.MOVEMENT
-------------------------------
nstep,nskip1,nskip2,nkip3,njump
64, atoms,Iteration .....
...
Lattice vector (Angstrom)
0.1130000000E+02    0.0000000000E+00    0.0000000000E+00
0.0000000000E+00    0.1130000000E+02    0.0000000000E+00
0.0000000000E+00    0.0000000000E+00    0.1130000000E+02
Position (normalized), move_x, move_y, move_z
31         0.99973    0.99973    0.99973     1  1  1
31         0.99985    0.24985    0.24985     1  1  1
.......
.......
----------------------------------------
The code used to read the IN.MOVEMENT file is as following:
-------
do istep=1,nstep
do ii=1,njump
do i=1,nskip1
read(IN.MOVEMENT,*)
enddo
read(IN.MOVEMENT,*) AL(1,1),AL(2,1),AL(3,1)
read(IN.MOVEMENT,*) AL(1,1),AL(2,1),AL(3,1)
read(IN.MOVEMENT,*) AL(1,1),AL(2,1),AL(3,1)
do i=1,nskip2
read(IN.MOVEMENT,*)
enddo
do i=1,natom
read(IN.MOVEMENT,*) iat(i),x1(i),x2(i),x3(i)
enddo
do i=1,nskip3
read(IN.MOVEMENT,*)
enddo
enddo ! ii=1,njump
enddo ! istep=1,nstep
----------------------------------------
</pre></div>
</div>
</div>
<p>The nskipt1,nskipt2,nskip3 are the skips of lines in different segment
of the IN.MOVEMENT file. The njump indicates whether you like to
calculate every configuration (njump=1), or you like to jump over some
configurations, e.g., njump&gt;1. nstep is the total number of steps to
calculate. You might need to check the IN.MOVEMENT file to determine the
nskip1,nskip2,nskip3. nskip2 is usually 1.</p>
<p id="section-6"><strong>MD_SPECIAL = iflag,x1,x2,x3,Rcut,dR,dV</strong></p>
<p>or</p>
<p><strong>MD_SPECIAL= iflag,x1,x2,x3,Rcut,dR,dV,frac,P,rate</strong></p>
<p><strong>Default: iflag=0</strong></p>
<p><strong>iflag=1</strong>: this is a special constraint in MD. In this option, at t=0,
all atoms within Rcut from the center (x1,x2,x3) will be frozen, and all
the other atoms will be subjected to a spherical potential with height
dV (eV) centered at (x1,x2,x3) (fractional coordinate) with radius
cut-off Rcut (ansgtrom) and a buffer dR (in a potential file as:
dV*exp(-(r-Rcut)/dR)/(exp(-(r-Rcut)/dR)+1)). This is used to keep the
atoms out (dV&gt;0) from one domain, or keep the atoms within one domai
(dV&lt;0).</p>
<p><strong>iflag=2</strong>: this will not freeze the atoms within Rcut, otherwise, it
is the same as in iflag=1.</p>
<p><strong>iflag=22</strong>: this is the same as in iflag=2, except, when calculating
the distance for one atom position (x1a,x2a,x3a) to the spherical center
(x1,x2,x3), one do not do periodic wraping for the atoms position.
Instead, the atoms position (x1a,x2a,x3a) are defined within
([0,1],[0,1],[0,1]) range. This can be useful, for example, to restraint
the water on top of a slab, where one place the (x1,x2,x3) below the
slab, so the water will be inside a halfdome on top of the slab, but it
will not affect the water on the other side of the periodic box.</p>
<p><strong>iflag=3</strong>: this option requires the frac,P,rate in the input line.
frac is the fraction [0,1] of the halfdome to the whole sphere. E.g., if
the sphere is a halfdome above a substate (like in iflag=22,33), then
the frac will be less than 1. This is used to estimate the surface of
the halfdome. P: the desired pressure in the unit of bar
(0.987atmosphere). rate is a MD change rate for each MD step. The idea
here is that, during MD, one can change Rcut (radius) of the confinement
sphere (usually, dV is negative for this), so the pressure on the
confinement wall equals to P. This will help to decide what Rcut one
should use. Note, P should not be too small, otherwise it might be
difficult to converge. We recommend(e.g.): P = 50 bar (atmosphere),
rate=0.02. Note, one should have a reasonably large dR, so the force
will not be too large. For example, dV=-2 (eV), dR=1(A). frac is
determined from the geometry. If it is a full sphere constraint, then
frac=1. For iflag=33, e.g., an halfdome constraint, then it is the solid
angle ratio between the halfdome solid angle and the 4<span class="math notranslate nohighlight">\(\pi\)</span> full
sphere solid angle (this is used to calculate the halfdome surface
area). The actually pressure (P_sph), the input desired pressure P_MD_sp
(=P), and the dynamically adjusted Rcut (Rcut_MD_sp) will be reported in
the header of MOVEMENT file for each step.</p>
<p><strong>iflag=33</strong>: same as for iflag=3, except, when define the constraint,
no wrapping, the same as for iflag=22. This is usually used to define a
halfdome on top of a slab.</p>
<p>In iflag=1,2,3,22,33, one can use a “Weight_Atom” section in
xatom.config file to specify which atom can feel this potential (or how
much weight to feel this potential).</p>
<p>More specifically, in the xatom.config file, one can add a section like:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">Weight_Atom</div>
<div class="line">iatom(1), weight(1)</div>
<div class="line">iatom(2), weight(2)</div>
<div class="line">….</div>
<div class="line">iatom(natom),weight(natom)</div>
</div>
</div>
</div>
<p>The weight(i), for i=1,natom can be used for many special purposes in
the code where a coefficient for an atom is needed. iatom(i) is the atom
z-number.</p>
<p>So, as a result, the potential felt by each atom is dV*weight(i). So,
one can turn-off some of the atoms to feel this particular potential.</p>
<p id="subsection-nebdetail"><strong>NEB_DETAIL = IMTH, NSTEP, FORCE_TOL, NIMAGE, AK, TYPE_SPRING,
:math:`E_0`, :math:`E_N`, ITYPE_AT2, ATOM2.CONFIG</strong></p>
<p>The <strong>NEB_DETAIL</strong> line is needed when JOB=NEB.</p>
<p>For the NEB algorithm, please refer to Ref.:raw-latex:<cite>cite{NEB}</cite>. In
the NEB run, NIMAGE+2 atomic configurations are used, the NIMAGE
intermediate configurations connect the initial configuration (in
ATOM.CONFIG) with the final configuration (in ATOM2.CONFIG). This is
also called the string. During the NEB run, the NIMAGE intermediate
configurations will be relaxed together, almost like a NIMAGE*natom atom
large system. However, during the atomic relaxation, the atomic force
component along the string will be removed (hence not be minimized), so
this is call the nudged elastic band method. The goal is to have the
force perpendicular to the string to be zero (the string will be moved
during the relaxation), while leave alone the atomic force component
along the string, meanwhile hopefully keep the distance roughly equal
among the NIMAGE+2 image points. Larger the NIMAGE, more difficult is
the calculation. For simple problems, typically NIMAGE can be about 5.
The output of NEB is written in RELAXSTEPS, and MOVEMENT.</p>
<p><strong>IMTH</strong>: the algorithm used for atomic relaxation.</p>
<p>IMTH = 1 / 2 / 3 / 4 / 5 / 6</p>
<ol class="arabic simple">
<li><p>IMTH=1, conjugate gradient;</p></li>
<li><p>IMTH=2, BFGS;</p></li>
<li><p>IMTH=3, steepest decent.</p></li>
<li><p>IMTH=4, VFF preconditioned conjugate gradient</p></li>
<li><p>IMTH=5, Limited-memory BFGS</p></li>
<li><p>IMTH=6, FIRE: Fast Inertial Relaxation Engine
<a href="#id289"><span class="problematic" id="id290">:raw-latex:`\cite{FIRE}`</span></a></p></li>
</ol>
<p>For NEB calculation, for good convergency. Some options can be set for
the optimizers in the optional file IN.RELAXOPT(need to set
IN.RELAXOPT=T in etot.input). The IN.RELAXOPT is as follows:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">RELAX_MAXMOVE = 1.0</div>
<div class="line"><a href="#id291"><span class="problematic" id="id292">``</span></a><a href="#id293"><span class="problematic" id="id294">``</span></a>! max move distance. unit bohr – for method=1,5,6.</div>
<div class="line">LBFGS_MEMORY = 30</div>
<div class="line"><a href="#id295"><span class="problematic" id="id296">``</span></a><a href="#id297"><span class="problematic" id="id298">``</span></a>! LBFGS storage size – for method=5.</div>
<div class="line">FIRE_DT = 1.0</div>
<div class="line"><a href="#id299"><span class="problematic" id="id300">``</span></a><a href="#id301"><span class="problematic" id="id302">``</span></a>! initial time step. unit fs – for method=6.</div>
<div class="line"><a href="#id303"><span class="problematic" id="id304">``</span></a><a href="#id305"><span class="problematic" id="id306">``</span></a>! the max time step for FIRE method is 10*FIRE_DT.</div>
<div class="line">RHOWG_INTER_TYPE = 1</div>
<div class="line"><a href="#id307"><span class="problematic" id="id308">``</span></a><a href="#id309"><span class="problematic" id="id310">``</span></a>! interpolation type for NEB,0–both rho and wave function;
1–rho.</div>
<div class="line"><a href="#id311"><span class="problematic" id="id312">``</span></a><a href="#id313"><span class="problematic" id="id314">``</span></a>! default = 1, save time by not writing wavefunction to disk</div>
</div>
</div>
</div>
<p><strong>NSTEP</strong>: the maximum number of line-minimization steps in the
relaxation process. This is the NEB steps.</p>
<p><strong>FORCE_TOL</strong>: the atomic force tolerance (<span class="math notranslate nohighlight">\(eV/{\textup{\AA}}\)</span>) to
stop the relaxation. This is the maximum atomic force (after the
component along the string direction has been projected out) of all the
atoms and all the images.</p>
<p><strong>NIMAGE</strong>: the number of images in the NEB method (these are the images
except the initial and final two valleys). So, there are in total
NIMAGE+2 configurations in the string of images connection the initial
and final configurations. In a NEB calculation, NIMAGE+2 atomic
configurations (called images) are used, which connect the configuration
from the initial state to the final state. Initially, the NIMAGE
intermediate images are generated by linear interpolations of the two
end images (the two end images, one initial, one final, are input by the
user). The two end images will not be changed, while the NIMAGE
intermediate images will be relaxed.</p>
<p><strong>AK</strong>: the spring constant for the image string
(<span class="math notranslate nohighlight">\(eV/{\textup{\AA}}^2\)</span>). In the NEB, a string connecting the
images are used to ensure the coverage between the initial and final
configurations. <span class="math notranslate nohighlight">\(AK\)</span>=0.1 to 1 <span class="math notranslate nohighlight">\(eV/{\textup{\AA}}^2\)</span> are
reasonable values. Larger <span class="math notranslate nohighlight">\(AK\)</span> (especially for TYPE_SPRING=2),
better the convergence, but it can introduce bigger errors (for
TYPE_SPRING=2).</p>
<p><strong>TYPE_SPRING</strong>: the type of string used in NEB algorithm.</p>
<ol class="arabic simple">
<li><p>TYPE_SPRING=1, the original NEB algorithm (where the string force
perpendicular to the string tangent is removed);</p></li>
<li><p>TYPE_SPRING=2, a conventional string, the perpendicular string force
is not removed;</p></li>
<li><p>TYPE_SPRING=3, the regular NEB algorithm(Improved tangent estimate in
the nudged elastic band method for finding minimum energy paths and
saddle points) <a href="#id315"><span class="problematic" id="id316">:raw-latex:`\cite{RENEB}`</span></a></p></li>
</ol>
<p>TYPE_SPRING=2 converges better, but it can introduce an error (larger
<span class="math notranslate nohighlight">\(AK\)</span>, larger the error). But one can first use larger <span class="math notranslate nohighlight">\(AK\)</span>,
then after the initial NEB relaxed, re-runs NEB using smaller <span class="math notranslate nohighlight">\(AK\)</span>
(or TYPE_SPRING=1,3). This will help the convergence.</p>
<p>Usually the TYPE_SPRING=1,2,3 converge good with IMTH=5,6. One can
directly try the TYPE_SPRING=1 or 3 with IMTH=5 or 6, if bad, then
follow the above advice(use TYPE_SPRING=2 first).</p>
<div class="line-block">
<div class="line">Additionally, one can use TYPE_SPRING=11,22,33 for CI-NEB(11-original
CI-NEB, 22-conventional string CI-NEB, 33-regular CI-NEB). The
climbing image NEB(CI-NEB) method constitutes a small modification to
the NEB method:raw-latex:<cite>cite{CINEB}</cite>. Information about the shape
of the MEP is retained, but a rigorous convergence to a saddle point
is also obtained. CI-NEB will choose the image with highest energy as
the climbing image, then reformat the force on the climbing image. The
force on the climbing image is the full force due to the potential
with the component along the elastic string inverted, so the climbing
image is not affected by the spring forces, and will climb up along
the elastic string to converge rigorously on the highest saddle point.</div>
<div class="line">Some suggestions</div>
</div>
<ol class="arabic simple">
<li><p>How to choose NEB method – TYPE_SPRING</p></li>
</ol>
<p>As mentioned above, TYPE_SPRING=2 is easy to converge, but can introduce
large error. So if TYPE_SPRING=1 or 3 converges bad, you can first run
the TYPE_SPRING=2 to get a better guess of the MEP, then rerun NEB with
TYPE_SRPING=1 or 3.</p>
<p>For TYPE_SPRING=1 (original NEB) and TYPE_SPRING=3 (regular NEB), both
has intrinsic instability. For the original NEB, “In systems where the
force along the minimum energy path is large compared to the restoring
force perpendicular to the path and when many images of the system are
included in the elastic band (string), kinks can develop and prevent the
band from converging to the minimum energy path”. For the regular NEB,
the spring force’s formulation omits the the spring force that is
perpendicular to the local tangent, then you may encounter that pathway
deviate from the MEP and the overall path lengths may grow out of
proportion. <a href="#id317"><span class="problematic" id="id318">:raw-latex:`\cite{AUTONEB}`</span></a></p>
<p>Maybe your first choice can be TYPE_SPRING=1, if you find the ’kinks’ is
the problem, then try TYPE_SPRING=3.</p>
<ol class="arabic simple" start="2">
<li><p>How to choose relaxation method – IMTH</p></li>
</ol>
<p>All IMTH=1,2,3,4,5,6 are methods based on forces, and IMTH=1,2,3,4 each
has an exact line-minimization, IMTH=5,6 do not have exact
line-minimization. If the forces are not smooth in the calculations,
methods with exact line-minimization may not converge well (you will see
jumps of the energy as a function of iteration steps). In NEB
calculations we recommend the IMTH=5,6. IMTH=5 (Limited-memory BFGS) is
fast, and you can set RELAX_MAXMOVE in file IN.RELAXOPT to make it more
stable or more aggressive. IMTH=6 (Fast Inertial Relaxation Engine) is
stable, and you can set FIRE_DT in file IN.RELAXOPT to get more stable
or more faster convergence.</p>
<p>We recommend the first choice is IMTH=5.</p>
<ol class="arabic simple" start="3">
<li><p>How to choose the psedupotentials</p></li>
</ol>
<p>PWmat provide several types of psedupotentials, NCPP-SG15, NCPP-PD03,
NCPP-PD04, ONCV-PWM-PBE, etc. We recommend to try to use the
ONCV-PWM-PBE first, it is more smooth, and more easy to converge for
relaxation. However, you might want to test this pseudopotential with
the more accurate ones, like SG15 and PD03. There are cases the PWM-PBE
gives the wrong results. But if it works, you can use it for large
system calculations. If you want to use SG15,PD03,or PD04, we recommend
to use bigger Ecut (e.g, 50, 60 Ryd), and set Ecut2=4*Ecut (to avoid
egghead problem).</p>
<ol class="arabic simple" start="4">
<li><p>How to do CI-NEB</p></li>
</ol>
<p>Do not use CI-NEB from the beginning, that will converges bad. PWmat
CI-NEB will choose the climbing image automatically, so the climbing
image could change during the convergence process if do CI-NEB from the
beginning. We recommend first converge your NEB calculation, then rerun
use the CI-NEB. (CI-NEB is specified use TYPE_SPRING: 11-original
CI-NEB, 22-conventional string CI-NEB, 33-regular CI-NEB).</p>
<ol class="arabic simple" start="5">
<li><p>The last but not least</p></li>
</ol>
<div class="line-block">
<div class="line">Make sure the SCFs are converged.</div>
<div class="line"><strong>:math:`E_0,E_N`</strong>: the precalculated (e.g., using JOB=RELAX) initial
(<span class="math notranslate nohighlight">\(E_0\)</span>) and final (<span class="math notranslate nohighlight">\(E_N\)</span>) local minima energies (in
<span class="math notranslate nohighlight">\(eV\)</span>) for configurations in ATOM.CONFIG and ATOM2.CONFIG.
Actually, these numbers are not used in the algorithm, but will make
plotting more straight forward.</div>
</div>
<p><strong>ITYPE_AT2, ATOM2.CONFIG</strong>: the type of ATOM2.CONFIG file and the
atomic position file name: ATOM2.CONFIG.</p>
<ol class="arabic simple">
<li><p>ITYPE_AT2=1, ATOM2.CONFIG is the second minimum configuration (the
first local minimum configuration is given in IN.ATOM = ATOM.CONFIG).
Then, from ATOM.CONFIG to ATOM2.CONFIG, NIMAGE equal distance images
will be created by linear interpolations.</p></li>
<li><p>ITYPE_AT2=2, ATOM2.CONFIG contains all the NIMAGE+2 image
configurations (most likely from a previous unconverged NEB run, and
copied from MOVEMENT), . Thus ITYPE_AT2=2 is a continued NEB run
following the previous NEB runs. In this case, the ATOM.CONFIG in
IN.ATOM = ATOM.CONFIG is not used (but that line still need to be
provided). Note, in this case, the atomic positions files for each
image inside ATOM2.CONFIG must have first the “POSITION” section,
followed by “FORCE” section, even though atomic forces are not used.
That is the format output in MOVEMENT under JOB=NEB. See NEB.BARRIER
for JOB=NEB output file. There are cases where the linear
interpolation between the first and the last configuration will
generate some unphysical NIMAGE IMAGIES (e.g., with atoms too close
together, or bond orders wrong). In that case, the user can use
ITYPE_AT2=2 to provide NIMAGE intermediate images manually, to avoid
the unphysical interpolation.</p></li>
</ol>
<div class="line-block" id="section-7">
<div class="line"><strong>TDDFT_DETAIL = :math:`m_1` :math:`m_2` mstate</strong></div>
<div class="line">This line is needed when JOB=TDDFT. Note if mstate=-1, this is for
TDDFT_NOB calculation, see below.</div>
</div>
<div class="line-block">
<div class="line">Note, when JOB=TDDFT, besides TDDFT_DETAIL, it also reads in
parameters from MD_DETAIL, and optionally from TDDFT_SPACE,
TDDFT_TIME,</div>
<div class="line">TDDFT_STIME.</div>
</div>
<p>In the TDDFT calculation, we expand the time dependent electron orbital
<span class="math notranslate nohighlight">\(\psi_j(t)\)</span> in terms of the adiabatic eigenstates
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \psi_j(t)=\sum\limits_{i}C_{ji}\phi_i(t)
    \end{aligned}\]</div>
<p>There will be <span class="math notranslate nohighlight">\(mstate\)</span> electron wavefunctions [j=1,mstate] which
will be occupied by their occupation number o(j) and described by
<span class="math notranslate nohighlight">\(\psi_j(t)\)</span>.</p>
<p>However, for the first <span class="math notranslate nohighlight">\(m_1-1\)</span> orbital (<span class="math notranslate nohighlight">\(j=1,m_1-1\)</span>),
<span class="math notranslate nohighlight">\(\psi_j(t)\)</span> is just <span class="math notranslate nohighlight">\(\phi_i(t)\)</span>, i.e., these <span class="math notranslate nohighlight">\(m_1\)</span>
states are fully occupied like in Born-Oppenheimer MD, no electron
excitation:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \psi_j(t)=\phi_j(t), j=1,m_1-1
    \end{aligned}\]</div>
<p>For the next <span class="math notranslate nohighlight">\(j=m_1, mstate\)</span> state (so, mstate include the
[1,<span class="math notranslate nohighlight">\(m_1-1\)</span>] state!), we will expand the <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> in the
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span> window of <span class="math notranslate nohighlight">\(i=m_1,m_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \psi_j(t)=\sum_i C_{ji}(t)\phi_i(t), j=m1,mstate;i=m1,m2
    \end{aligned}\]</div>
<p>Thus, in total, the expansion window is [<span class="math notranslate nohighlight">\(m_1,m_2\)</span>], and the total
number of time dependent orbital is: mstate (they will be occupied by
o(j), so mstate can be larger than the NUM_ELECTRON/IPSIN. However,
within the mstate, the first <span class="math notranslate nohighlight">\(m_1-1\)</span> states are fully occupied,
and just equal to the adiabatic eigen states, the next
<span class="math notranslate nohighlight">\(mstate-m_1\)</span> state will be expanded using adiabatic state within
the window of [<span class="math notranslate nohighlight">\(m_1,m_2\)</span>], and their occupation might follow the
Fermi-Dirac rule, or to be input by IN.OCC/IN.OCC_2 (see Appendix
<a class="reference external" href="#chapter:APPENDIX">8</a>). The initial <span class="math notranslate nohighlight">\(C_{ji}\)</span> can also be input
from IN.CC/IN.CC_2 (see Appendix <a class="reference external" href="#chapter:APPENDIX">8</a>).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\([m1,m2]\)</span></p></th>
<th class="head"><p>Adiabatic window <span class="math notranslate nohighlight">\(\phi_{i,i=m1,m2}\)</span>. The
<span class="math notranslate nohighlight">\([1,m1-1]\)</span> will always be occupied by
the first <span class="math notranslate nohighlight">\(\psi_{j,j=1,m1-1}\)</span> states.
<span class="math notranslate nohighlight">\(m2 \in [m1,NUM\_BAND]\)</span> , usually
<span class="math notranslate nohighlight">\(m2\)</span> is smaller than <span class="math notranslate nohighlight">\(NUM\_BAND\)</span>
by a few states, because the last few states
maybe not converge well.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([1,mstate]\)</span></p></td>
<td><p>Wavefunction index.
<span class="math notranslate nohighlight">\(\psi_{j,j=1,mstate}\)</span>.
<span class="math notranslate nohighlight">\(mstate\in [m1,m2]\)</span></p></td>
</tr>
</tbody>
</table>
<p>The choice of m2 is important for the physical correctness of the TDDFT
simulations. The choice might depend on the physical problems at hand.
Larger the m2, more accurate will be the simulation, but it can also
cost more time to calculate. Typically, from mstate to m2, one should
include all the possible electron excitations. For example, for a light
excitation, if the hot electron can be 1-2 eV above the bottom of
conduction band, then m2 should be choosen to include all these bands.
Sometime m2 can be twice as mstate. But tests are needed to determine
this. All depend on how high the electron can be excited to the
conduction band.</p>
<p>If mstate=-1, this is a special case, for TDDFT_NOB calculation. NOB
stands for natural orbital branching. In this case, we need another
line, which is:</p>
<div class="line-block">
<div class="line"><strong>TDDFT_NOB = iseed, S_c, tau, temp2, kin_scale, select_opt</strong></div>
<div class="line">iseed (negative integer) is a random number seed for the stochastic
NOB calculation. S_c is the cut-off entropy for the branching. tau is
the dephasing time (in fs). If tau is negative, then IN.BOLTZMANN_TAU
will be used to input tau(i) for each state, and the
tau<span class="math notranslate nohighlight">\(_{ij}\)</span> will be determined from
<span class="math notranslate nohighlight">\(\sqrt{tau(i)tau(j)}\)</span>. temp2 is the temperature for the case of
kin_scale=2. kin_scale=1,2,3 are three different ways for kinetic
energy scaling after branching, similar to the flag_scale=1,2,3 in the
TDDFT_BOLTZMANN flag. kin_scale=1 will scale all the atom’s velocity
uniformly to conserve the total energy. kin_scale=2 will scale all the
atom’s velocity uniformly to keep the temperature at temp2. As a
result this method will not conserve the total energy, and the total
energy will usually graduately decrease. kin_scale=3 will be the
standard way to scale the kinetic energy in the transition degree of
freedom, and conserve the total energy.</div>
</div>
<p>Select_opt=1,2,3 is the option for branching algorithm. 1: for using the
transition eigen energy difference and the current temperature (derived
from the current kinetic energy) with an Boltzmann factor to determine
the natural orbital branching probability to restore the detailed
balance. 2: for using the SCF total energy difference after a trial
branching and the current temperature to determine the natural orbital
branching probability. 3: this will also use the actual SCF total
energy, instead of eigen energies, to determine whether a branching is
allowed. However, instead of using a temperature and an Boltzamn factor,
in this scheme, the transition degree of freedom is first determines,
and whether this degree of freedom has enough kinetic energy to
compensate the SCF total energy increase, is used to determine whether
one particular branching is allowed. Note, for select_opt=3, one must
also choose kin_scale=3.</p>
<p>Note, kin_scale=3, select_opt=3 will be the standard way of doing
statistical branching.</p>
<p id="section-8"><strong>NAMD_DETAIL = :math:`m_1` :math:`m_2` nstep_out</strong></p>
<p>or</p>
<p><strong>NAMD_DETAIL = :math:`m_1` :math:`m_2` nstep_out, icycle,
nstep_cycle,icrossk,hc</strong></p>
<p>This line is needed (either the first format, or the second format) when
JOB=NAMD.</p>
<p>Note, when JOB=NAMD, besides NAMD_DETAIL, it also reads in parameters
from MD_DETAIL, and other possible options from TDDFT_SPACE, TDDFT_TIME,
TDDFT_STIME, NAMD_SPECIAL.</p>
<p>In the NAMD calculation, it performs an conventional Born-Oppenheimer
MD, but outputs the wave function overlap between consecutive time steps
for the adiabatic eigenstates within the window <span class="math notranslate nohighlight">\([m_1,m_2]\)</span>. It
uses the MD parameters from MD_DETAIL. The output is written in
OUT.NAMD, and will be used in post-process programs like
NAMD_Boltzman.f90 in utility, to carry out non-adiabatic MD simulation
for carrier dynamics. The carrier wave function <span class="math notranslate nohighlight">\(\psi(t)\)</span> will be
described by the adiabatic eigen states set within the window
<span class="math notranslate nohighlight">\([m_1,m_2]\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \psi(t)=\sum_i C_{i}(t)\phi_i(t), i=m1,m2
    \end{aligned}\]</div>
<p>Note, inside OUT.NAMD (which is an unformatted file), it has the
following write-out format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">istep0</span><span class="p">,</span><span class="n">islda</span><span class="p">,</span><span class="n">nkpt</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">do</span> <span class="n">iislda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">islda</span>
<span class="n">do</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">eigen</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mx</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
<span class="n">do</span> <span class="n">istep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nstep</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span><span class="n">islda</span><span class="p">,</span><span class="n">nkpt</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">do</span> <span class="n">iislda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">islda</span>
<span class="n">do</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">hh</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mst_win</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">mst_win</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">eigen</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mx</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
</pre></div>
</div>
</div>
<p>The first step is different from the rest of the steps. mx is the number
of bands calculated, while <span class="math notranslate nohighlight">\(mst\_win=m_2-m_1+1\)</span> is the window of
the NAMD output. Eigen is the eigen energy in atomic unit (Hartree).
<span class="math notranslate nohighlight">\(hh(m1,m2,kpt,iislda)= &lt;\psi_{m1}^*(istep-1)|\psi_{m2}(istep)&gt;\)</span>
for this kpt and spin iislda.</p>
<p>There are also more advanced options (the second line form). There
icrossk=0 or 1: 0, no action for this, 1, output the kpoint cross
product in another file: OUT.NAMD_CROSSK. This is only useful if
multiple kpoints are used. This file has the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">istep0</span><span class="p">,</span><span class="n">islda</span><span class="p">,</span><span class="n">nkpt</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">do</span> <span class="n">iislda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">islda</span>
<span class="n">do</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">eigen</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mx</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
<span class="n">do</span> <span class="n">istep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nstep</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">istep</span><span class="p">,</span><span class="n">islda</span><span class="p">,</span><span class="n">nkpt</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">do</span> <span class="n">iislda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">islda</span>
<span class="n">do</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">,</span><span class="n">mst_win</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">hh2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mst_win</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">mst_win</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nkpt</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">eigen</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mx</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
<span class="n">enddo</span>
</pre></div>
</div>
</div>
<p>The only difference is that, in OUT.NAMD, each time step we have:
hh(m1,m2), here we have
<span class="math notranslate nohighlight">\(hh2(m1,m2,kpt2,kpt,iislda)= &lt;u^*(m1,kpt,istep-1)|u'(m2,kpt2,istep&gt;\)</span>,
so you have cross kpoint dot-product. Note, u is the Bloch part of the
wave function, so the cross-k point dot product is not zero. For
kpt2.eq.kpt, u’ is just the u. But if kpt2.ne.kpt, then u’(istep) has
been project out the component of the u(istep-1) in the following way:</p>
<div class="math notranslate nohighlight">
\[u'(m_2,kpt_2,istep)= u(m_2,kpt_2,istep)-\sum_{m_3} h(m_3,m_2,kpt_2)*\]</div>
<div class="math notranslate nohighlight">
\[[1- exp(-(|h(m_3,m_2,kpt_2)|^4/hc^2)] u(m_3,kpt_2,istep-1)\]</div>
<p>here
<span class="math notranslate nohighlight">\(h(m_3,m_2,kpt_2)=&lt;u^*(m_3,kpt_2,istep-1)|u(m_2,kpt_2,istep&gt;\)</span>.
Everything is done within the same iislda. The above output can be used
for a special algorithm for postprocess NAMD calculations allowing the
hot carrier to jump k-points. One can take <span class="math notranslate nohighlight">\(hc\)</span> to be about 0.1,
for time step 1fs MD. For better result, one can reduce the time step,
while further decrease <span class="math notranslate nohighlight">\(hc\)</span>.</p>
<p>Another special option is the icycle option. If icycle=0, no action will
be taken. If icycle=1, then the program will try to make the MD periodic
in time. Note, for this scheme, one cannot restart the MD. So, iMD must
equal to 1, not 11, etc. The nstep_cycle is the buffer region. One
possibility, for example, is MDstep=1000 (or 2000), nstep_cycle=200. The
idea is that, the code will make the last step (istep=MDstep) the same
(in both atomic position and velocity) as the nstep_cycle step (note,
not the first step). Hence the MD will do a time cycle with a
periodicity of MDstep-nstep_cycle. In the NAMD post-process, this can be
used to carry out the NAMD forever, while the nuclear movement has a
periodicity of MDstep-nstep_cycle steps. Note, ath the MDstep-th step,
the adiabatic wave function has used the same one as that for the
nstep_cycle-th step. This allows the NAMD calculations to continue
forever. Note, it must be critical to check the potential and kinetic
energy in MDSTEPS file, make sure the transition period is smooth. It is
critical, for this to work, the whole system from beginning to the end
should not drift away. Instead, most atom should only have vibrations
(e.g., as in a crystal system).</p>
<p>The nstep_out is the number of steps interval to output the wave
functions (within the window <span class="math notranslate nohighlight">\([m_1,m_2]\)</span>) into the ugio.allxxxxxx
file. Note, this could be large files, so you probably don’t want to
output the wave function at every step (e.g., nstep_out=1). However,
sometime the output wave functions can be used to do some
postprocessing, which are not done during the NAMD simulation. For
example, the wave functions can be used to introduce some additional
term <span class="math notranslate nohighlight">\(\delta H\)</span>, so you have
<span class="math notranslate nohighlight">\(&lt;\phi_i(t)|\delta H|\phi_j(t)&gt;\)</span> during the postprocess steps. In
order to do this, you still don’t need to output <span class="math notranslate nohighlight">\(\phi_i(t)\)</span> at
every time step, because the code does output the overlap
<span class="math notranslate nohighlight">\(S_{ij}=&lt;\phi_i(t)|\phi_j(t+dt)&gt;\)</span> between consecutive steps, so
you can use the <span class="math notranslate nohighlight">\(S_{ij}\)</span> to link the adiabatic states at different
time. Nevertheless, you might still want to use a relatively small
nstep_out for this regard. As a balance, we found that nstep_out=50
might be a good choice for many problems. But be prepared for a lot of
files!</p>
<p>For more information, please see APPENDIX B.</p>
<p id="section-9"><strong>NAMD_SPECIAL = iflag_NAMD_sp, param1,param2</strong></p>
<p>This is an optional input section for special input parameters
(param1,param2) for JOB=NAMD calculations. Default iflag_NAMD_sp=0, the
parameters are not used.</p>
<p>When iflag_NAMD_sp=1, it will output the dipole moment matrix at every
MD step in a file called OUT.NAMD_SP. It is a binary file, with the
following format.</p>
<p>————————————–</p>
<p>Do istep=1,nstep</p>
<p>write(OUT.NAMD_SP) istep,islda,nkpt,param1,param2,mst_win,time</p>
<p>Do iislda=1,islda</p>
<p>DO kpt=1,nkpt</p>
<p>write(OUT.NAMD_SP) PXYZ</p>
<p>ENDDO</p>
<p>ENDDO</p>
<p>ENDDO</p>
<p>————————————–</p>
<p>Here PXYZ is a complex*16 matrix PXYZ(mst_win,param2-param1+1,3).
mst_win=m_2-m_1+1 from NAMD_DETAIL, are the number of states output for
NAMD calculation. Thus: <span class="math notranslate nohighlight">\(PXYZ(i,j,k)=&lt;\phi_i|P_k|\phi_j&gt;\)</span>, here
k=1,2,3, and <span class="math notranslate nohighlight">\(P_k\)</span> is the momentum operator <span class="math notranslate nohighlight">\(i\nabla_k\)</span>.</p>
<p id="section-relaxdetail"><strong>RELAX_DETAIL=IMTH, NSTEP, FORCE_TOL, ISTRESS, TOL_STRESS,
TOL_LINECORRECTION</strong></p>
<p><strong>Default:</strong></p>
<p><strong>RELAX_DETAIL = 1, 200, 0.02, 0, 0, -0.001</strong> (ACCURACY=NORM)</p>
<p><strong>RELAX_DETAIL = 1, 200, 0.01, 0, 0, -0.001</strong> (ACCURACY=HIGH or ACCURACY
= VERYHIGH)</p>
<p>This is an line for “JOB = RELAX”. It controls the atomic relaxation
steps. Note PWmat1.5+ can relax the lattice vectors.</p>
<p><strong>IMTH</strong> indicate the method of relaxation.</p>
<p>IMTH = 1 / 2 / 3 / 4 / 5 / 6</p>
<ol class="arabic simple">
<li><p>IMTH=1(default), conjugated gradient;</p></li>
<li><p>IMTH=2, BFGS method;</p></li>
<li><p>IMTH=3, steepest decent (this is mostly for JOB=NEB);</p></li>
<li><p>IMTH=4, Preconditioned Conjugate Gradient (PCG), experimental
feature, See <a class="reference external" href="#subsection2112">2.1.13</a> before you use this;</p></li>
<li><p>IMTH=5, Limited-memory BFGS method;</p></li>
<li><p>IMTH=6, FIRE: Fast Inertial Relaxation Engine.</p></li>
</ol>
<p>Please note that: all imths (1,2,3,4,5,6) can be used for atomic
relaxation, but only imth=1,5,6 can be used for cell relaxation. In
addition, some options can be set for the optimizers in file
IN.RELAXOPT(need to set IN.RELAXOPT=T in etot.input). The IN.RELAXOPT is
as follows:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">PSTRESS_EXTERNAL= 0.0</div>
<div class="line"><a href="#id319"><span class="problematic" id="id320">``</span></a><a href="#id321"><span class="problematic" id="id322">``</span></a>! external hydrostatic pressure. unit GPascal – for cell
relaxation</div>
<div class="line"><a href="#id323"><span class="problematic" id="id324">``</span></a><a href="#id325"><span class="problematic" id="id326">``</span></a>! the energy P*V (i.e. pressure*volume) will be written in
file REPORT with flag “Energy PV”.</div>
<div class="line">RELAX_MAXMOVE = 1.0</div>
<div class="line"><a href="#id327"><span class="problematic" id="id328">``</span></a><a href="#id329"><span class="problematic" id="id330">``</span></a>! max move distance. unit bohr – for method=1,5,6.</div>
<div class="line"><a href="#id331"><span class="problematic" id="id332">``</span></a><a href="#id333"><span class="problematic" id="id334">``</span></a>! This can be used to enforce small steps, for convergence.</div>
<div class="line">LBFGS_MEMORY = 30</div>
<div class="line"><a href="#id335"><span class="problematic" id="id336">``</span></a><a href="#id337"><span class="problematic" id="id338">``</span></a>! LBFGS storage size – for method=5.</div>
<div class="line">FIRE_DT = 1.0</div>
<div class="line"><a href="#id339"><span class="problematic" id="id340">``</span></a><a href="#id341"><span class="problematic" id="id342">``</span></a>! initial time step. unit fs – for method=6.</div>
<div class="line"><a href="#id343"><span class="problematic" id="id344">``</span></a><a href="#id345"><span class="problematic" id="id346">``</span></a>! the max time step for FIRE method is 10*FIRE_DT.</div>
<div class="line">RHOWG_INTER_TYPE = 1</div>
<div class="line"><a href="#id347"><span class="problematic" id="id348">``</span></a><a href="#id349"><span class="problematic" id="id350">``</span></a>! interpolation type for NEB: 0–both rho and wave function;
1–rho only.</div>
<div class="line"><a href="#id351"><span class="problematic" id="id352">``</span></a><a href="#id353"><span class="problematic" id="id354">``</span></a>! default = 1, save time by not writing wavefunction to disk</div>
<div class="line">NSTEP_OUTPUT_RHO=100</div>
<div class="line"><a href="#id355"><span class="problematic" id="id356">``</span></a><a href="#id357"><span class="problematic" id="id358">``</span></a>! step interval to output the charge density</div>
<div class="line"><a href="#id359"><span class="problematic" id="id360">``</span></a><a href="#id361"><span class="problematic" id="id362">``</span></a>! It is used to output more charge density for later use and
analysis.</div>
</div>
</div>
</div>
<p><strong>NSTEP</strong> is the maximum number of relaxation steps (each total energy
calculation is one step, i.e., it counts the steps inside the line
minimization in the total steps. In another word, NSTEP is more (at
least twice) than the CG steps).</p>
<p><strong>FORCE_TOL</strong> (in <span class="math notranslate nohighlight">\(eV/{\textup{\AA}}\)</span>) is the force tolerance for
the maximal residual force. If the maximum force is less than FORCE_TOL,
the relaxation will stop.</p>
<div class="line-block">
<div class="line"><strong>ISTRESS</strong> controls whether to relax the lattice vectors. If
ISTRESS=0 (or the last two number do not exist), the lattice will not
be relaxed. If ISTRESS=1, PWmat will relax lattice vectors. One can
add external stress tensor by setting STRESS_EXTERNAL or
PTENSOR_EXTERNAL in file atom.config, and external pressure by setting</div>
<div class="line">PSTRESS_EXTERNAL in file IN.RELAXOPT, the latter need to set
IN.RELAXOPT=T in etot.input.</div>
</div>
<p>If you have set STRESS_EXTERNAL or PTENSOR_EXTERNAL, make sure the
settings are consistent with sysmetry operations you have used
(IN.SYMM=T) or generated by MP_N123, if not you should turn off the
symmetry operations. Check MP_N123 for details about symmetry.</p>
<p>If ISTRESS=1 and XCFUNCTIONAL=HSE, one should set RELAX_HSE as follows:</p>
<p>RELAX_HSE = 0 0.0 2</p>
<p>Basic settings for cell relax with xcfunctional=pbe</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JOB</span> <span class="o">=</span> <span class="n">RELAX</span>
<span class="n">XCFUNCTIONAL</span> <span class="o">=</span> <span class="n">PBE</span>
<span class="n">RELAX_DETAIL</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">1000</span> <span class="mf">0.02</span> <span class="mi">1</span> <span class="mf">0.05</span>
<span class="n">ECUT</span> <span class="o">=</span> <span class="mi">70</span> <span class="c1"># maybe 1.4 * Ecut_default</span>
<span class="n">ECUT2</span> <span class="o">=</span> <span class="mi">280</span>
</pre></div>
</div>
</div>
<p>Basic settings for cell relax with xcfunctional=hse</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JOB</span> <span class="o">=</span> <span class="n">RELAX</span>
<span class="n">XCFUNCTIONAL</span> <span class="o">=</span> <span class="n">HSE</span>
<span class="n">RELAX_DETAIL</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">1000</span> <span class="mf">0.03</span> <span class="mi">1</span> <span class="mf">0.05</span>
<span class="n">ECUT</span> <span class="o">=</span> <span class="mi">70</span> <span class="c1"># maybe 1.4 * Ecut_default</span>
<span class="n">ECUT2</span> <span class="o">=</span> <span class="mi">280</span>
<span class="n">RELAX_HSE</span>    <span class="o">=</span>    <span class="mi">0</span>   <span class="mf">0.50000E-01</span>     <span class="mi">2</span>
</pre></div>
</div>
</div>
<p><strong>TOL_STRESS</strong> (in <span class="math notranslate nohighlight">\(eV/Natom\)</span>) is the stress tolerance for the
maximal residual stress. Natom is the total number of atoms. (here it is
defined as <span class="math notranslate nohighlight">\(\partial{Etot}/\partial{STRAIN}/Natom\)</span>, Etot is the
energy of the whole system (not the energy of unit volume)).</p>
<p><strong>TOL_LINECORRECTION</strong> (in <span class="math notranslate nohighlight">\(eV\)</span>) is the energy tolerance for the
line minimization alone one search direction. When we see Etot(step)
becomes a linear line, perhaps we should use a smaller value to have
more correction steps. However, for more accurate relaxations, we can
set a smaller value for this parameter, so the relaxation can continue.
We can turn off the energy tolerance checking for the line minimization
by setting TOL_LINECORRECTION &lt; 0. Some time energy is not that much
accurate, the energy tolerance checking is not reliable. And the default
value is -0.001.</p>
<p>The JOB = RELAX will output a RELAXSTEPS and MOVEMENT files. While
RELAXSTEPS gives a summary of the steps, MOVEMENT records the atomic
positions and lattice vectors for all the steps.</p>
<p>:</p>
<p>In the RELAX calculation, one can add atom specified external force on
each atom. This is done by using IN.EXT_FORCE=T in etot.input. In that
case, A file called IN.EXT_FORCE needs to be provided, it will give the
external force on each atom during the atomic relaxation. Please see the
section IN.EXT_FORCE for more details.</p>
<p>:</p>
<p>Atomic relaxation is one of the most used feature in DFT calculations.
One has to balance the speed with the stability. Here, we have
implemented 6 different methods. For most common problem, we suggest to
use imth=1 (conjugate gradient,CG). For very large system, to accelerate
the convergence, one can test the use of imth=4, which is the VFF
accelerated relaxation. In the best case (e.g., very large systems),
imth=4 can speed up imth=1 by a factor of 10. However, one might want to
test its stability. One can also used imth=4 (the BFGS method), sometime
it is faster than the CG method. Another new method is imth=6, it uses a
molecular dynamics but with a friction term, so the system will
eventually relax to a local minimum. This can be stable, but one needs
to test the parameter FIRE_DT in IN.RELAXOPT. Lastely, if all these
methods are unstable, one can always use imth=3, and use a very small
maximum step by setting RELAX_MAXMOVE in IN.RELAXOPT. This might take a
long time, but it should be stable if sufficient small RELAX_MAXMOVE is
used.</p>
<p>When doing atomic relaxation, one must be mindful of the egghead
problem, which is the artificial forces caused by the real space
lattice. One can remove this problem by setting Ecut2=4Ecut, and
Ecut2L=4Ecut2. Most likely, the second condition Ecut2L=4Ecut2 might not
be necessary, or one can use JOB=EGGFIT and EGG_DETAIL to remove the
egghead effect without using Ecut2L=4Ecut2. Unfortunately, one might
always need to use Ecut2=4Ecut.</p>
<p>To check the relaxation convergence, one should always check the energy
as a function of iteration steps in RELAXSTEPS. Note, that, some steps
might be trial steps, so they are not so important (you might see some
spike). The important one is the “NEW” step energy.</p>
<p>If funcitonal=HSE is used for atomic relaxation, some special algorithms
are used for its acceleration. Please check RELAX_HSE for details.</p>
<p>Finally, if cell lattices are relaxed, great care must be taken. During
the lattice relaxation, the number of plane wave basis (the G-vectors
within the Ecut sphere) is not changed. So, at the end of the
relaxation, the plane wave set (it might no longer be a sphere) might
not correspond to the Ecut sphere. So, if one uses the Ecut to run it
again, a new plane wave set based on the Ecut sphere will be chosen, and
the energy and the stress might be changed. So, either one needs to do
this multiple times, or one needs to use a rather large Ecut, so the
change of basis will have minimum effect. One can use the STRESS_CORR to
mitigate (compensate) this problem in some degree, but cannot really
remove it completely. This will be particularly problematic if the
volume change is very large. In some cases, it might be more reliable to
do the cell relaxation by hand, specially if only one degree of freedom
is used. Note, one can use stress_mask in the atom.config to choose what
lattice components can be changed. One can also used imov in atom.config
to determine which atom, and which x,y,z direction can be moved for
internal atomic relaxation.</p>
<p id="subsection2112"><strong>VFF_DETAIL = FF_IMTH, FF_NSTEP, FF_FORCE_TOL, K_BOND, K_ANGLE,
K_DIHEDRAL, K_SHIFT</strong></p>
<p><strong>Daefault:</strong></p>
<p><strong>VFF_DETAIL = 1, 500, 0.01, 30.0, 5.0, 0.0, 1.5</strong></p>
<p>Note, if you want to use PCG(IMTH=4) method to accelerate the
relaxation, you should know some basic concepts about force field
theory. The PCG method supports any systems such as molecular, metallic,
semiconductor and it has a well optimized energy function to the
metallic systems like Al, Ni, Au, Cu, Ag, Pt, Ir, Pd, Rh, La, Ce, Mg,
Ca, Sr. This method has a high stability for molecular systems,
semiconductors and gives high speedup factors for molecule absorbed on
surface cases.</p>
<p><strong>FF_IMTH</strong>: the optimization algorithm used in force field relaxation.</p>
<p><strong>FF_NSTEP</strong>: the maximum optimized steps in force field relaxation.</p>
<p><strong>FF_FORCE_TOL</strong>: the tolerance of force in force field relaxation.</p>
<p><strong>K_BOND, K_ANGLE, K_DIHEDRAL, K_SHIFT</strong>: the force constant for bond,
angle, dihedral, shift terms.</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        E_{tot} = k_b(b-b_0)^2 + k_a(\theta-\theta_0)^2 + k_d(\phi-\phi_0)^2 + k_s(r-r_0)^2
    \end{aligned}\]</div>
<p>The defaults is <strong>VFF_DETAIL = 1, 500, 0.01, 30.0, 5.0, 0.0, 1.5</strong>.
Note, it is not recommended to modify these parameters unless you are an
expert on force field. If there is a metallic area in your system, that
is, some metallic atoms have only metallic atoms neighbors and only
metallic bond, you have to set additional parameters in the
‘atom.config’ file like this:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">29</span>    <span class="mf">0.22</span>    <span class="mf">0.11</span>    <span class="mf">0.06</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
 <span class="mi">1</span>    <span class="mf">0.44</span>    <span class="mf">0.49</span>    <span class="mf">0.39</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
</pre></div>
</div>
</div>
<p>Here the Copper atom(Z=29) has five integers after coordinates, first
three integers determine whether the atom will move along particular
direction, the forth integer number has some meaning for DOS calculation
and the last integer number (the ninth column) determine whether the
atom is in the metallic area. As we know, the hydrogen atom is not a
metallic atom, we set the last integer as 0, while Copper is metallic,
so we have set it to 1. Note, you can set Copper to 0, so it will be
dealt as a covalent bond element. Usually we only set it to 1 when there
is a large piece of metal.</p>
<p id="section-10"><strong>DOS_DETAIL=IDOS_interp, NQ1,NQ2,NQ3</strong></p>
<p><strong>Default:</strong></p>
<p><strong>DOS_DETAIL = 0, NQ1, NQ2, NQ3</strong></p>
<p>This is a optional input for the use of k-point interpolation scheme for
the JOB=DOS calculation. If IDOS_interp=1 or 2, it will use the
interpolation, : when do interpolatation, K point parallelization is not
allowed. When IDOS_interp=2, NQ1,NQ2, NQ3 must be greater than or equal
to 4. if IDOS_interp=0, it will not use the interpolation. The default
is not to use interpolation. However, if the system is small, and we
like to use multiple k-points, IDOS_interp=1 is a good idea.
Nevertheless, this interpolation method might cost some memory, so for
very large systems and many k-points, it might run out of memory.
NQ1,NQ2,NQ3 must equal to the MP_N123 in the last SCF or NONSCF run
which generated the wave functions OUT.WG (used as IN.WG in the current
DOS run). Note, when IDOS_interp=1 or 2, the wave functions are first
FFT into real space, then the overlap between different k-points are
done. It borrows the method used in HSE calculation. As a result, one
can used P123 to reduce the memory requirement.</p>
<p>When IDOS_interp=1, it will generate OUT.overlap_uk. This file, together
with OUT.EIGEN will be used to calculate DOS using k-space
interpolation. One needs to run: plot_DOS_interp.x (from utility). The
plot_DOS_interp.x needs an input file, “DOS.input”, which consisted with
four lines:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
<span class="mi">1</span>
<span class="mf">0.05</span>
<span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
<p>The <strong>1st</strong> line: if setting 0, it means plotting DOS for all atoms; if
setting 1, for partial atoms. Note, when doing for partial atoms, one
need to add the 8th column in atom.config to set the weights for all the
atoms. As follows, Copper atom(Z=29) DOS will be plotted, and the
hydrogen atom(Z=1) DOS will not be plotted.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">29</span>    <span class="mf">0.22</span>    <span class="mf">0.11</span>    <span class="mf">0.06</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
 <span class="mi">1</span>    <span class="mf">0.44</span>    <span class="mf">0.49</span>    <span class="mf">0.39</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>
</pre></div>
</div>
</div>
<p>The <strong>2nd</strong> line: if setting 1, it means using interpolation for DOS
plotting; if setting 0, it keeps the old method, not doing
interpolation, just using a Gaussian broadening.</p>
<p>The <strong>3rd</strong> line: energy smearing, in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p>The <strong>4th</strong> line: <span class="math notranslate nohighlight">\(NM_1, NM_2, NM_3\)</span>:, the interpolation grid,
with in each grid in :math:<a href="#id363"><span class="problematic" id="id364">`</span></a>NQ_1,</p>
<blockquote>
<div><p>NQ_2,NQ_3`.</p>
</div></blockquote>
<p>With the interpolation scheme, the code will take the overlap of the
Bloch states between different k-point, to generate the band structure
of other k-points. A propriate <span class="math notranslate nohighlight">\(NQ_1,NQ_2,NQ_3\)</span> (e.g., 3,3,3, or
5,5,5) should be used.</p>
<p id="section-11"><strong>SCFEP_DETAIL = Level1, Level2, :math:`alpha`, Numkpt, Numspin</strong></p>
<p>This is a required line for JOB=SCFEP electron-phonon coupling constant
calculation. The calculated electron-phonon coupling constant will be
reported in OUT.EP_COEFF. See JOB=SCFEP (see
<a class="reference external" href="#text:SCFEP">[text:SCFEP]</a>) for details. In the JOB=SCFEP
calculation, one must use IN.WG=T, an input wave function file will be
provided. The electron-phonon coupling constant written in OUT.EP_COEFF
will report:
<span class="math notranslate nohighlight">\(&lt;\psi(i_1,k,s)|\partial H/\partial R|\psi(i_2,k,s)&gt;\)</span>, here
<span class="math notranslate nohighlight">\(\psi(i,k,s)\)</span> is the input wave function from IN.WG for state
index i, kpoint k, and spin s.</p>
<p><strong>Level1, Level2</strong>: The wave function index <span class="math notranslate nohighlight">\(i_1\)</span> and <span class="math notranslate nohighlight">\(i_2\)</span></p>
<p>: a small number (e.g., 0.1) used to add
<span class="math notranslate nohighlight">\(\alpha \psi(i1)*\psi(i2)\)</span> onto the charge density to do SCFEP
calculation. Here, we assume <span class="math notranslate nohighlight">\(\psi(i1)\)</span> and <span class="math notranslate nohighlight">\(\psi(i2)\)</span> are
real. Suggested <span class="math notranslate nohighlight">\(\alpha\)</span> is 0.1. Smaller this number, the
numerical derivative will be more accurate, but it also require higher
level convergence for the SCF calculations.</p>
<p><strong>Numkpt</strong>: The kpoint index k for <span class="math notranslate nohighlight">\(\psi(i,k,s)\)</span>.</p>
<p><strong>Numspin</strong>: The spin index s (1 or 2) for <span class="math notranslate nohighlight">\(\psi(i,k,s)\)</span>.</p>
<div class="section" id="scf-special">
<h3>SCF_SPECIAL<a class="headerlink" href="#scf-special" title="Permalink to this headline">¶</a></h3>
<p><strong>SCF_SPECIAL = iflag, Ef0,i1,i2,j1,j2,k1,k2</strong></p>
<p><strong>Default</strong></p>
<p><strong>SCF_SPECIAL = 0, Ef0,i1,i2,j1,j2,k1,k2</strong></p>
<p>This special option is for nonequilibrium boundary condition calculation
for JOB=SCF. Currently, it does not support JOB=SCF and JOB=MD (it can
run, but the results might not be good). In many problem (for example,
device simulation), there could be fixed electrode potentials, there we
like the potential to satisfy some specific boundary condition. Note,
this might be different from the fixed Fermi Grand canonical
calculaiton, where one electrode potential is fixed. The fixed Fermi is
often used together with solvent model with Poisson-Boltzmann method. In
the current case, it is often for pure solid calculation, and there is
no implicit solvent model. Besides, it is often the case, there are
several electrodes. We like the potential on some boundaries (enclosing
boundary) to be the given values (e.g., representing the on and off of a
CMOS gate, or the source and drain bias potential). Furthermore, this is
truely an nonequilibrium simulation, as these boundary values (of the
electrode voltage) is often related to the local Fermi energy. So, there
is not a single Fermi energy in the simulation. We thus have to use
position dependent Fermi energy. Thus, iflag=1 will represent such
JOB=SCF calculations. It will give the SCF potential file under such
boundary condition. This potential file can be used for quantum
transport calculation.</p>
<p>To do such nonequilibrium calculation, we will do two steps.</p>
<p>In the step one, a normal JOB=SCF calculation (iflag=0, or without the
SCF_SPECIAL line) will be carried out. We will take its global Fermi
energy as Ef0 (eV) input in the above line. Besides, copy OUT.VR into
IN.VR0, which will be used for iflag=1 calculation. Also please copy
OUT.RHO into IN.RHO, OUT.WG into IN.WG for subsequent iflag=1
calculation for fast convergence.</p>
<p>In the second step, set iflag=1. Place Ef0 as mentioned above. Now, we
need to use i1,i2,j1,j2,k1,k2 to specify the boundary condition. These
are the grid points in the n123 grid of the iflag=0 calculation. More
specifically, <span class="math notranslate nohighlight">\(i1,i2 \in [1,n_1]\)</span>, <span class="math notranslate nohighlight">\(j1,j2\in [1,n_2]\)</span>,
<span class="math notranslate nohighlight">\(k1,k2\in [1,n_3]\)</span>. These are the planes where the fixted
potential will be speficied. Note, the boundary condition is not
determined by the edge of the periodic box, instead they are specified
by these plane. These plane will define a smaller box inside the
periodic box, the corner of this smaller box is at [i1,j1,k1], while the
size of this box is: (i2-i1,j2-j1,k2-k1). Note, for this calculation, it
is essential to shift the coordinates, so this small box is in the
middle of the periodic box. Besides, it is also for some dimention to be
periodic. in that case, the corresponding ijk1,ijk2 should both be zero.
For example, to have the periodic condition in the second dimension, we
should have j1=0,j2=0.</p>
<p>Now, for the dimensions which are not periodic boundary condition (their
ijk1,2 are not zero), we need to prepare the corresponding IN.2D_VR.1,
IN.2D_VR.2, IN.2D_VR.3 file. For example, if i1,i2 are not zero, then we
need a IN.2D_VR.1 file. This file specifies the dEf(r) on the two planes
of i1,i2. More specifically, it is written in the following format
(ascii file, so it can be viewed and plotted):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n3</span>
     <span class="n">do</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n2</span>
     <span class="n">write</span><span class="p">(</span><span class="n">IN</span><span class="o">.</span><span class="mi">2</span><span class="n">D_VR</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">dEf1</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">dEf2</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
     <span class="n">enddo</span>
     <span class="n">write</span><span class="p">(</span><span class="n">IN</span><span class="o">.</span><span class="mi">2</span><span class="n">D_VR</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
     <span class="n">enddo</span>
</pre></div>
</div>
</div>
<p>Note, the two columns are for the i1,i2 two planes. There is an empty
line, and the for i,j,k (n1,n2,n3), the earlier index are numerated
first. This special format is used, so it can be plotted in gnuplot
using “splot”.</p>
<p>The units for dEf1,dEf2 are in eV. These IN.2D_VR.1,2,3 files are
prepared by utility programs (e.g., gen_D2V.f), or written by the user.
Note, the dEf1,2 are shift of the Fermi energy (also the potential V(r))
in reference to the Ef0 (V0(r)) at those boundary. Thus, the potential
V(r) at those boundaries equals to V0(r)+dEf(r). After this, one can run
the PWmat again. It will generate the system under the fixed boundary
condition, the OUT.VR can be used to calculate the quantum transport for
device simulation.</p>
<p>Here, we explain the underlying algorithm used to carry out the
calculation. There are two aspects. One is the Poisson solution to
satisfy the fixed boundary condition, another one is the occupation of
the wave functions. For the Poisson solution, for a given charge
<span class="math notranslate nohighlight">\(\rho(r)\)</span>, we first use the conventional FFT method to solve a
periodic Poisson solution, to get <span class="math notranslate nohighlight">\(V_P(r)\)</span>. Note, in order to
satisfy V(r) equals V0(r)+dEf(r) at the boundary, we can define:
<span class="math notranslate nohighlight">\(dV_B(r)=V0(r)+dEf(r)-V_P(r)\)</span> on the boundary (of the inner box,
defined by i1,i2,j1,j2,k1,k2). Then solve a fixed boundary condition
Poisson equation with zero charge, get dV(r) for values inside the box.
This is solved by the Fishpack package. Then <span class="math notranslate nohighlight">\(V(r)=V_P(r)+dV(r)\)</span>.
For dV(r) outside the box, we have used simple extension, from its
boundary value.</p>
<p>For the occupation, we have used a spatial dependent Fermi energy
<span class="math notranslate nohighlight">\(Ef(r)=V(r)-V0(r)+Ef0+dE\)</span>. The occuption is done with with spatial
dependent Fermi energy as:
<span class="math notranslate nohighlight">\(\rho(r)=\sum_i occ((\epsilon_i-Ef(r))/kT) |\psi_i(r)|^2\)</span>, here
<span class="math notranslate nohighlight">\(\epsilon_i\)</span> is the eigen energy, and occ is the Fermi-Dirac
occupation function. Note, we have used a small shift dE to guarantee we
get the exact required total charge. Note, this procedure gaurantee the
local Fermi energy is at the same position of the local density of state
compared with the neutral charge calculation at the step 1. This local
Fermi energy is important. For many device systems, the Fermi energy at
the electrode is higher than the conduction band in the substrate etc.
So, if a global Fermi energy is used, it can be cause large charge
slashing from one side to another, which is not physical. In reality,
under the open boundary condition (for the current), the system can
maintain an steady state nonequilibrium solution, where spatially
dependent Fermi energy exists.</p>
</div>
<div class="section" id="ecut">
<h3>ECUT<a class="headerlink" href="#ecut" title="Permalink to this headline">¶</a></h3>
<p><strong>Default:</strong></p>
<p>ECUT = “WFC_CUTOFF” in pseudopotential file</p>
<p>The plane wave cutoff energy for wavefunction (in <span class="math notranslate nohighlight">\(Ryd\)</span>, note:
<span class="math notranslate nohighlight">\(1 Ryd = 13.6057 eV\)</span>). The default value of ECUT is taken from the
pseudopotential files atom.upf from its WFC_CUTOFF value. Note, in an
plane wave calculation, the plane wave functions with their G-vector
(<span class="math notranslate nohighlight">\(exp(-iG*x)\)</span>) within the energy sphere of ECUT is used as the
basis function. Thus, ECUT control the size of the plane wave basis set,
is one of the most important calculating parameter.</p>
</div>
<div class="section" id="ecut2">
<h3>ECUT2<a class="headerlink" href="#ecut2" title="Permalink to this headline">¶</a></h3>
<p><strong>Default:</strong></p>
<p><strong>ECUT2 = 2*ECUT</strong> (ACCURACY = NORM)</p>
<p><strong>ECUT2 = 4*ECUT</strong> (ACCURACY = HIGH or ACCURACY = VERYHIGH)</p>
<p>The cutoff energy for the soft charge density and the potential (in
<span class="math notranslate nohighlight">\(Ryd\)</span>). In a plane wave calculation, not only the orbital are
expanded by the plane waves, the charge density is also expanded by the
plane waves. However, the plane wave basis set (within energy ECUT2)
used to expand the charge density is larger than the plane wave basis
set (within energy ECUT) used to expand the orbital.</p>
<p>Ideally (for high accurate calculations), ECUT2 should equal 4*ECUT. But
in reality, smaller ECUT2 can sometime be used, e.g., 3*ECUT, or 2*ECUT.
By default, ECUT2 = 2*ECUT for normal accuracy calculation
(ACCURACY=NORM), and ECUT2=4*ECUT for high accuracy calculation
(ACCURACY=HIGH or VERYHIGH). For JOB=RELAX, to avoid the egghead
jittering effect, we recommend to use ECUT2=4*ECUT.</p>
<p>The N1, N2, N3 are determined by ECUT2. Note, the RHO_CUTOFF value in
the pseudopotential files atom.upf . Also note that, if N1, N2, N3 are
not set (by <span class="math notranslate nohighlight">\(N123=\)</span>), they will be generated by ECUT2, together
with NODE1. So, if different number of node NODE1 are used, the N1, N2,
N3 values could be different even for the same ECUT2. This is because
N1*N2 must be evenly divided by NODE1.</p>
</div>
<div class="section" id="ecut2l">
<h3>ECUT2L<a class="headerlink" href="#ecut2l" title="Permalink to this headline">¶</a></h3>
<p><strong>Default:</strong></p>
<p><strong>ECUT2L = ECUT2</strong> (NCPP, ACCURACY = NORM or ACCURACY = HIGH)</p>
<p><strong>ECUT2L = 4*ECUT2</strong> (NCPP, ACCURACY = VERYHIGH)</p>
<p><strong>ECUT2L = 4*ECUT2</strong> (USPP)</p>
<p>The cutoff energy for the hard charge density (in <span class="math notranslate nohighlight">\(Ryd\)</span>).</p>
<p>Sometime it is necessary to further increase the accuracy of the
description for the charge density rho(r) before it is used to calculate
the potential via the exchange-correlation functional. Thus, we have a
so-called hard charge density, which is described by a plane wave basis
set within ECUT2L.</p>
<p>Usually, ECUT2L = ECUT2 for norm conserving pseudopotentials, and ECUT2L
= 4 * ECUT2 for ultra-soft pseudopotentials. However, sometime to
completely remove the egghead problem, we can also use ECUT2L = 4 *
ECUT2 even for the norm conserving psp. Nevertheless, that egghead
problem can usually be solved by using EGG_FIT, so we can still use
ECUT2L = ECUT2 for norm conserving pseudopotential (but usually require
ECUT2 = 4 * ECUT).</p>
</div>
<div class="section" id="ecutp">
<h3>ECUTP<a class="headerlink" href="#ecutp" title="Permalink to this headline">¶</a></h3>
<p><strong>Default:</strong></p>
<p><strong>ECUTP = ECUT</strong> (ACCURACY = NORM)</p>
<p><strong>ECUTP = 4*ECUT</strong> (ACCURACY = HIGH or ACCURACY = VERYHIGH)</p>
<p>The cutoff energy to generate P123 for Fock exchange integral evaluation
for HSE calculations (in <span class="math notranslate nohighlight">\(Ryd\)</span>). If P123 is exlicitly input, the
P123 will have higher priority.</p>
<p>Note, in order to have accurate results, one needs to have ECUTP =
4*ECUT. This is necessary for accurate force calculations, e.g., during
atomic relaxation or phonon mode calculations. Otherwise, the total
force might not be zero.</p>
<p>However, if only electronic structure is needed, or for molecular
dynamics, or evern TDDFT simulations, one might be able to set a smaller
ECUTP, for example, ECUTP=ECUT</p>
</div>
<div class="section" id="n123">
<h3>N123<a class="headerlink" href="#n123" title="Permalink to this headline">¶</a></h3>
<p>The format is like this:</p>
<p><strong>N123 = N1, N2, N3</strong></p>
<p><strong>N1, N2, N3</strong> are the real space grid to describe the wave function or
soft charge density in real space. It is also the FFT grid. The default
values are determined by ECUT2 (i.e., make sure the ECUT2 sphere can be
held inside the <span class="math notranslate nohighlight">\(N1, N2, N3\)</span> reciprocal box). Roughly speaking,
<span class="math notranslate nohighlight">\(N_i=2\sqrt{2*ECUT2}/(\pi*|ALI(:,i)|)\)</span>, here <span class="math notranslate nohighlight">\(ALI(:,i)\)</span> is
the reciprocal lattice of the input cell lattice <span class="math notranslate nohighlight">\(AL(:,i)\)</span> in
atom.config file, in <span class="math notranslate nohighlight">\(Bohr\)</span> unit, and <span class="math notranslate nohighlight">\(|ALI(:,i)|\)</span> is the
length of the vector. Also, in this formula, <span class="math notranslate nohighlight">\(ECUT2\)</span> is in the
unit of Hartree.</p>
<p>Note, in our current implementation, <span class="math notranslate nohighlight">\(N_1*N_2\)</span> need to be divided
evenly by node1. So, sometime it might be necessarily to readjust
<span class="math notranslate nohighlight">\(N1, N2, N3\)</span> manually (or to change node1). If <span class="math notranslate nohighlight">\(N123\)</span> is not
explicitly set, their values will be determined automatically by ECUT2
and NODE1. Note, for the same ECUT2, for different NODE1, it can lead to
different <span class="math notranslate nohighlight">\(N123\)</span>.</p>
</div>
<div class="section" id="ns123">
<h3>NS123<a class="headerlink" href="#ns123" title="Permalink to this headline">¶</a></h3>
<p>The format is :</p>
<p><strong>NS123 = N1S, N2S, N3S</strong></p>
<p><strong>N1S, N2S, N3S</strong> are the real space FFT grid point to calculate the
real space nonlocal pseudopotential projector function. So, these are
only used for NONLOCAL = 2. For small systems, N1S,N2S,N3S can be larger
than N1,N2,N3. For large systems, smaller values can be used to save
time for projector generation. Usually these parameters are set
automatically.</p>
</div>
<div class="section" id="n123l">
<h3>N123L<a class="headerlink" href="#n123l" title="Permalink to this headline">¶</a></h3>
<p>The format is:</p>
<p><strong>N123L = N1L, N2L, N3L</strong></p>
<p><strong>N1L, N2L, N3L</strong> are the real space grid for hard charge density. The
default values are determined by ECUT2L. For norm conserving
pseudopotential, the soft charge equals hard charge, ECUT2L=ECUT2, so
N1L, N2L, N3L equal N1, N2, N3. For ultra-soft, ECUT2L = 4 * ECUT2,
N1L, N2L, N3L = 2 * N1, 2 * N2, 2 * N3.</p>
</div>
<div class="section" id="p123">
<h3>P123<a class="headerlink" href="#p123" title="Permalink to this headline">¶</a></h3>
<p><strong>P123 = NP1, NP2, NP3</strong></p>
<p>Related lines: XCFUNCTIONAL = HSE ; ECUTP = XXX.</p>
<p><strong>Default:</strong></p>
<p>Using ECUTP=ECUT to determine NP1, NP2, NP3.</p>
<p>When using HSE method, a small box FFT (with grid NP1,NP2,NP3) can be
used to calculate the explicit FOCK exchange integral if only electronic
structure is needed. This can significantly speedup the calculation
without much loss of accuracy (for electronic structure, molecular
dynamics, or TDDFT). Sometime NP1, NP2, NP3 can be as small as half of
N1, N2, N3. NP1,2,3 are generated using ECUTP. However, in order to have
higher accuracy force and energy, one should used ECUTP=4*ECUT, or
usually at least ECUTP=ECUT2 (e.g., for atomic relaxation or phonon mode
calculations).</p>
</div>
<div class="section" id="mp-n123">
<span id="subsection-mpn123"></span><h3>MP_N123<a class="headerlink" href="#mp-n123" title="Permalink to this headline">¶</a></h3>
<p><strong>MP_N123=NK1, NK2, NK3, SK1, SK2, SK3, FLAG_SYMM</strong></p>
<p><strong>Default:</strong></p>
<p><strong>MP_N123 = 1 1 1 0 0 0</strong></p>
<p>This variable is the Monkhorst-Pack grids to generate the reduced
k-points. When this line is provided, the PWmat will generate the
OUT.SYMM and OUT.KPT using the above Monkhorst-Pack parameters, and the
PWmat will continue to run the JOB using these k-points and symmetries.</p>
<p><strong>(WARNING)</strong>: if one wants to generate only gamma point, but does not
want to use symmetry, one needs to set: “MP_N123 = 1 1 1 0 0 0 2”.</p>
<p>Note: if file “IN.KPT” exists and IN.KPT=T, but at the same time,
MP_N123 is also specified, PWmat will ignore “MP_N123” and use kpoints
readin from file “IN.KPT”(i.e, IN.KPT=T has higher priority than
MP_N123). If you want to use the input kpoints and symmetry, you should
set IN.KPT=T, IN.SYMM=T, then PWmat will read the files “IN.KPT”,
“IN.SYMM” for the calculation.</p>
<p>The SK1, SK2 and SK3 must be either 0 (no offset) or 1 (grid displaced
by half a grid point in the corresponding direction). This is the
standard options to generate the Monkhorst-Pack k-point grid.</p>
<p>The FLAG_SYMM controls the symmetry operation(the operations are stored
in OUT.SYMM) of k-points. One can refer to the OUT.SYMM for the specific
symmetry operations.</p>
<p>FLAG_SYMM=0, generate kpoints with spatial symmetry and time reversal
symmetry. This flag will have the full symmetry operations.</p>
<p>FLAG_SYMM=1, generate kpoints with spatial symmetry but no time reversal
symmetry. This may generate lower symmetry than flag=0. This for
example, can be used for magnetic system calculation and for systems
with an external magnetic field.</p>
<p>FLAG_SYMM=2, generate kpoints without any symmetry, i.e. the symmetry is
identity operation. This for example can be used for rt-TDDFT simulation
with external potential.</p>
<p>FLAG_SYMM=3, generate kpoints with time reversal symmetry but no spatial
symmetry. This may generate lower symmetry than flag=0. This for
example, can be used for rt-TDDFT without magnetic moment.</p>
<p>In above, the symmetry includes both point group symmetry operations and
space group symmetry operations. Also, for best point group symmetry,
one should always place the high symmetry point at the origin (0,0,0)
position, since that is the symmetry operation point.</p>
<p>There are several issues one needs to know. If IN.VEXT is used, it is
the user’s responsibility to figure out what symmetry one should use,
since when the above symmetry operation are generated, it does not
consider IN.VEXT. For system with MAGNETIC moment section in atom.config
and SPIN=2, the MAGNETIC moment of each atom is also used to figure out
the symmetry (e.g., one atom with magnetic moment 2 will be different
from another atom with same atomic number, but magnetic moment equals
-2).</p>
<p>Notes about IN.KPT, IN.SYMM and MP_N123:</p>
<ol class="arabic simple">
<li><p>Default: IN.KPT=F, IN.SYMM=F, MP_N123= 1 1 1 0 0 0; IN.KPT=T has
higher priority then MP_N123;</p></li>
<li><p>IN.KPT=T: read kpoints from file IN.KPT; write OUT.KPT;</p></li>
<li><p>IN.KPT=F: use MP_N123 to generate kpoints; write OUT.KPT;</p></li>
<li><p>IN.SYMM=T and IN.KPT=T: read symmetry operations from file IN.SYMM;
write OUT.SYMM;</p></li>
<li><p>IN.SYMM=T and IN.KPT=F: read symmetry operations from file IN.SYMM,
then MP_N123 will use these symmetry operations to generate kpoints;
write OUT.SYMM;</p></li>
<li><p>IN.SYMM=F and IN.KPT=T: no symmetry used; write ’identity’ operation
to file OUT.SYMM;</p></li>
<li><p>IN.SYMM=F and IN.KPT=F: use MP_N123 to generate kpoints and symmetry
operations; write OUT.KPT and OUT.SYMM;</p></li>
<li><p>for JOB=MD,NEB,TDDFT,NAMD or SPIN=222: default FLAG_SYMM = 2.</p></li>
</ol>
</div>
<div class="section" id="nq123">
<h3>NQ123<a class="headerlink" href="#nq123" title="Permalink to this headline">¶</a></h3>
<p><strong>NQ123 = NQ1, NQ2, NQ3</strong></p>
<p>Related lines: XCFUNTIONAL = HSE; JOB=NONSCF.</p>
<p>The NQ1, NQ2, NQ3 are for a NONSCF HSE calculation, and they should be
the NK1, NK2, NK3 values from the previous step SCF HSE run in the
previous step “MP_N123=NK1, NK2, NK3, SK1, SK2, SK3” statement. This is
required for NONSCF HSE calculation. In such a calculation, one previous
SCF HSE calculation has been carried out, and the OUT.HSEWR1, OUT.HSEWR2
have been generated. In the previous step SCF HSE calculation, the
“MP_N123=NK1, NK2, NK3, SK1, SK2, SK3” has been used. In a continued
NONSCF calculation (e.g., to generate the DOS, or band structure), the
“MP_N123” can be changed (so we need to introduce the NQ1,NQ2,NQ3), or a
band structure k-point set has been input through IN.KPT. But the
original MP_N123 must be input to the program, so it knows what are the
k-points in the kernel functions of OUT.HSEWR1, OUT.HSEWR2, …,
OUT.HSEWR(i) in the FOCK exchange integral. This NQ1,NQ2,NQ3 is also
used to generate the G=0 compensation term for the Fock exchange
integral, following the F. Gygi paper. This NQ123 should not be used for
SCF HSE calculation.</p>
</div>
<div class="section" id="spin">
<h3>SPIN<a class="headerlink" href="#spin" title="Permalink to this headline">¶</a></h3>
<p>SPIN = 1 / 2 / 22 / 222</p>
<p><strong>Default:</strong></p>
<p><strong>SPIN=1</strong></p>
<p><strong>SPIN = 1</strong>, non-spin-polarized calculation (default). Each orbital
will be occupied by 2 electron.</p>
<p><strong>SPIN = 2</strong>, spin-polarized calculation, LSDA (magnetization along z
axis). For systems except ferromagnetic system, please specify the
initial magnetic moment in “atom.config” with the keyword section:
“MAGNETIC”. Note, for SPIN=2, IN/OUT charge density will have: IN.RHO,
IN.RHO_2, and OUT.RHO, OUT.RHO_2 (spin up and down components).
Similarly, IN/OUT potential will also have spin up and down components:
IN.VR, IN.VR_2, OUT.VR, OUT.VR_2.</p>
<p><strong>SPIN = 22</strong>, spin-orbit coupling (SOC) calculation, but without
magnetic moment. This is suitable for semiconductors like CdSe. In this
case, each orbital will have spin-up and spin-down components (spinor).
But there are also spin-up orbital and spin-down orbital (each of them
has spin-up and spin-down components), and both are occupied. As a
result there is no magnetic moment. Since there is no magnetic moment,
the charge density and potential will only have one component, or say
the spin up and down components are the same. So, there will be
IN.RHO,OUT.RHO,IN.VR,OUT.VR, but there will be no IN/OUT.RHO_2,
IN/OUT.VR_2 counterparts.</p>
<p><strong>SPIN = 222</strong>, spin-orbit coupling calculation, with noncollinear
magnetization in generic directions. For SPIN=222, please specify the
initial magnetic moment in “atom.config” with the keywords
“MAGNETIC_XYZ”. In this case, the IN/OUT.RHO will also have
IN/OUT.RHO_SOM (a complex 2x2 spin matrix density). IN/OUT.VR will also
have IN/OUT.VR_SOM (a complex 2x2 spin matrix potential) and
IN/OUT.VR_DELTA (a real up-down diagonal potential, note, there is no
IN/OUT.RHO_DELTA).</p>
<p>For SPIN=22 and SPIN=222, the SOC pseudopotentials need to be used.
Check the pseudopotential sets, choose the proper SOC pseudopotentials.
Note, in our calculation, all the SOC comes from the core levels, so
only the heavy atoms have the SOC pseudopotentials. We do not calculate
the valence band SOC. For light elements like C, N, O, there is no SOC
pseudopotential. However, the SOC pseudopotential and non-SOC
pseudopotential can be used in mix within a single calculation. : for
SPIN=22 or SPIN=222 ,you must set parameter “ECUT” in etot.input file,
and do not use the default value in pseudopotential file.</p>
<p>SOC can also used together with HSE calculations. This is important for
topological system calculations.</p>
</div>
<div class="section" id="num-electron">
<h3>NUM_ELECTRON<a class="headerlink" href="#num-electron" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_ELECTRON=value</strong></p>
<p>The total number of occupied valence electron in the system. One can use
this to make the system charged, or not charged. Note, for charged
system calculations, a uniformed back ground charge is used to solve the
Possion equation for COULOMB=0. Default value is the value for neutral
system.</p>
</div>
<div class="section" id="num-band">
<h3>NUM_BAND<a class="headerlink" href="#num-band" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_BAND=value</strong></p>
<p><strong>Default:</strong></p>
<p><strong>NUM_BAND = min[1.05*NUM_ELECTRON/2+10]</strong> (SPIN = 1)</p>
<p><strong>NUM_BAND = min[1.2*min[1.05*NUM_ELECTRON/2+10]]</strong> (SPIN = 2)</p>
<p>The number of orbitals to be calculated. When SPIN=2, there are NUM_BAND
spin-up orbitals and NUM_BAND spin-down orbitals.</p>
</div>
<div class="section" id="accuracy">
<h3>ACCURACY<a class="headerlink" href="#accuracy" title="Permalink to this headline">¶</a></h3>
<p><strong>ACCURACY = NORM / HIGH / VERYHIGH</strong>.</p>
<p><strong>Default:</strong></p>
<p><strong>ACCURACY = NORM</strong></p>
<p>We have introduced three control flags: Accuracy, precision and
convergence for the user to easily control different aspects of the
calculation. The values of these flags will determine the setting of
other more detail parameters. However, one can also set those parameters
directly. Those detailed parameters should have higher priority (if they
are explicitly set) than these three control flags.</p>
<p>Control the calculation accuracy, helping to set up the default values
for other parameters in etot.input. This parameter will influence the
setting of default ECUT/ECUT2 and P123 (for HSE) (see the following).</p>
<p><strong>ACCURACY = NORM</strong>, the default ECUT will be used, and ECUT2 = 2 *
ECUT, ECUT2L = ECUT2 for NCPP, and ECUT2L = 4 * ECUT2 for ultrasoft
PSP. P123 = NP1, NP2, NP3, which equals 2/3 of N1, N2, N3 (or generated
from ECUT, using a FFT box just containing the ECUT sphere). Please
check Section <a class="reference external" href="#section:DefaultInputSetting">2.2</a> for detail.</p>
<p><strong>ACCURACY = HIGH</strong>, if ECUT/ECUT2 are not specified, it will set ECUT =
1.0 * default value in the pseudopotential file and ECUT2 = 4 * ECUT,
ECUT2L = ECUT2, and P123 = N123. Please check Section
<a class="reference external" href="#section:DefaultInputSetting">2.2</a> for detail.</p>
<p><strong>ACCURACY = VERYHIGH</strong>, if ECUT/ECUT2 are not specified, it will set
ECUT = 1.0 * default value in the pseudopotential file and ECUT2 = 4 *
ECUT, ECUT2L = 4 * ECUT2, and P123 = N123. Please check Section
<a class="reference external" href="#section:DefaultInputSetting">2.2</a> for detail.</p>
</div>
<div class="section" id="precision">
<h3>PRECISION<a class="headerlink" href="#precision" title="Permalink to this headline">¶</a></h3>
<p><strong>PRECISION = AUTO / SINGLE / DOUBLE / MIX</strong>.</p>
<p><strong>Default:</strong></p>
<p><strong>PRECISION = AUTO</strong></p>
<p>The precision controlling flag of GPU calculation.</p>
<p><strong>PRECISIION = AUTO</strong>, double or single precision in the calculation
will be automatically adjusted, according to other parameters, please
refer to section <a class="reference external" href="#section:DefaultInputSetting">2.2</a> for more
details. This is the default setting.</p>
<p><strong>PRECISION = SINGLE</strong>, use single precision of GPU calculation, default
(except for HSE). For most cases, SINGLE is good enough. Typically, it
can converge the total energy to 0.1 meV, and the error for rho to be
about 1.E-5, and error for total energy to be about 1.E-4 (eV). Please
refer to section <a class="reference external" href="#section:DefaultInputSetting">2.2</a> for more
details.</p>
<p><strong>PRECISION = DOUBLE</strong>, use double precision of GPU calculation. Default
for the PBE part of HSE calculation. This however can be slower on the
Mstation. Use this only you really want to make sure the numerical
precision is not a problem. Please refer to section
<a class="reference external" href="#section:DefaultInputSetting">2.2</a> for more details.</p>
<p><strong>PRECISION = MIX</strong>, use both double and single precisions in the
calculation, automatically adjust. Only some critical parts use DOUBLE,
the other parts use SINGLE. It is a compromise between SINGLE and DOUBLE
precisions. Usually this should be good enough for almost any
calculations. Please refer to section
<a class="reference external" href="#section:DefaultInputSetting">2.2</a> for more details.</p>
<p>Obviously, from <strong>SINGLE</strong>, <strong>MIX</strong> to <strong>DOUBLE</strong>, more accurate, but
more costly. In most calculations, SINGLE is good enough, and MIX can be
almost as good as the DOUBLE precision. If there are some issues in
terms of convergence and the final result, one can use DOUBLE precision
to check. Note, for HSE, the HSE Fock exchange term is calculated with
SINGLE, but the PBE iterations are done using DOUBLE. Please refer to
section <a class="reference external" href="#section:DefaultInputSetting">2.2</a> for more details.</p>
</div>
<div class="section" id="convergence">
<h3>CONVERGENCE<a class="headerlink" href="#convergence" title="Permalink to this headline">¶</a></h3>
<p><strong>CONVERGENCE = EASY / DIFFICULT</strong></p>
<p><strong>Default:</strong></p>
<p><strong>CONVERGENCE = EASY</strong></p>
<p>Related input lines: RHO_RELATIVE_ERROR; WG_ERROR; RHO_ERROR; SCF_ITER0;
SCF_ITER1; ACCURACY.</p>
<p>Control the convergence parameters of the SCF self-consistent iteration.</p>
<p><strong>CONVERGENCE = EASY</strong>, use less self-consistent iteration steps to do
the calculation in default setting. For the normal calculation, we
recommend to use this setting. In some cases, it is hard to make the
self-consistent iteration converge, you can try the “DIFFICULT” value.
Please check Section <a class="reference external" href="#section:DefaultInputSetting">2.2</a> for detail.</p>
<p><strong>CONVERGENCE = DIFFICULT</strong>. Please check Section
<a class="reference external" href="#section:DefaultInputSetting">2.2</a> for detail.</p>
</div>
<div class="section" id="charge-decomp">
<h3>CHARGE_DECOMP<a class="headerlink" href="#charge-decomp" title="Permalink to this headline">¶</a></h3>
<p><strong>CHARGE_DECOMP = T / F</strong></p>
<p><strong>Default:</strong></p>
<p><strong>CHARGE_DECOMP = F</strong></p>
<p>This will create an atomic charge on each atom using the Hirshfield
algorithm, and reported the result in output file OUT.QDIV for JOB = SCF
calculation. For spin = 2, it will report total charge, and
magnetic_moment = charge_up - charge_down. If the job is to do molecular
dynamics (JOB = MD), then the atomic charge will also be reported in
MOVEMENT. This option is useful for charge analysis. For the Hirshfield
algorithm, the charge on one atom i is defined as:
<span class="math notranslate nohighlight">\(Q_i=\int \rho(r) {\rho_{atomtype(i)}(r-R_i) \over \sum_j \rho_{atomtype(j)}(r-R_j)} d^3r\)</span>,
here <span class="math notranslate nohighlight">\(\rho_{atomtype(i)}(r)\)</span> is the neutral charge density of the
atom type atomtype(i) described in the atom pseudopotential file
xxx.upf. Note, this option only works for norm conserving
pseudopotential.</p>
</div>
<div class="section" id="energy-decomp">
<h3>ENERGY_DECOMP<a class="headerlink" href="#energy-decomp" title="Permalink to this headline">¶</a></h3>
<p><strong>ENERGY_DECOMP = T / F</strong></p>
<p><strong>ENERGY_DECOMP = T / F, type</strong></p>
<p><strong>Default:</strong></p>
<p><strong>ENERGY_DECOMP = F</strong></p>
<p><strong>type = 1</strong></p>
<p>This will decompose the total DFT (LDA, PBE only, but it also works for
IN.SOLVENT=T, as well as Poisson-Boltzmann equation) energies into the
energies belong to each atom (atomic energies). The sum of the atomic
energies will be equal to the total DFT energy (but differ by a
constant, this constant is independent of the position of the atom, as
well as the lattice length. Basically, each atom will miss an atom type
specific energy constant, an onsite energy term). It rewrites the total
energy as an spatial integral of the positive energy density term, and
use the Hirshfield algorithm to decompose such energy density into each
atom, much like the above decomposition for the charge density. See
Ref.[J. Kang, L.W. Wang, Phys. Rev. B 96, 020302(R)(2017)] for details.
For JOB = SCF, the decomposed energy will be reported in OUT.ENDIV. For
JOB = MD, the decomposed energy will also be reported in MOVEMENT. These
decomposed energies can be used to do force field fitting.</p>
<p><strong>type=1,2,11,22 (default 1)</strong>.</p>
<p><strong>type=1,11</strong>: the electrostatic energy density is expressed as:
<span class="math notranslate nohighlight">\(1/8\pi |E(r)|^2\)</span> (here E is the electric field). This is positive
everywhere, but it can have large amplitude even in vacuum region.</p>
<p><strong>type=2,22</strong>: the electratatic energy density is expressed as:
<span class="math notranslate nohighlight">\(1/2 \rho(r) V(r)\)</span>, here <span class="math notranslate nohighlight">\(\rho(r)\)</span> is the charge density
including both electron and nuclear charge, V(r) is the total
electrostatic potential. So, this only has values where <span class="math notranslate nohighlight">\(\rho(r)\)</span>
is not zero. Note, for all types, for IN.SOLVENT=T, the solvent
polarization induced electrostatic energy density is always represented
as <span class="math notranslate nohighlight">\(\rho_{solute}(r)V_{polarization}(r)\)</span>.</p>
<p><strong>type=1,2</strong>: a straight forward Hirshfeld spatial partitioning is used
to partition the energy density, to yield the energy for each atom.
However, for the Hirsheld partitioning, the atomic charge (amplitude and
shape) can be altered by the parameter in ENERGY_DECOMP_SPECIAL and
ENERGY_DECOMP_SPECIAL2.</p>
<p><strong>type=11,22</strong>: an atomic weight watom(iatom) is used, and dynamically
adjusted, so when doing charge decomposition, it will yield the atomic
charge equal to the neutral atom charge z(atom_type). This watom(iatom)
is then used to do the energy decomposition. The hope is that, by
getting the fixed charge density, the energy part (especially when using
type=22) will have minimum variations. All these are designed to get the
minimum fluctuation of the atomic energy. Note, there are additional
costs by doing type=11,22, in order to find watom(iatom) for each atomic
configuration. The watom(iatom) are listed in the last column in
OUT.ENDIV, or the corresponding section in MOVEMENT.</p>
<p><strong>Special note</strong>: If ENERGY_DECOMP_COULOMB=T, then type=1/2 are the
same, and type=11/22 are the same. The detailed option will be
determined by imth in the ENERGY_DECOMP_COULOMB line. Please check that
section.</p>
<p><strong>WARNING: ernergy decomposition does not support NUM_BLOCKED_PSI = T
.</strong></p>
</div>
<div class="section" id="energy-decomp-special">
<h3>ENERGY_DECOMP_SPECIAL<a class="headerlink" href="#energy-decomp-special" title="Permalink to this headline">¶</a></h3>
<p><strong>ENERGY_DECOMP_SPECIAL = w(1), w(2), …., w(ntype)</strong></p>
<p><strong>Default:</strong></p>
<p><strong>ENERGY_DECOMP_SPECIAL = 1, 1, …, 1</strong></p>
<p>This is an additional option for ENERGY_DECOMP=T as well as
CHARGE_DECOMP=T. This option modifies the weight for each atom type, not
just using <span class="math notranslate nohighlight">\(\rho_{atomtype(i)}(r)\)</span>, but using
<span class="math notranslate nohighlight">\(w(atomtype(i))*\rho_{atomtype(i)}(r)\)</span> as the weight in the
Hirshfeld method to calculate the charge and energy. The default values
for all w(i) are 1.</p>
</div>
<div class="section" id="energy-decomp-special1">
<h3>ENERGY_DECOMP_SPECIAL1<a class="headerlink" href="#energy-decomp-special1" title="Permalink to this headline">¶</a></h3>
<p><strong>ENERGY_DECOMP_SPECIAL1 = eta(1), eta(2), …., eta(ntype)</strong></p>
<p><strong>Default:</strong></p>
<p><strong>ENERGY_DECOMP_SPECIAL1 = 1, 1, …, 1</strong></p>
<p>This is a very special input, please don’t use it if you don’t know the
technical detail. In order to do the energy decomposition, for each
input atom.UPF pseudopotential file, it will generate the corresponding:
atom.UPF.ionrhoR, atom.UPF.rhoq, atom.UPF.rhoatom, files. They are the
real space <span class="math notranslate nohighlight">\(v\_{loc}(r)\)</span> file before and after fitting; q-space
<span class="math notranslate nohighlight">\(v_{loc}(q)\)</span> file before and after fitting, and <span class="math notranslate nohighlight">\(\rho(r)\)</span>
used for spatial partitioning function to generate the atomic
quantities. It is worth to plot <span class="math notranslate nohighlight">\(v_{loc}(r)\)</span>, especially
<span class="math notranslate nohighlight">\(v_{loc}(q)\)</span>. In <span class="math notranslate nohighlight">\(v_{loc}(q)\)</span>, for <span class="math notranslate nohighlight">\(0 &lt; q &lt; q_{c}/2\)</span>,
it is the original <span class="math notranslate nohighlight">\(v_{loc}(q)\)</span>, while for
<span class="math notranslate nohighlight">\(q_{c}/2 &lt; q &lt; q_{c}\)</span> is the fitted one. Make sure the fitted one
is close to the original one, there is no big variation. If there are
large change, one can modify eta(itype). The default eta value is 1.
Larger eta can make the <span class="math notranslate nohighlight">\(v_{loc}(q)\)</span> smoother, but could be less
accurate in some sense. One can set eta to 1.5 for example if
<span class="math notranslate nohighlight">\(v_{loc}(q)\)</span> for <span class="math notranslate nohighlight">\(q_{c}/2 &lt; q &lt; q_{c}\)</span> is large.</p>
<p>This is an additional option for ENERGY_DECOMP=T as well as
CHARGE_DECOMP=T. This option modifies the weight for each atom type, not
just using <span class="math notranslate nohighlight">\(\rho_{atomtype(i)}(r)\)</span>, but using
<span class="math notranslate nohighlight">\(w(atomtype(i))*\rho_{atomtype(i)}(r)\)</span> as the weight in the
Hirshfeld method to calculate the charge and energy. The default values
for all w(i) are 1.</p>
</div>
<div class="section" id="energy-decomp-special2">
<h3>ENERGY_DECOMP_SPECIAL2<a class="headerlink" href="#energy-decomp-special2" title="Permalink to this headline">¶</a></h3>
<p><strong>ENERGY_DECOMP_SPECIAL2 = exp_decomp</strong></p>
<p><strong>Default:</strong></p>
<p><strong>ENERGY_DECOMP_SPECIAL2 = 1</strong></p>
<p>This is used to control the atomic charge density
<span class="math notranslate nohighlight">\(\rho_{atom}(|r-R|)\)</span> to be used in the Hirshfeld formula. The
together with the weight input in ENERGY_DECOMP_SPECIAL, the Hirshfeld
partition function for atom R at position r, is given as:
<span class="math notranslate nohighlight">\(\rho_{atom}^{exp\_decomp}(|r-R|) w(atomype(R))/\sum_{R'} \rho_{atom}^{exp\_decomp}(|r-R'|)w(atomtype(R'))\)</span>
(Note, there could be an additional weight watom(iatom) for type=11,22
partitioning method). So, higher value of exp_decomp (e.g., 2) can make
the partitioning more local, and the interface more abrupt, but it can
also be less smooth.</p>
<p>Note, the parameters in ENERGY_DECOMP_SPECIAL, and
ENERGY_DECOMP_SPECIAL2 can also be used to control the CHARGE_DECOMP.</p>
</div>
<div class="section" id="energy-decomp-coulomb">
<h3>ENERGY_DECOMP_COULOMB<a class="headerlink" href="#energy-decomp-coulomb" title="Permalink to this headline">¶</a></h3>
<p><strong>ENERGY_DECOMP_COULOMB = T / F, iconstr,imth,fac1,fac2,numG,q2W,iout</strong></p>
<p><strong>Default:</strong></p>
<p><strong>ENERGY_DECOMP_COULOMB = F</strong></p>
<p>This is an option for Coulomb potential charge fitting. It can either do
it on the flight (imth=1,2), or use an already fitted spherical atomic
charge model (funcq_atom.fit), and recalculate the electrostatic Coulomb
interaction energy. This will affect the electrostatic interaction
involving both the electron charge and nuclear charge. The idea is to
fit the electron charge density, and calculate the
<span class="math notranslate nohighlight">\(rho_{fit}*rho_{fit}\)</span> interactions analytically (using atom-center
pair interaction), and we will have a residuation charge:
<span class="math notranslate nohighlight">\(rho_{res}=rho-rho_{fit}\)</span>, and hopefully this residue is small,
and it will not have long range interaction. In terms of fit, we can do
on the flight, as in imth=1,2 (this is done for using 1 or 2 Gaussians
for each atom, and either we have fitting, or we have no fitting, just
use the previously fitter results), or we can have an more extensive
fitting, using the vion_coulomb_fit.f90 utility file, to generate the
funcq_atom.fit files to be read by the program.</p>
<p>Note, ENERGY_DECOMP_COULOMB = T does not work with Solvent model.</p>
<p><strong>imth=1,2</strong>: fitting the charge with Gaussian on the flight. The idea
is to use one or two (numG) Gaussians to represent a charge density at a
given atom. <strong>iconstr=1</strong>: (this is only used under imth=1,2), one must
provide a IN.CONSTRAINT_COULOMB to give information for constrains
during the density fitting. This can be used to specified, the sum of
the charge of a few atoms (or one atom) must be a given number. The
fitted charge will output in: OUT.natom_coulomb_fit.</p>
<p>When ENERGY_DECOMP_COULOMB = T, one “ENERGY_NATOM_COULOMB” section must
be provided in atom.config file. This section has the following format
(note for imth=3, this section is not really used, but nevertheless,
please provide an place holder faked section ):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">........</span> <span class="n">INSIDE</span> <span class="n">THE</span> <span class="n">ATOM</span><span class="o">.</span><span class="n">CONFIG</span> <span class="n">FILE</span> <span class="o">............</span>
<span class="n">ENERGY_NATOM_COULOMB</span>
 <span class="mi">4</span>                       <span class="c1"># natom_fit</span>
 <span class="mi">151</span>  <span class="mi">15</span>  <span class="mf">0.20</span> <span class="mf">0.5</span>       <span class="c1"># atom order in xatom; zatom, a1, a2 (A)</span>
 <span class="mi">152</span>   <span class="mi">9</span>  <span class="mf">0.15</span> <span class="mf">0.4</span>       <span class="c1"># atom order in xatom; zatom, a1, a2 (A)</span>
 <span class="mi">153</span>   <span class="mi">9</span>  <span class="mf">0.15</span> <span class="mf">0.4</span>
 <span class="mi">154</span>   <span class="mi">9</span>  <span class="mf">0.15</span> <span class="mf">0.4</span>
 <span class="o">------------------------</span>
 <span class="mi">150</span>                                 <span class="c1"># natom_fix</span>
 <span class="mi">1</span>   <span class="mi">8</span>  <span class="mf">0.3</span> <span class="mf">0.5</span> <span class="o">-</span><span class="mf">10.674</span><span class="p">,</span> <span class="mf">11.914</span>      <span class="c1"># atom_order,zatom,a1,a2(A),Q1,Q2</span>
 <span class="mi">2</span>   <span class="mi">8</span>  <span class="mf">0.3</span> <span class="mf">0.5</span> <span class="o">-</span><span class="mf">10.674</span><span class="p">,</span> <span class="mf">11.914</span>      <span class="c1"># atom_order,zatom,a1,a2(A),Q1,Q2</span>
 <span class="mi">3</span>   <span class="mi">8</span>  <span class="mf">0.3</span> <span class="mf">0.5</span> <span class="o">-</span><span class="mf">10.674</span><span class="p">,</span> <span class="mf">11.914</span>      <span class="c1"># atom_order,zatom,a1,a2(A),Q1,Q2</span>
 <span class="mi">4</span>   <span class="mi">8</span>  <span class="mf">0.3</span> <span class="mf">0.5</span> <span class="o">-</span><span class="mf">10.674</span><span class="p">,</span> <span class="mf">11.914</span>      <span class="c1"># atom_order,zatom,a1,a2(A),Q1,Q2</span>
 <span class="o">.....</span> <span class="p">(</span><span class="mi">150</span> <span class="n">lines</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note, the a1,a2 are the size of the two Gaussian (even if numG=1, only
one Gaussian is used, please provide two columns, for the place holder,
the format is fixed). The atom_order is the index of the atom in the
original xatom.config (Note, if the atoms are not in consequetive order
for different atom types, this first index will be changed, to the index
in output xatom.config file. The natom_fit is the atoms to be fitted (to
get their charge parameters Q1,Q2), while the natom_fix is the atoms
which already fitted before, thus already know the Q1,Q2 (the charge on
these two Guassian functions).</p>
<p>natom_fit and/or natom_fix can be zero (for imth=3, one can set both to
be zero). Note, if desired, it is okay for only fiting the charge for a
few atoms, instead of all the atoms. Or one can first fit the Q1,Q2 from
some other systems, then use them as natom_fix, and fit some additional
atoms in this system.</p>
<p><strong>numG=1, or 2</strong>: In above, in the section of ENERGY_NATION_COULOMB,
there are always two Gaussians. Actually, one can adjust the number of
Gaussian, numG=1 means only use 1 Gaussian (but there should still have
two columns in the ENERGY_NATION_COULOMB section, only the first column
is used). When numG=2, two Gaussians are used.</p>
<p><strong>iconstr=1</strong>, the IN.CONSTRAIN_COULOMB need to be input. It can have
the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>                       <span class="c1"># number of constrains (followed by num lines)</span>
     <span class="mi">3</span>  <span class="mf">1.0</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>            <span class="c1"># Num_atom; Qtot, ind1,ind2,ind3,...</span>
     <span class="mi">1</span> <span class="o">-</span><span class="mf">1.0</span> <span class="mi">4</span>                <span class="c1"># Num_atom; Qtot, ind1,ind2,ind3...</span>
</pre></div>
</div>
</div>
<p>Note, each line is one constrant. Qtot is the total charge of these few
atoms within this constraint. Ind1,ind2,ind3 are the atom number index
of the atoms within the natom_fit sequence in the ENERGY_DECOMP_COULOMB
section of the xatom.config file. Note, they are not the index in the
original xatom.config atom sequence. They are index within the list of
natom_fit (e.g., must be less or equal to natom_fit. For example, the 1,
2, 3 atoms in the above example correspond to atoms 151, 152, 153.</p>
<p>The fitted natom_fit Q1,Q2 results are shown in OUT.natom_coulomb_fit
(together with the natom_fix Q1,Q2 results input within the
ENERGY_NATOM_COULOMB section of xatom.config).</p>
<p><strong>imth=1</strong>: In this method, <span class="math notranslate nohighlight">\(\rho_{res}(r)=\rho(r)-\rho_{fit}(r)\)</span>,
note, <span class="math notranslate nohighlight">\(\rho(r)=\rho_{el}-\rho_{nuclear}\)</span>. So, the fitting is done
for the total charge density (including nuclear), not just for the
electron charge density. Then: Electrostatic potential density equals:
<span class="math notranslate nohighlight">\(E_{elst}(r)={1\over 8\pi} |\ensuremath{^{\circ}}V_{res}(r)|^2+\rho_{fit}V_{res}(r)\)</span>
(excluding <span class="math notranslate nohighlight">\(\rho_{fit}*\rho_{fit}\)</span> interaction). In the Hirshfeld
parititiong, only the first term is partitioned, the second term is
directly integrated for each atom, thus we have a <span class="math notranslate nohighlight">\(E(Q*V_{res})\)</span>
term (Q is the fitted charge), which is listed as one column in
OUT.ENDIV.</p>
<p>To get the atom decomposed energy without new fitting(after excluding
the fitted charge Coulomb interactions), one can set natom_fit=0 in the
ENERGY_NATOM_COULOMB section of xatom.config file.</p>
<p><strong>imth=2</strong>: In this option, the energy density (excluding the
<span class="math notranslate nohighlight">\(\rho_{fit}*\rho_{fit}\)</span> interaction) is expressed as:
<span class="math notranslate nohighlight">\({1\over 8\pi} [|\ensuremath{^{\circ}}V(r)|^2 fac1- |\ensuremath{^{\circ}}V_{fit}(r)|^2 fac2]\)</span>.
Here V(r) is the Coulomb potential of
<span class="math notranslate nohighlight">\(\rho(r)=\rho_{el}-\rho_{nuclear}\)</span>, and <span class="math notranslate nohighlight">\(V_{fit}\)</span> is the
Coulomb potential of <span class="math notranslate nohighlight">\(\rho_{fit}\)</span>. So, normally, <strong>fac1 and fac2</strong>
should be one. They are provided here, just for the purpose of analysis.
Note, in this option, there is no <span class="math notranslate nohighlight">\(E(Q*V_{res})\)</span> term, and this
column in OUT.ENDIV will be zero.</p>
<p><strong>imth=3</strong>: In this option, there is no on-the-flight fitting. Instead,
a prior fitted atomic charge will be used. In this option, all the atoms
need to be fitted, not just for a selected subset. The fitted spherical
charge density for each atom type in q-space is input from a file
called: funcq_atom.fit. This funcq_atom.fit is obtained from the utility
code vion_coulomb_fit.f90, based on the output charge density file
OUT.rho_EpN (<span class="math notranslate nohighlight">\(\rho_{el}-\rho_{nuclear}\)</span>) from a previous
ENERGY_DECOMP_COULOMB run. The electrostatic energy denisty is expressed
as
<span class="math notranslate nohighlight">\({1\over 8\pi} |\ensuremath{^{\circ}}V_{res}(r)|^2+\rho_{fit}V_{res}(r)\)</span>.
But unlike in imth=1, the second germ is not integrated for each atom,
instead, it is included in the Hirshfeld partitioning. This imth=3 can
significantly reduce the total electrostatic interaction energy (e.g, by
a factor of 1000 in the case of melted NaCl).</p>
<p><strong>q2w</strong>: a parameter (unit 1/A) used for a factor
<span class="math notranslate nohighlight">\(exp(-(q*q2w)^2/4)\)</span>, this factor is used in the on-the-flight
fitting of the Gaussian charge density to reduce the electrostatic
energy: <span class="math notranslate nohighlight">\(\sum_q |\rho_{res}(q)|^2*exp(-(q*q2w)^2/4)*4\pi/q^2\)</span>. The
idea is that, we can use this parameter to emphasize only the small
reciprocal vector q components, hence only the long range part of the
Coulomb interaction. Note, this factor is also used when generating
output “OUT.Coulomb_EpN” and “OUT.Coulomb_residual”. It can be used to
filter out the high energy components.</p>
<p><strong>iout= 0 or 1</strong>: 1 will mean there will be output (every MD step,
rewrite) charge density: OUT.rho_EpN (<span class="math notranslate nohighlight">\(\rho_{el}-\rho_{nuclear}\)</span>)
on a double grid; OUT.rho_EpN.fit (<span class="math notranslate nohighlight">\(\rho_{fit}\)</span>); OUT.Coulomb_EpN
(the Coulomb potential of <span class="math notranslate nohighlight">\(\rho_{el}-\rho_{nuclear}\)</span>, subject to
the <span class="math notranslate nohighlight">\(exp(-(q*q2w)^2/4)\)</span> factor; OUT.Coulomb_residual (the COulomb
potential of <span class="math notranslate nohighlight">\(rho_{res}=(\rho_{el}-\rho_{nuclear})-\rho_{fit}\)</span>
subject to the <span class="math notranslate nohighlight">\(exp(-(q*q2w)^2/4)\)</span> factor. Note, these quantitites
are double grid (<span class="math notranslate nohighlight">\(2n_1\times 2n_2\times 2n_3\)</span>) quantities for
Hirshfeld partitioning usage. iout=1 can be expensive.</p>
<p>It usually only used for JOB=SCF calculation, and it is can be used to
generate OUT.rho_EpN to fit the funcq_atom.fit using
vion_coulomb_fit.f90.</p>
</div>
<div class="section" id="ldau-psp">
<h3>LDAU_PSP<a class="headerlink" href="#ldau-psp" title="Permalink to this headline">¶</a></h3>
<p><strong>LDAU_PSP1 = LDAU_L(1), Hubbard_U(1) (optional Hubbard_U2(1))</strong></p>
<p><strong>LDAU_PSP2 = LDAU_L(2), Hubbard_U(2) (optional Hubbard_U2(2))</strong></p>
<p>…</p>
<p><strong>Default:</strong></p>
<p><strong>LDAU_PSP1 = -1</strong></p>
<p><strong>LDAU_PSP2 = -1</strong></p>
<p><strong>…</strong></p>
<p>If this parameter is set, LDA+U method will be used. When using LDA+U
method, one must specify, for each element(i), the atomic orbit to add
U, and the value of U. Note the (i) should correspond to the IN.PSP(i)
for the pseudopotential input.</p>
<p><strong>LDAU_L(i) = -1/0/1/2/3</strong>, 0/1/2/3 means adding a U term to the s/p/d/f
orbital. -1 means not to use LDA+U.</p>
<p><strong>HUBBARD_U(i)</strong>: the U parameter (<span class="math notranslate nohighlight">\(eV\)</span>) for species element types
i, the default value is 0.0. If HUBBARD_U2(i) is also provided, then the
first number is for spin up component, the second number is for spin
down component. They can be different. If the second number is not
provided, then the spin up and down U parameters will be the same.</p>
<p>Note, there are cases where the same atom type, say Co, needs to use
different U parameter depending on its local environment and valence
state (e.g., Co<span class="math notranslate nohighlight">\(^{3+}\)</span> and Co<span class="math notranslate nohighlight">\(^{2+}\)</span>). In such case, one
can change the atom number of Co in the atom.config file, say, one is
27, another is 127. Also, one add another Co pseudopotential
Co2.xxx.upf, and in Co2.xxx.upf, change its atomic number from 27 to
127. Now, one can add different U for this new 127 Co type.</p>
<p>Note, the LDA+U calculation is done by the following Hamiltonian:</p>
<div class="math notranslate nohighlight">
\[H = H_{LDA} + \sum_{I,\sigma} {U_{I,\sigma}\over 2} Tr[n^{I,\sigma}(I-n^{I,\sigma})]\]</div>
<p>here I denote the atomic site, and <span class="math notranslate nohighlight">\(\sigma\)</span> is for the spin, and
<span class="math notranslate nohighlight">\(n^{I,\sigma}(m1,m2)\)</span> is an occupation matrix for atomic orbital
<span class="math notranslate nohighlight">\(\phi_m\)</span> as:</p>
<div class="math notranslate nohighlight">
\[n^{I,\sigma}(m1,m2) = \sum_j &lt;\psi_{j,\sigma} |\phi^I_{m1}&gt; &lt; \phi^I_{m2}|\psi_{j,\sigma}&gt; occ(j,\sigma)\]</div>
<p>Here <span class="math notranslate nohighlight">\(\psi_{j,\sigma}\)</span> is the Kohn-Sham orbital for spin
<span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(occ(j,\sigma)\)</span> is its occupation. In above
<span class="math notranslate nohighlight">\(U_{I,\sigma}\)</span> is provided by the LDAU_PSP1 lines.</p>
<p>However, we can also add another term, which is:</p>
<div class="math notranslate nohighlight">
\[H = H_{LDA} + \sum_{I,\sigma} {U_{I,\sigma}\over 2} Tr[n^{I,\sigma}(I-n^{I,\sigma})] + \sum_{I,\sigma} \lambda_{I,\sigma} Tr[n^{L,\sigma}]\]</div>
<p>The parameters <span class="math notranslate nohighlight">\(\lambda_{I,\sigma}\)</span> are provided in a special
section LDAU_lambda in the atom.config file:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LDAU_lambda
     27  0.5  0.5   ! iatom, lambda_up, lambda_dn
     27  0.0  0.0
     ...........
     27  0.0  0.0   ! must have natom lines
</pre></div>
</div>
</div>
<p>Note, in this LDAU_lambda section in atom.config, even if not all atoms
have LDA+U, you must provide natom (all atom) lines for every atom. For
those atoms which do not has LDA+U (determined by the LDAU_PSPx lines),
their corresponding lambda will not be used. So, if you want to use
lambda, you must set the LDAU_PSPx line for that atom type. You can set
a very small U parameter for that atom type to reduce the first LDAU
term in above H formula.</p>
<p>In the LDAU calculation, we will have output: OUT.LDAU_NS, which writes
out the <span class="math notranslate nohighlight">\(n^{I,\sigma}\)</span> matrix for each atoms which has the
LDAU_PSPx line. One can use this <span class="math notranslate nohighlight">\(n^{I,\sigma}\)</span> and
<span class="math notranslate nohighlight">\(\lambda_{I,\sigma}\)</span> to calculate U with the linear-response
method (please check the corresponding PWmat module).</p>
</div>
<div class="section" id="constraint-mag">
<h3>CONSTRAINT_MAG<a class="headerlink" href="#constraint-mag" title="Permalink to this headline">¶</a></h3>
<p><strong>CONSTRAINT_MAG = 0 / 1</strong></p>
<p><strong>Default:</strong></p>
<p><strong>CONSTRAINT_MAG = 0</strong></p>
<div class="line-block">
<div class="line">This input line is used to put constraint on magnetic moment at each
atom for spin=2 calculations. If CONSTRAINT_MAG=1, this will be turned
on, if CONSTRAINT_MAG=0, this will not be used. Default is
CONSTRAINT_MAG=0. Currently, it only works for spin=2. This is to add
an energy penalty term:</div>
<div class="line"><span class="math notranslate nohighlight">\(\sum_{iatom} alpha\_mag(iatom) (M(iatom)-M_{input}(iatom))^2\)</span>
in the total energy expression. Note, M(iatom) is the magnetic moment
calculated from spin up and down charge density using Hirshfield
method, much like in the CHARGE_DECOMP. M_input(iatom) are the input
magnetic moment in atom.config file, under a section name:
CONSTRAINT_MAG. alpha_mag(iatom) is also input from the atom.config
from that CONSTRAINT_MAG section. Note, if this section is not
provided in atom.config, the default value for M_input(iatom) is
zero, and alpha_mag(iatom) is also zero. The unit of alpha_mag is in
eV.</div>
</div>
<p>Alpha_mag should not be set to be too large. Otherwise the SCF iteration
will be difficult to converge. One recommended alpha_mag is 0.01 eV. One
can also set different alpha_mag for different atoms. Also, note that
one can use the above additional energy to add an effective magnetic
field H at each atom (with different amplitude etc). To do that, one can
use a large M_input(iatom) in the direction one wants, in the mean
time, uses a very small alpha_mag(iatom) which is proportional to
1/M_input(iatom). That will provide an effective H field on each atom.</p>
</div>
<div class="section" id="spin222-magdir-stepfix">
<h3>SPIN222_MAGDIR_STEPFIX<a class="headerlink" href="#spin222-magdir-stepfix" title="Permalink to this headline">¶</a></h3>
<p><strong>SPIN222_MAGDIR_STEPFIX = N</strong></p>
<p><strong>Default:</strong></p>
<p><strong>SPIN222_MAGDIR_STEPFIX = 0</strong> (for XCFUNCTIONAL = LDA)</p>
<p><strong>SPIN222_MAGDIR_STEPFIX = 1000</strong> (for everything else)</p>
<p>This input line is used to fix magnetic moment after
SPIN222_MAGDIR_STEPFIX self-consistent iterations. If
SPIN222_MAGDIR_STEPFIX = 30, it means that after 30 self-consistent
interations, magnetic moment will be fixed. But for XCFUNCTIONAL = LDA,
default SPIN222_MAGDIR_STEPFIX is 0, magnetic moment will not be fixed.
If you set SPIN222_MAGDIR_STEPFIX = 1, initial magnetic moment will be
fixed, and will not change with self-consistent interations. Please note
that SPIN222_MAGDIR_STEPFIX is only used for SPIN = 222.</p>
</div>
<div class="section" id="xcfunctional">
<h3>XCFUNCTIONAL<a class="headerlink" href="#xcfunctional" title="Permalink to this headline">¶</a></h3>
<p><strong>XCFUNCTIONAL=LDA/PBE/HSE/PBESOL/PW91/TPSS/SCAN</strong>.</p>
<p>If you want to use other functional from LIBXC, you can set xcfunctional
as following:</p>
<p><strong>XCFUNCTIONAL=XC_LDA_X+XC_LDA_C_PZ</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL=XC_GGA_C_PBE+XC_GGA_X_PBE</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL=XC_HYB_GGA_XC_B3LYP</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL=XC_MGGA_C_TPSS+XC_MGGA_X_TPSS</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL= SCAN + rVV10</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL= LDA/PBE/HSE + rVV10</strong></p>
<p>OR</p>
<p><strong>XCFUNCTIONAL= LDAWKM/LDAWKM2</strong></p>
<p>The parameter is case insensitive. You can refer to
<a href="#id365"><span class="problematic" id="id366">:raw-latex:`\cite{libxc1}`</span></a> and <a href="#id367"><span class="problematic" id="id368">:raw-latex:`\cite{libxc2}`</span></a> for more
information about the parameters of LIBXC.</p>
<p><strong>Default:</strong></p>
<p><strong>XCFUNCTIONAL = PBE</strong></p>
<p>XCFUNCTIONAL is used to Control the exchange-correlation functional.
PWmat supports the LIBXC library for its LDA/GGA/METAGGA functional. The
most commonly used functional include: LDA, PBE, HSE, PBESOL, PW91, TPSS
etc. If you want to use other functional from LIBXC, you can set
xcfunctional as indicated about.</p>
<p>If XCFUNCTIONAL = HSE, PWmat will do HSE calculation. One could use the
optional parameter: HSE_OMEGA, HSE_ALPHA. Their default values are 0.2,
0.25 (the HSE06). Note PBE0 (the long range exchange integral) is just a
special form of HSE with HES_OMEGA parameter close to zero (see the
section HSE_OMEGA, HSE_ALPHA).</p>
<p>For hybrid-functionals in libxc except HSE and B3LYP, you should set
HSE_ALPHA and HSE_BETA that consistent with your chosen xc functional.
PWmat will set default HSE_ALPHA and HSE_BETA for B3LYP and HSE, but not
for others.</p>
<p>If there are rVV10, one can optionally use RVV10_DETAIL to specific
RVV10 parameters.</p>
<p>The LDAWKM and LDAWKM2 options are really WKM calculations (together
with JOB=SCF). In particular, what it is doing is the following: For
LDAWKM:</p>
<div class="math notranslate nohighlight">
\[H=H_{LDA} + \sum_k \lambda_k s_k (1-s_k)\]</div>
<p>and for LDAWKM2:</p>
<div class="math notranslate nohighlight">
\[H=H_{LDA} + \sum_k \lambda_k s_k\]</div>
<p>Here <span class="math notranslate nohighlight">\(s_k\)</span> are the occupation number of Wannier functions
<span class="math notranslate nohighlight">\(\phi_k\)</span> defined as:</p>
<div class="math notranslate nohighlight">
\[S(k1,k2)= \sum_j &lt;\psi_j|\phi_{k1}&gt; &lt;\phi_{k2}|\psi_j&gt; occ(j)\]</div>
<p>Here <span class="math notranslate nohighlight">\(occ(j)\)</span> is the occupation of the Kohn=Sham wave function
<span class="math notranslate nohighlight">\(\psi_j\)</span>. Thus: <span class="math notranslate nohighlight">\(s_k=S(k,k)\)</span>. The parameters
<span class="math notranslate nohighlight">\(\lambda_k\)</span> are input from the file IN.WANNIER_PARAM. It has a
form like:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">144</span> <span class="mi">72</span> <span class="mi">72</span>      <span class="p">:</span> <span class="n">n1w</span><span class="p">,</span><span class="n">n2w</span><span class="p">,</span><span class="n">n3w</span>
<span class="mi">5</span>   <span class="mi">1</span>          <span class="p">:</span> <span class="n">num_wannier_site</span><span class="p">,</span> <span class="n">num_site</span><span class="p">(</span><span class="n">to</span> <span class="n">repeat</span> <span class="n">the</span> <span class="n">Wannier</span><span class="p">)</span>
<span class="o">-----------------------------------</span>
<span class="mi">1</span>   <span class="o">-</span><span class="mf">0.5</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">up</span>
<span class="mi">2</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">up</span>
<span class="mi">3</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">up</span>
<span class="mi">4</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">up</span>
<span class="mi">5</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">up</span>
<span class="o">-----------------------------------</span>
<span class="mi">1</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">dn</span>
<span class="mi">2</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">dn</span>
<span class="mi">3</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">dn</span>
<span class="mi">4</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">dn</span>
<span class="mi">5</span>    <span class="mf">0.0</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">eV</span><span class="p">,</span> <span class="n">dn</span>
<span class="o">-----------------------------------</span>
<span class="mi">1</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>    <span class="p">:</span> <span class="n">isite</span><span class="p">,</span><span class="n">ish1</span><span class="p">,</span><span class="n">ish2</span><span class="p">,</span><span class="n">ish3</span>
<span class="o">-----------------------------------</span>
</pre></div>
</div>
</div>
<p>Note, if there are num_site &gt; 1, then there should be so many lines in
the last section (isite,ish1,ish2,ish3), which spell out each site, how
much shift. This feature is used to avoid to input too many Wannier
functions if they are the same (just by a shift). The Wannier functions
are input from files: IN.WANNIER_0001.u, IN.WANNIER_0002.u,
IN.WANNIER_0001.d, IN.WANNIER_0001.d etc (each file has one Wannier
function, with the same format as in IN.RHO) just like for the JOB=WKM
calculations.</p>
<p>For the LDAWKM, LDAWKM2 calculations, besides the usually results shown
in REPORT, there are also results in OUT.WANNIER_S (the diagonal result
of s_k) and OUT.WANNIER_SS (the full S(k1,k2) matrix) for all the
Wannier functions.</p>
</div>
<div class="section" id="rvv10-detail">
<h3>RVV10_DETAIL<a class="headerlink" href="#rvv10-detail" title="Permalink to this headline">¶</a></h3>
<p><strong>RVV10_DETAIL = b, c</strong></p>
<p><strong>Default:</strong></p>
<p><strong>RVV10_DETAIL = 6.3, 0.0093</strong></p>
<p>The current code implemented the RVV10 dispersion interaction (G.
Roman-Perez, J.M. Soler, Phys. Rev. Lett. 103, 096102 (2009); R.
Sabatini, T. Gorni, S. de Gironcoli, Phys. Rev. B, 87, 041108 (2013)).
The RVV10 use a nonlocal integral of charge densities at different
points, r, r’ derived from RPA formalism. The kernel of this integral is</p>
<div class="math notranslate nohighlight">
\[\phi^{VV10}(r,r')=-{3e^4\over 2m^2} {1\over g g' (g+g')}\]</div>
<p>Here <span class="math notranslate nohighlight">\(g=\omega_0(r)(r-r')^2+k(r)\)</span>,
<span class="math notranslate nohighlight">\(g'=\omega_0(r')(r-r')^2+k(r')\)</span>. Furthermore,
<span class="math notranslate nohighlight">\(\omega_0(r)=\sqrt{\omega_g^2(r)+\omega_p^2(r)/3}\)</span>.
<span class="math notranslate nohighlight">\(\omega_p^2(r)=4\pi{n(r)}e^2/m\)</span> is the plasma frequency.</p>
<p><span class="math notranslate nohighlight">\(\omega_g^2(r)=c(\hbar^2/m^2)|\frac{\nabla{n(r)}}{n(r)}|^4\)</span> and
<span class="math notranslate nohighlight">\(k(r)=3 \pi b({n(r)\over9\pi})^{1\over 6}\)</span>, Here b and c are
parameters. For default, b=6.3, c=0.0093. But one can use RVV10_DETAIL
to specify different b and c values. This is only used when XCFUNCTIONAL
contains RVV10.</p>
</div>
<div class="section" id="hse-detail">
<h3>HSE_DETAIL<a class="headerlink" href="#hse-detail" title="Permalink to this headline">¶</a></h3>
<p><strong>HSE_DETAIL = HSE_MIX, MAX_SXP, TOLHSE_MIX, HSE_DN,
HSE_PBE_SCF, CHECK_DSXH</strong></p>
<p><strong>Default:</strong></p>
<p><strong>HSE_DETAIL = 1, 1, 0.0, 6, 1, 1</strong></p>
<p>This is an optional choice when functional=HSE. It specifies all the
details for a HSE SCF calculation.</p>
<p>Besides these parameters, there are other parameter which can also
affect the convergence of the HSE atomic relaxation or phonon
calculation, in particular the Ecutp parameter. Ecutp=4Ecut might be
needed to provide sufficient accurate force. However, since increase
Ecutp can significantly increase the computational time, one only use
this option is Ecutp=Ecut (the default) has some problems. See the
section for Ecutp.</p>
<p><strong>HSE_MIX</strong>: A real number, describe the Fock exchange kernel mixing
parameter during SCF calculation (no, not confuse this with the HSE
alpha parameter in the functional itself). It could be larger than one
(e.g., 1.2). This is a bit like the charge mixing factor. Default is 1.
Recommend 1 for most cases. If it is too large, it can blow up the
convergence.</p>
<p><strong>MAX_SXP</strong>: Maximum number of Fock exchange kernel mixing terms.
Numbers larger than one (e,g., 2, 3) can speed-up the HSE convergence.
But each increase will cost one extra memory usage at the size of a wave
function. This is like the length of Pulay mixing for charge mixing
algorithm. But it is for the Fock exchange term. The default value is 1
(no Pulay mixing).</p>
<p><strong>TOLHSE_MIX</strong>: The tolerance for the Fock exchange term mixing for the
HSE SCF iteration to stop. The default value is 0.d0. One can also use
value 1.E-03</p>
<p>Note, in the output (screen printing), REPORT , there is one line:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">update_sxp</span><span class="p">(</span><span class="n">err</span><span class="p">)(</span><span class="n">eV</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.2222E-02</span><span class="p">,</span> <span class="mf">0.1111E-02</span>
</pre></div>
</div>
</div>
<p>This item (UPDATE_SXP) correspond to the TOLHSE_MIX value. The first
value (0.2222E-02) represents the actual Fock exchange term changes
(error) after the Fock exchange term ’sxp’ has been updated. The second
value (0.1111-02) represent the predicted value (error) after doing Fock
exchange pulay mixing when MAX_SXP <span class="math notranslate nohighlight">\(&gt;\)</span> 1.</p>
<p><strong>HSE_DN</strong>: The number of SCF steps for each Fock exchange kernel
update. Default value is 6. Recommend 3 to 10. In our algorithm, each
Fock exchange kernel update is followed by HSE_DN steps of the SCF step
(without updating the Fock exchange kernel). This HSE_DN steps have the
cost of PBE to run for each step, thus it is relatively cheap. Since
each Fock exchange kernel update is expensive, this parameter is
important. One wants the HSE_DN SCF step to converge the charge density
etc. following each Fock exchange kernel update. But too large HSE_DN
might not be so helpful and can still be costly to run. So, one wants to
choose this parameter carefully. If one finds the HSE calculation does
not converge, one might want to increase HSE_DN. Note, the total number
of SCF steps specified in SCF_ITER0_X, SCF_ITER1_X counts both the SCF
update step and the Fock excahnge update steps.</p>
<p><strong>HSE_PBE_SCF</strong>: The parameter define, for HSE SCF calculation, whether
one wants to do one PBE calculation first. The default is 1 (do PBE SCF
calculation first). If it is set to 0, that means doing the HSE
calculation first, without doing a pre-PBE calculation.</p>
<p><strong>CHECK_DSXH</strong>: The parameter define, for HSE SCF calculation, whether
check the convergency of ACE projector. The check may fail that SCF can
not get the demanded accuracy(check REPORT <a class="reference external" href="file:ending_scf_reason">file:ending_scf_reason</a> =
d_sxp.gt.d_sxp_laststep ), then one can try CHECK_DSXH=0. The default is
1.</p>
<p>Overall, we recommend to use HSE_MIX=1, MAX_SXP=1, TOLHSE_MIX=0.0,
HSE_DN=3-6, HSE_PBE_SCF=1. If there are problems to converge the HSE
SCF, one might want to consider MAX_SXP=2,3, and increase HSE_DN.</p>
</div>
<div class="section" id="relax-hse">
<span id="section-relaxdetai2"></span><h3>RELAX_HSE<a class="headerlink" href="#relax-hse" title="Permalink to this headline">¶</a></h3>
<p><strong>RELAX_HSE=NUM_LDA, FACT_HSELDA, LDA_PBE</strong></p>
<p><strong>Default:</strong></p>
<p><strong>RELAX_HSE = 20, 0.05, 2</strong></p>
<p>This is an line for “JOB = RELAX” when XCFUNTIONAL=HSE. It uses special
techniques to accelerate the atomic relaxation under HSE. Currently,
this option only works for conjugated gradient atomic relaxation as
defined in RELAX_DETAILS. In this option, the additional LDA or PBE
atomic relaxations are used as preconditioner for the HSE relaxation.</p>
<p><strong>NUM_LDA</strong> is the maximum number of relaxation steps for the LDA/PBE
preconditioner run. It uses the LDA/PBE atomic relaxation as a
preconditioner for the HSE atomic relaxation. If NUM_LDA=0, then no
precondition is used, it is the plain CG atomic relaxation based on HSE.
The default is 20.</p>
<p><strong>FACT_HSELDA</strong> is the prefactor to stop the LDA/PBE relaxation: if
LDA/PBE force is less than FACT_HSELDA multiplied the HSE force, then
stop. The default is 0.05.</p>
<p><strong>LDA_PBE</strong> is the indicator for LDA or PBE functional used for the
atomic relaxation to find the preconditioner of HSE relaxation. If
LDA_PBE=1, use LDA; LDA_PBE=2, use PBE. One should use the xcfunctional
which is closest to HSE. The default value is 2.</p>
<p>Comments: before one use this option (NUM_LDA <span class="math notranslate nohighlight">\(&gt;\)</span>0), one better
make sure the PBE, or LDA atomic relaxation of the system is smooth. So,
one might want to use Ecut2=4*Ecut.</p>
</div>
<div class="section" id="hse-omega">
<h3>HSE_OMEGA<a class="headerlink" href="#hse-omega" title="Permalink to this headline">¶</a></h3>
<p><strong>HSE_OMEGA = :math:`omega`</strong></p>
<p><strong>Default:</strong></p>
<p><strong>HSE_OMEGA = 0.2</strong></p>
<p>Related input line: XCFUNCTIONAL = HSE</p>
<p>The screening parameter for HSE like hybrid functionals. Refer to J.
Chem. Phys. 118, 8207 (2003) and and J. Chem. Phys. 124, 219906 (2006)
for more information. PWmat support range separated hybrid functional
calculations. It separate the exchange integration into long range and
short range. This parameter is used to provide the range, used in the
way of <span class="math notranslate nohighlight">\(\omega r\)</span>. The default value is 0.2 1/Å. So, bigger this
value, shorter the cut-off to distinguish the short range and long
range.</p>
</div>
<div class="section" id="hse-alpha">
<h3>HSE_ALPHA<a class="headerlink" href="#hse-alpha" title="Permalink to this headline">¶</a></h3>
<p><strong>HSE_ALPHA = :math:`alpha`</strong></p>
<p><strong>Default:</strong></p>
<p><strong>HSE_ALPHA = 0.25</strong></p>
<p>Related input line: XCFUNCTIONAL=HSE</p>
<p>The mixing parameter of the explicit short range Fock exchange part. The
default is 0.25. Combined HSE_OMEGA, the exchange correlation energy is:
<span class="math notranslate nohighlight">\(E_{xc}=\alpha*E_x(FOCK,\omega)-\alpha*E_x(PBE,\omega)+E_x(PBE)+E_c\)</span>.
Here <span class="math notranslate nohighlight">\(E_x(FOCK,\omega)\)</span> is the explicit short range Fock exchange
integral with the Coulomb integration truncated by <span class="math notranslate nohighlight">\(\omega\)</span>,
<span class="math notranslate nohighlight">\(E_x\)</span>(PBE) is the PBE exchange density functional energy,
<span class="math notranslate nohighlight">\(E_x(PBE,\omega)\)</span> is the short range PBE exchange density
functional energy with the range defined by <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
</div>
<div class="section" id="hse-beta">
<h3>HSE_BETA<a class="headerlink" href="#hse-beta" title="Permalink to this headline">¶</a></h3>
<p><strong>HSE_BETA = :math:`beta`</strong></p>
<p><strong>Default:</strong></p>
<p><strong>HSE_BETA = 0.0</strong></p>
<p>Related input line: XCFUNCTIONAL=HSE</p>
<p>The mixing parameter of the explicit long range Fock exchange part. The
default is 0.0. PWmat provides support for a separated range hybrid
calculations (all to be called HSE). The default <span class="math notranslate nohighlight">\(\beta\)</span> is zero,
thus no long range part. But one can also input a nonzero <span class="math notranslate nohighlight">\(\beta\)</span>.
Sometime it is argued that, to get the correct optical properties, one
should use 1/dielectric-constant as <span class="math notranslate nohighlight">\(\beta\)</span> for bulk systems.</p>
<p>When <span class="math notranslate nohighlight">\(\beta\)</span> is nonzero, the final XC functional is:
<span class="math notranslate nohighlight">\(E_{xc}=\alpha*E_x(FOCK,\omega)+\beta*(E_x(FOCK,full)-E_x(FOCK,\omega))+E_x(PBE)-\alpha*E_x(PBE,\omega)-\beta*(E_x(PBE)-E_X(PBE,\omega))+E_c\)</span>.
Here <span class="math notranslate nohighlight">\(E_x(FOCK,\omega)\)</span> is the explicit short range Fock exchange
integral with the Coulomb integration truncated by <span class="math notranslate nohighlight">\(\omega\)</span>,
<span class="math notranslate nohighlight">\(E_x(FOCK,full)\)</span> is the full explicit exchange integral,
<span class="math notranslate nohighlight">\(E_x\)</span>(PBE) is the PBE exchange density functional energy,
<span class="math notranslate nohighlight">\(E_x(PBE,\omega)\)</span> is the short range PBE exchange density
functional energy with the range defined by <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<p>It has been argued that such a range separated HSE function can be used
to replacing more advanced method like GW to provide approximated
electronic structures.</p>
</div>
<div class="section" id="hsemask-psp">
<h3>HSEMASK_PSP<a class="headerlink" href="#hsemask-psp" title="Permalink to this headline">¶</a></h3>
<p>The format of the parameter is:</p>
<p><strong>HSEMASK_PSP1 = ampl1 size1</strong></p>
<p><strong>HSEMASK_PSP2 = ampl2 size2</strong></p>
<p>This is a special option for HSE, for cases where one wants to use
different HSE mixing parameters for different regions (e.g., atoms) in
heterostructural calculations.Since the HSE mixing parameter is very
much an empirical parameter, in order to get the correct band gap at
different regions (e.g., in a Si/SiO2 heterostructure), one might want
to use different mixing parameters for these regions
<a href="#id369"><span class="problematic" id="id370">:raw-latex:`\cite{HSEMASK}`</span></a>. The parameter provided here can accomplish
that. These are parameters used to provide an element specified HSE
mixing parameter HSE_ALPHA.</p>
<p>Related input line: XCFUNTIONAL=HSE.</p>
<p>The size1, size2… are in Bohr unit. The parameter can adjust the gap
of HSE calculation with different setting for different atomic types.</p>
<p>The explicit Fock exchange integral (including the mixing parameter) is:</p>
<div class="math notranslate nohighlight">
\[E_x(Fock)= \alpha \sum_i \sum_j o(i) o(j) \int \int \psi^*_i(r)\psi_j(r) m(r) \frac{erfc(|r-r'|\omega)}{|r-r'|} m(r') \psi_i(r')\psi^*_j(r') d^3r d^3r'\]</div>
<p>Here the o(i) is the orbital i occupation function, and mask function
m(r) is: <span class="math notranslate nohighlight">\(m(r)=1+\sum_R ampl_R exp(-(r-R)^2/size_R^2)\)</span>, here
ampl<span class="math notranslate nohighlight">\(_R\)</span> and size<span class="math notranslate nohighlight">\(_R\)</span> are the parameters input from
HSEMASK_PSP1,etc.</p>
<p>Note, the effective HSE_ALPHA is the default HSE_ALPHA multiplied by
m(r)<span class="math notranslate nohighlight">\(^2\)</span>, which is then determined by ampl1, ampl2, etc. The
ampl1 itself is not HSE_ALPHA.</p>
</div>
<div class="section" id="hse-kpt-treatment">
<h3>HSE_KPT_TREATMENT<a class="headerlink" href="#hse-kpt-treatment" title="Permalink to this headline">¶</a></h3>
<p>The format of the parameter is:</p>
<p><strong>HSE_KPT_TREATMENT = flag_double_grid flag_vq_interp vq_interp_range</strong></p>
<p>This is a special option for HSE, especially for JOB=NONSCF calculations
for HSE band structures. In HSE calculation, when band structure is
calculated, new kpoints are provided from IN.KPT, and the wave functions
from JOB=SCF calculation on a MP kpoint grid k_prime=(NQ1,NQ2,NQ3) are
used for the Fock exchange integral kernel. However, since the new
kpoints k from the IN.KPT are not in the k_prime grid, some special
treatments are needed to deal with this. We provided two options for
this. The default option is flag_double_grid=1, flag_vq_interp=0. The
default value should be good for most cases. flag_double_grid=1 means a
special treatment for q=k-k_prime+G. A double grid is defined on top of
(within) the (NQ1,NQ2,NQ3) grid (i.e, the grid consists of lines 0, 2,
4,.. etc), the Fock exchange contribution of the k_prime for its q on
the double grid will be deleted (its corresponding Coulomb kernetl vq(q)
is set to zero), while multipling the contribution from the other
k_prime points by a factor of 8/7. This can be useful, e.g., to have the
correct symmetry, and make sure X point result is the same as the -X
point result. Note, for JOB=SCF, one can choose flag_double_grid=1 or 0,
although we do recommend 1 for SCF. flag_vq_interp=0 means the vq
interpolation is not used (vq_interp_range is not used in this case).
For JOB=SCF, we can only use flag_vq_iinterp=0. In this case, a shifting
of k_prime is used. Basically, the 8 k_prime points on the cube
enclosing k are shifted to k, one at a time, so to make k points on the
k_prime grid. The 8 shifting are them linearly added using linear
interpolation weights. Note, only the kernel vq are averaged, so there
is no extra FFTs. We strongly recommend this option for JOB=NONSCF for
most cases. However, due to the linear interpolation, on the very small
energy scale, one can have a small linear kink on the band structure,
especially at the high symmetry point. Here, we provide another option:
flag_double_grid=0 and flag_vq_interp=1. In this case, the k_prime
points are not shifted, and vq are calculated using the formula, but for
q close to zero, within a cutoff qcut=dq*vq_interp_range (dq is the
NQ1,NQ2,NQ3 grid interval size), the calculated vq (which is kind of
diverging for q close to zero) is switched (using a cos function) into
the Gygi’s formula exxvq term. The vq_interp_range (usually around 1)
can be used to control the range of this switching (morphing). Larger
the range, smoother will be the band structure. Note, since we are using
flag_double_grid=0, the energy of k point even when k=k_prime might
slightly different from the SCF value when this option is used. But when
flag_vq_interp=0 is used, on the k_prime point, the JOB=NONSCF band
structure value is exactly the same as the JOB=SCF result.</p>
</div>
<div class="section" id="vdw">
<h3>VDW<a class="headerlink" href="#vdw" title="Permalink to this headline">¶</a></h3>
<p><strong>VDW = NONE / DFT-D2 / DFT-D3 /PAIR</strong></p>
<p><strong>Default:</strong></p>
<p><strong>VDW = NONE</strong></p>
<p>This parameter is used to specify the type of Van Der Waals correction.</p>
<p>If use DFT-D2, some variables are optional to be set: <strong>LONDON_S6,
LONDON_C6, LONDON_RCUT</strong>. We use the Grimme’s empirical vdw functional
term. It is okay without setting the LONDON parameters.</p>
<p><strong>LONDON_S6</strong>: Global scaling parameter for DFT-D. Default is 0.75.</p>
<p><strong>LONDON_C6</strong>: It is an array its dimension is the number of atomic
type. Its format is like this: LONDON_C6(1) = …, LONDON_C6(2) = …</p>
<p>(1),(2) are the atom types, in accordance with IN.PSP1, IN.PSP2. These
are the C6 parameters in the Lennard-Jones potential <span class="math notranslate nohighlight">\(1/r^6\)</span> term
parameter. Only the attractive <span class="math notranslate nohighlight">\(1/r^6\)</span> term is included in VDW.
The repulsion part is already in the DFT energy. The parameter LONDON_S6
determines trunction of this term at small r.</p>
<p>The default value is from the Grimme-D2 values. You can refer to the
article: S. Grimme, J. Comp. Chem. 27, 1787(2006).</p>
<p><strong>LONDON_RCUT</strong>: The cutoff radius (a.u.) for dispersion interactions
calculations. The default is 200.0. For <span class="math notranslate nohighlight">\(\left|R1-R2\right|\)</span>
larger than this cut-off, the vdW interaction will not be calculated.
Note, this default value might be too large.</p>
<p>If use DFT-D3(zero-damping method), some variables are optical to be
set: <strong>DFTD3_S6, DFTD3_RS6, DFTD3_S18, DFTD3_RS18, DFTD3_ALPHA6,
DFTD3_VERSION, DFTD3_3BODY</strong>. For more information about the DFT-D3, one
can refer to this paper <a href="#id371"><span class="problematic" id="id372">:raw-latex:`\cite{dftd3-zero-damping}`</span></a>.</p>
<p>In the D3 correction method, the following vdW-energy expression is
used:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        E_{disp} = -\frac{1}{2} \sum\limits_{i=1}^{Natom} \sum\limits_{j=1}^{Natom} \sum\limits_{L}\bigg(f_{d,6}(r_{ij,L})\frac{C_{6ij}}{r_{ij,L}^{6}} + f_{d,8}(R_{ij,L})\frac{C_{8ij}}{r_{ij,L}^{8}} \bigg)
    \end{aligned}\]</div>
<p>The dispersion coefficients <span class="math notranslate nohighlight">\(C_{6ij}\)</span> are geometry-dependent as
they are adjusted on the basis of local geometry (coordination number)
around atoms i and j. In the zero-damping method, damping of the
following form is used:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        f_{d,n}(r_{ij}) = \frac{s_{n}}{1+6(r_{ij}/(s_{R,n}R_{oij}))^{-\alpha_{n}}}
    \end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(R_{oij} = \sqrt{\frac{C_{8ij}}{C_{6ij}}}\)</span>, the parameters
<span class="math notranslate nohighlight">\(s_{R,8}\)</span> are normally 1. Respectively, the
<span class="math notranslate nohighlight">\(s_{6}, s_{8}, s_{R,6}, \alpha_{6}\)</span> are adjustable parameters
whose values depend on the choice of exchange-correlation functional.
Note the default parameter is tested for PBE.</p>
<p><strong>DFTD3_VERSION</strong> The parameter for zero-damping DFT-D3 method is 3.</p>
<p><strong>DFTD3_3BODY</strong> The parameter controlling whether considering the three
body term in DFT-D3 correction method. The default is T (considering).
If not considering the term, setting DFTD3_3BODY = F.</p>
<p><strong>VDW=PAIR</strong> In that case, the file IN.VDWPAIR need to provided. This is
a general user provided pair potential in a numerical form, which has
the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1001, 3, 8.0       ! nr, n_pair, r_cut(angstrom)
31 31 33           ! iatom_1 (npair)
33 31 33           ! iatom_2 (npair)
0.00,  p1,  p2,  p3  ! r, pot(pair1), pot(pair2), pot(pair3) (eV)
...
r,   p1, p2, p3       ! The nr-th line for p1,p2,p3
</pre></div>
</div>
</div>
</div>
<div class="section" id="coulomb">
<h3>COULOMB<a class="headerlink" href="#coulomb" title="Permalink to this headline">¶</a></h3>
<p><strong>Default:</strong></p>
<p><strong>COULOMB = 0</strong></p>
<p>Control the Poisson equation solution (for the Coulomb interaction).</p>
<p>We provide special ways to calculate the Coulomb potential (also called
Hartree potential) of the charge density rho(r) during the SCF
calculation. This could be particularly helpful for isolated system
calculation, or for slab calculation. This is to avoid electrostatic
image interaction for isolated systems, or the dipole moment effect for
neutral slab calculations.</p>
<p><strong>COULOMB = 0</strong>, the periodic boundary condition, the default.</p>
<p><strong>COULOMB = 1, X1, X2, X3</strong>: the isolated cluster boundary condition. It
can avoid the image interaction in this calculation. The X1, X2, X3
(value: 0<span class="math notranslate nohighlight">\(\sim\)</span>1) are the fractional coordination values in
the unit cell edge vectors 1, 2, 3, used to cut a box for this special
Coulomb solution. In the other word, the center of the box is at:
(X1+0.5, X2+0.5, X3+0.5).</p>
<p><strong>COULOMB = 11, X1</strong>: A slab calculation along the first direction, with
the cut at X1. This can avoid the dipole moment interaction between
slabs. Note, this method only works for neutral system. For charged slab
system, the energy is infinite for an isolated slab. In that case,
please just use COULOMB=0.</p>
<p><strong>COULOMB = 12, X2</strong>: A slab calculation along the second direction with
the cut at X2. Only for neutral system.</p>
<p><strong>COULOMB = 13, X3</strong>: A slab calculation along the third direction with
the cut at X3. Only for neutral system.</p>
</div>
<div class="section" id="in-occ">
<h3>IN.OCC<a class="headerlink" href="#in-occ" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.OCC = T / F, iproj</strong> <strong>(iproj = 0 / 1 / 2 / 22 / 3 / 33)</strong></p>
<p><strong>Default:</strong></p>
<p><strong>IN.OCC = F</strong></p>
<p>Related items: PROJ3_DETAIL, IN.iproj3_CC_2spin, IN.OCC_T, IN.CC. In all
these options, the PWmat will try to use speciall ways to determine the
occupation of wave functions, or eigen states, instead of using the
conventional Fermi-Dirac distribution from the SCF_ITER0_1, SCF_ITER0_2,
SCF_ITER1_1 lines. Note, in general, not necessarily the eigen states
will be occupied, instead an linear combination of the eigen states can
be occupied. These options will be particularly useful for either
constraint DFT (with some excited electron states, or empty hole states)
SCF or RELAX jobs, or TDDFT simulations. For example, it can be used to
prepare some special initial excited state in TDDFT.</p>
<p>In this option, PWmat will read a file called “IN.OCC”. This is to
specify the occupation for each Kohn-Sham orbital <span class="math notranslate nohighlight">\(\phi_j\)</span> for a
constraint DFT calculation. <strong>WARNING:”IN.OCC=T” is equivalent to:
“IN.OCC=T,0”</strong></p>
<p>In the following, we will use <span class="math notranslate nohighlight">\(\phi_i\)</span> to denote the adiabatic
eigen state of the Kohn-Sham Equation:
<span class="math notranslate nohighlight">\(H \phi_i = \epsilon_i \phi_i\)</span>. In the meantime, we can input
another set of wave function: <span class="math notranslate nohighlight">\(\{\psi_j\}\)</span>, e.g, through the
IN.WG=T option. This <span class="math notranslate nohighlight">\(\{\psi_j\}\)</span> is a bit like the time evolving
wave functions in TDDFT, and they can be used to help the occupation of
states to generat the charge density.</p>
<p>The following are the different options for iproj.</p>
<p><strong>iproj=0:</strong> (IN.OCC = T, or IN.OCC = T, 0): The SCF calculation charge
density will be generated as:
<span class="math notranslate nohighlight">\(\rho(r)= \sum_i o(i) |\phi_i(r)|^2\)</span>, and the occupation number
<span class="math notranslate nohighlight">\(o(i)\)</span> will be input from the IN.OCC file (see the explanation
below). Note, for iproj=0, the o(i) is fixed (for which state is which).
For example, if the third state in IN.OCC is empty (o(3)=0), then during
the SCF calculation, or atomic relaxation, it is always the third
adiabatic state which is unoccupied. This is okay for simple cases, but
for more complicated cases, it can cause problem, since during the SCF
iteration, or atomic relaxation, the order (which state is the third)
according to the adiabatic state eigen energies can often change
(re-ordered). As a result, the third state might not be the physical
state you like to keep it empty. One option in that case is to use
iproj=1.</p>
<p><strong>iproj=1:</strong> In this option, the index of which state is which is
determined by a projection between the adiabatic eigen state
<span class="math notranslate nohighlight">\(\phi_i\)</span> and the input state <span class="math notranslate nohighlight">\(\psi_j\)</span> from IN.WG. So, in
order to use this, one has to have IN.WG. More specifically, map(i)
equals the j which maximizes <span class="math notranslate nohighlight">\(|&lt;\phi_i|\psi_j&gt;|^2\)</span>. Basically,
this identifies which <span class="math notranslate nohighlight">\(\phi_i\)</span> is the input <span class="math notranslate nohighlight">\(\psi_{map(i)}\)</span>.
As a result, the charge density is generated as:
<span class="math notranslate nohighlight">\(\rho(r)= \sum_i o(map(i)) |\phi_i(r)|^2\)</span>. Note, <span class="math notranslate nohighlight">\(\psi_j\)</span> is
input from IN.WG. Once again, o(j) is input from IN.OCC, which has the
following form (for iproj=0,1,3):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>o1,o2,o3,.....o_mx        ! for kpt=1
o1,o2,o3,.....o_mx        ! for kpt=2
........
o1,o2,o3,.....o_mx        ! for kpt=nkpt
</pre></div>
</div>
</div>
<p>Here mx is the num_band, and nkpt is the number of reduced kpoint. Thus,
in each line, there are mx number, and there are nkpt line. Note, one
can write something like: 4*1,2*0 to replace: 1,1,1,1,0,0. Note,
o(j,kpt) is the occupation number discussed above (it must be between 0
and 1, even for SPIN=1, should not be 2). Note, the full occupation is
o(j,kpt)=1. So, if SPIN=1, o(j,kpt)=1 means this orbital will occupy 2
electron, and o(j,kpt)=0.5 means this orbital will occupy 1 electron.</p>
<p>If SPIN=2, then one has also to provide an file: IN.OCC_2, which has the
same format, but specify the spin down component occupation. In that
case, o(j,kpt)=1 means this orbital (up or down spin) will occupy one
electron, and o(j,kpt)=0 means this orbital of this spin will occupy
zero electron.</p>
<p><strong>iproj=2 (or 22):</strong> in the above case of iproj=0 and 1, the Fermi-Dirac
distribution function will be ignored (not used, or it is like
Fermi-Dirac=0). But even for iproj=1, there could be cases where it is
difficult to identify which <span class="math notranslate nohighlight">\(\phi_i\)</span> is <span class="math notranslate nohighlight">\(\psi_j\)</span>, for
example, if several states have the similar amplitude overlaps (e.g.,
around 0.3-0.5). In that case, even if we select and occupy one
<span class="math notranslate nohighlight">\(\phi_i\)</span>, the results might not be good either. What we really
need is to construct one <span class="math notranslate nohighlight">\(\psi_j\)</span>-like wave function
<span class="math notranslate nohighlight">\(\psi'_j\)</span> from a linear combination of <span class="math notranslate nohighlight">\(\phi_i\)</span>, then occupy
<span class="math notranslate nohighlight">\(\psi'_j\)</span>. More specifically, we can have:
<span class="math notranslate nohighlight">\(\psi'_j = \sum_i f(i,j) &lt;\phi_i|\psi_j&gt; \phi_i\)</span>. Here f(i,j) is a
selection and orthonormalization factor. For iproj=22, there is no
selection, and f(i) is just for orthonormalization (among all the
<span class="math notranslate nohighlight">\(\{ \psi'_j \}\)</span>). For iproj=1, a selection weight factor is used
for different i. More specifically, <span class="math notranslate nohighlight">\(f(i,j)=exp(-((1-x)/0.7)^6)\)</span>,
where <span class="math notranslate nohighlight">\(x=|&lt;\phi_i|\psi_j&gt;|^2\)</span>. Thus, effectively, it only select
the <span class="math notranslate nohighlight">\(\phi_i\)</span> states with overlap larger than 0.3. After this
selection factor, it is orthonormalized. The idea here is only to select
a few <span class="math notranslate nohighlight">\(\phi_i\)</span>, and use their linear combination to construct a
state resemble that of the original <span class="math notranslate nohighlight">\(\psi_j\)</span> state, but not to
completely reconstruct the <span class="math notranslate nohighlight">\(\psi_j\)</span> state. This will be useful to
deal with the case where two states anticross each other, so the
<span class="math notranslate nohighlight">\(\phi_i\)</span> character has changed, but a linear combination can
reconstruct the original <span class="math notranslate nohighlight">\(\psi_j\)</span>.</p>
<p>In terms of occupation, it uses a different strategy than iproj=0,1,3.
For iproj=2, the Fermi-Dirac distribution is still used, then on top of
it, an exception for some band is used to add or substract some states.
The idea is to use this to add one excited electron or subtract one hole
(on <span class="math notranslate nohighlight">\(\psi_j\)</span>) (called exception states) from the otherwise
Fermi-Dirac calculation. Note, when decide the Fermi energy, a total
charge of NUM_ELECTRON - dcharge is used, and dcharge is the charge from
<span class="math notranslate nohighlight">\(\psi_j\)</span> as specified in the IN.OCC to be explained below. So, the
actual total charge is NUM_ELECTRON. Also note, not only the charge
density of <span class="math notranslate nohighlight">\(\psi_j\)</span> is contributed, also its kinetic and nonlocal
potential part of the energy. The total charge density can be specified
as: <span class="math notranslate nohighlight">\(\rho(r)=\rho_{FD}(r)+ \sum_j o(j) |\psi'_j(r)|^2\)</span>, here
<span class="math notranslate nohighlight">\(\rho_{FD}(r)\)</span> is the Fermi-Dirac charge density, and o(j) is the
occupation from the IN.OCC, which has the following form in the case of
iproj=2(or 22):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>o1,o2,o3,.....o_mx        ! for kpt=1
o1,o2,o3,.....o_mx        ! for kpt=2
........
o1,o2,o3,.....o_mx        ! for kpt=nkpt
-------- (above nkpt lines are not used, this dashed line must be here)
nump                          ! The number of exception states
iband(1,1),od(1,1)            ! for indx=1,   kpt=1
iband(2,1),od(2,1)            ! for indx=2,   kpt=1
......
iband(nump,1),od(nump,1)      ! for indx=nump,kpt=1
iband(1,2),od(1,2)            ! for indx=1,   kpt=2
iband(2,2),od(2,2)            ! for indx=2,   kpt=2
......
iband(nump,2),od(nump,2)      ! for indx=nump,kpt=2
......                        ! repeat for different kpoint
......
iband(1,nkpt),od(1,nkpt)            ! for indx=1,   kpt=nkpt
iband(2,nkpt),od(2,nkpt)            ! for indx=2,   kpt=nkpt
......
iband(nump,nkpt),od(nump,nkpt)      ! for indx=nump,kpt=nkpt
</pre></div>
</div>
</div>
<p>Note, in this file, there must be nump*nkpt lines after the first nump+1
lines. The nump is the number of exception states in each kpoints. Each
of the nump*nkpt line should have two numbers. The first number is the
band index, the second number is an occupation (can be positive, or
negative (hole)).</p>
<p>Note, for SPIN=2, one needs to have the same format for IN.OCC_2.</p>
<p>Note, iproj=0,1,2 are often used for both SCF calculaiton, as well as
RELAX. iproj=0 is also often used for TDDFT calculation.</p>
<p>For the cases of iproj=1 for RELAX, the <span class="math notranslate nohighlight">\(\psi_{j}\)</span> for next RELAX
step is updated from the <span class="math notranslate nohighlight">\(\phi_{map(j)}\)</span> from the previous
relaxation step. For the case of iproj=2 for RELAX, <span class="math notranslate nohighlight">\(\psi_j\)</span> for
next RELAX step is replaced with <span class="math notranslate nohighlight">\(\psi'_j\)</span> from previous RELAX
step. Doing this will allow one to relax the system even if there is a
state crossing for a hole state (or electron state), while tracking and
keeping the same hole or excited electron.</p>
<p>The iproj=2 is usually more stable than iproj=1 for both SCF and RELAX.
So, it should be used if iproj=0 and 1 are unstable, and do not
converge.</p>
<p><strong>iproj=3 (or 33):</strong> this is used for SCF or TDDFT calculations, not for
RELAX. In iproj=2, the exception is used to calculate the charge
density. It is mostly designed to deal with RELAX, and conceptually, we
like to eventually make the <span class="math notranslate nohighlight">\(\psi_j\)</span> the adiabatic eigen states.
There are cases where we are interested in occupy specific input wave
function <span class="math notranslate nohighlight">\(\psi_j\)</span>, but they are not the adiabatic eigen states
<span class="math notranslate nohighlight">\(\phi_i\)</span>. More importantly, the occupied state <span class="math notranslate nohighlight">\(\psi'_j\)</span>
should be completely represented by <span class="math notranslate nohighlight">\(\phi_i\)</span>. So, the occupied
state is not the exact <span class="math notranslate nohighlight">\(\psi_j\)</span> input from IN.WG. If the fixed
<span class="math notranslate nohighlight">\(\psi_j\)</span> is to be occupied, one can use JOB=WKM. Here, we will
occupy <span class="math notranslate nohighlight">\(\psi'_j = \sum_i f(i) &lt;\phi_i|\psi_j&gt; \phi_i\)</span>, then
orthonormalized following this formula. Thus,
<span class="math notranslate nohighlight">\(\rho(r)=\sum_j o(j) |\psi'_j(r)|^2\)</span>, here o(j) is input from
IN.OCC. In the formula, f(i) is used to provide some possible truncation
(so there is no high energy <span class="math notranslate nohighlight">\(\phi_i\)</span> components for
<span class="math notranslate nohighlight">\(\psi'_j\)</span>. This can be provided by the following input line:</p>
<p>PROJ3_DETAIL = Ecut_proj3, dEcut_proj3 (in unit of eV)</p>
<p>Then: <span class="math notranslate nohighlight">\(f(i)=1/(exp((\epsilon(i)-Ecut\_proj3)/dEcut\_proj3)+1)\)</span></p>
<p>If the PROJ3_DETAIL does not exist, then f(i)=1</p>
<p>Also, in the IN.OCC, if one o(j) is negative, then
<span class="math notranslate nohighlight">\(\psi'_j=\phi_j\)</span>, and <span class="math notranslate nohighlight">\(o(j)=|o(j)|\)</span>.</p>
<p>This can be used to provide the initial state for TDDFT calculation (can
be used together with JOB=TDDFT). So, the wanted initial TDDFT
<span class="math notranslate nohighlight">\(\psi_j(t=0)\)</span> wave function (whatever wave function, not
necessarily eigen states) can be input from IN.WG. But for our TDDFT
implementation, we need to gaurantee the <span class="math notranslate nohighlight">\(\psi_j\)</span> can be
represented by the set of eigen states <span class="math notranslate nohighlight">\(\{ \phi_i \}\)</span>. This IN.OCC
and the first step in TDDFT (or the SCF calculation) can just gaurantee
this through a self-consistent iteration. Note, <span class="math notranslate nohighlight">\(\psi_j\)</span> can be
some localized state, or some ionic states for the ion far away from a
colliding surface. One can use other means to pre-construct IN.WG. Note,
this iproj=3 will automatically output a file OUT.iproj3_CC_2spin, it
contains the coefficient: <span class="math notranslate nohighlight">\(CC(i,j)=&lt;\phi_i|\psi_j&gt;\)</span> with
orthonormalization. For iproj=33, this OUT.iproj3_CC_2spin must be
copied into IN.iproj3_CC_2spin, and inside etot.input, one has to place
one line: IN.iproj3_CC_2spin=T. In this case, the IN.WG input is
actually the eigen state <span class="math notranslate nohighlight">\(\phi_i\)</span> instead of <span class="math notranslate nohighlight">\(\psi_j\)</span>, and
<span class="math notranslate nohighlight">\(\psi_j\)</span> is constructed as: <span class="math notranslate nohighlight">\(\psi_j=\sum_i CC(i,j) \phi_i\)</span>.
In this way, one can input both the eigen state and the <span class="math notranslate nohighlight">\(\psi_j\)</span>,
thus continue a iproj=3 calculation.</p>
<p><strong>Comparison with other options:</strong> Note, for TDDFT calculation, one can
compare IN.OCC=T,3 calculation with IN.OCC_T=T calculation. In IN.OCC_T,
the occupation of each state o(j) can be changed with time, specified
inside IN.OCC_T. That is a powerful tool to actually change the
occupation (e.g., to describe one electron gradually disappear due to
some other physical process). It can also be used to prepare the initial
state in a TDDFT calculation, e.g, quickly remove one state. But this is
less general than IN.OCC=T,3, it can also has some stability issues.
Also note, if one very quickly remove one electron through IN.OCC_T, the
physical meaning might be different from the initial condition propered
using IN.OCC=T,0. In IN.OCC=T,0, the initial condition is in a
equilibirium condition, but that is not the case for IN.OCC_T
calculation.</p>
<p>Lastly, one can also compare IN.OCC=T,3 with IN.CC. IN.CC can also be
used to prepare a mixing state as the initial state for TDDFT
calculation. It is easy to construc the initial wave function, but it is
less general, and less powerful than the IN.OCC=T,3 procedure.</p>
</div>
<div class="section" id="in-wg">
<h3>IN.WG<a class="headerlink" href="#in-wg" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.WG = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.WG = F</strong></p>
<p>IN.WG = T, PWmat will read in the initial wave functions in G-space from
the file “IN.WG” (e.g., from previous calculation, copied over from
OUT.WG, ). When SPIN = 2, an extra file “IN.WG_2” will also be read in.
Note, IN.WG, OUT.WG can be plotted using utility program “plot_wg.x”,
which can be used to view each wave function. For people like to see the
format of IN.WG, OUT.WG, one can check the plot_wg.f90 file which is
source code of “plot_wg.x” utility program. If IN.WG = F, the PWmat will
start from random wave function.</p>
</div>
<div class="section" id="in-rho">
<h3>IN.RHO<a class="headerlink" href="#in-rho" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.RHO = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.RHO = F</strong></p>
<p>IN.RHO = T, PWmat will read in the initial charge density from file
“IN.RHO”, stored in the real space grid (N1L, N2L, N3L). This can be
copied over from OUT.RHO of previous calculation. Note, the node1 in
current calculation, and previous calculation to generation OUT.RHO must
dividable from one way or the other. Note, if both IN.VR and IN.RHO are
set to T, the program will use the read-in potential to start the
calculation. If SPIN = 2, PWmat will read an extra file “IN.RHO_2”.
IN.RHO=T is also needed for JOB=POTENTIAL. If SPIN = 22, only a single
IN.RHO will be needed. If SPIN = 222, besides IN.RHO, a IN.RHO_SOM (a
complex 2x2 spin matrix density) will be needed. If IN.RHO = F, not
input the charge density.</p>
<p>One can use utility program: convert_rho.x to plot OUT.RHO or IN.RHO.
One can also check convert_rho.f90 for the format of IN.RHO, OUT.RHO.</p>
</div>
<div class="section" id="in-vr">
<h3>IN.VR<a class="headerlink" href="#in-vr" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.VR = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.VR = F</strong></p>
<p>IN.VR = T, PWmat will read in the initial potential from file “IN.VR” in
real space grid: (N1L, N2L, N3L). Note, if both IN.VR and IN.RHO are set
to T, the program will use the read-in potential to start the
calculation. The format, and requirement of IN.VR are the same as that
for IN.RHO. When SPIN=2, an extra file “IN.VR_2” will also be read. When
SPIN=22, just a single IN.VR will be read (no IN.VR_2). When SPIN=222,
besides IN.VR, IN.VR_SOM (complex 2x2 spin matrix potential), and
IN.VR_DELTA (a single real up-down potential) need to be read in. If
IN.VR = F, not read in the file.</p>
</div>
<div class="section" id="in-ldau">
<h3>IN.LDAU<a class="headerlink" href="#in-ldau" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.LDAU = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.LDAU = F</strong></p>
<p>This is mostly for LDA+U JOB=NONSCF calculation. But for JOB=SCF
calculation, and for a continued run, this can also be used (together
with IN.WG and IN.RHO) to input the initial LDAU occupation number, so a
smooth continue run can be carried out. PWmat will read in the
initialization of LDA+U from file “IN.LDAU” (Note this is not the U
parameters, instead they are the LDA+U occupation values calculated from
JOB=SCF calculation). This setting is only required when JOB=NONSCF. One
needs to copy OUT.LDAU to IN.LDAU after the JOB=SCF. If SPIN = 2, PWmat
will read an extra file “IN.LDAU_2”, also there will be OUT.LDAU_2 after
JOB=SCF. If IN.LDAU = F, not input the initialization of LDA+U.</p>
</div>
<div class="section" id="in-vext">
<h3>IN.VEXT<a class="headerlink" href="#in-vext" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.VEXT = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.VEXT = F</strong></p>
<p>IN.VEXT = T, PWmat will read in an external potential from file
“IN.VEXT” in real space grid (N1L, N2L, N3L). Both the total energy and
forces are calculated using this external potential. This can be useful
to calculate the influence of an external potential (e.g., an electric
field), for JOB=SCF, RELAX or MD. Note, the IN.VEXT has the same format
as that in IN.RHO and IN.VR. Its unit is Hartree. One can try (and
check, modify) the utility programs: calculate_Vext.f90 and
gen_external_efield.f90 to generate such IN.VEXT. One can also write
such IN.VEXT by self-made codes. If IN.VEXT = F, no external potential
is used.</p>
</div>
<div class="section" id="in-rho-add">
<h3>IN.RHO_ADD<a class="headerlink" href="#in-rho-add" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.RHO_ADD = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.RHO_ADD = F</strong></p>
<p>IN.RHO_ADD = T, PWmat will read in an additional charge density
<span class="math notranslate nohighlight">\(\rho_{add}\)</span> from input file: IN.RHO_ADD, and this
<span class="math notranslate nohighlight">\(\rho_{add}\)</span> will be added to the total charge density calculated
from the wave functions. In another word,
<span class="math notranslate nohighlight">\(\rho(i)=\sum_i |\psi_i(r)|^2 occ(i) + \rho_{add}(r)\)</span>. Note, this
<span class="math notranslate nohighlight">\(\rho_{add}\)</span> will not be counted as part of NUM_ELECTRON when
determing <span class="math notranslate nohighlight">\(occ(i)\)</span>. This function can be used for many different
algorithms. In particular, JOB=SCFEP is one particular case of this (but
please continue to use JOB=SCFEP). Note, one can use the utility file:
convert_wg2rho.f to general IN.RHO_ADD file from the output wave
function file OUT.WG. When spin=2, one also needs to provide an
IN.RHO_ADD_2 file for spin down additional charge density. If IN.RHO_ADD
= F, no additional charge density is used.</p>
</div>
<div class="section" id="in-symm">
<h3>IN.SYMM<a class="headerlink" href="#in-symm" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.SYMM = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.SYMM = F</strong></p>
<p>IN.SYMM = T, PWmat will use the file “IN.SYMM” (the name is fixed) to
perform symmetry operations. The PWmat supports space group symmetry for
crystals. “IN.SYMM” should contain space group symmetry operations.
Usually, symmetry can be generated automatically by using MP_N123 line.
However, one can also copy over the previous OUT.SYMM into IN.SYMM for
explicit input (e.g., one can even delete some symmetry operations). The
IN.SYMM usually should work together with IN.KPT (for the reduced
k-points). Note, if both IN.SYMM=T, IN.KPT=F are specified, and also
MP_N123 are also specified, PWmat will generate Kpoints using the
symmetry operations provided in file “IN.SYMM”. If IN.SYMM=T, IN.KPT=T
and also MP_N123 are also specified, the IN.KPT=T has a higher priority,
MP_N123 will not be used. If IN.SYMM = F, PWmat will not use file
“IN.SYMM”, This is the default value. PWmat will always output symmetry
operations in “OUT.SYMM” file. Please check the IN.SYMM(OUT.SYMM)
subsession for more detail format about this file.</p>
</div>
<div class="section" id="in-kpt">
<h3>IN.KPT<a class="headerlink" href="#in-kpt" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.KPT = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.KPT = F</strong></p>
<p>IN.KPT = T, PWmat will use the k-points from file “IN.KPT” which
contains the k-points and their weights. Note, IN.KPT, IN.SYMM usually
work together. IN.KPT has a higher priority than MP_N123. If IN.KPT = F,
PWmat will not use the file “IN.KPT”. PWmat will always output koints in
“OUT.KPT” file. Please check the IN.KPT(OUT.KPT) subsession for more
detail format about this file.</p>
</div>
<div class="section" id="in-mdopt">
<h3>IN.MDOPT<a class="headerlink" href="#in-mdopt" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.MDOPT= T / F</strong></p>
<p>Default:</p>
<p><strong>IN.MDOPT = F</strong></p>
<p>This parameter is used to set optional MD parameter in file IN.MDOPT.</p>
<p>If the method of MD is 2,3,4 or 5, one can use the file IN.MDOPT to set
detailed parameters by setting IN.MDOPT=T. See more in MD_DETAIL.</p>
</div>
<div class="section" id="in-ext-force">
<h3>IN.EXT_FORCE<a class="headerlink" href="#in-ext-force" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.EXT_FORCE= T / F</strong></p>
<p>Default:</p>
<p><strong>IN.EXT_FORCE = F</strong></p>
<p>This parameter is used to provide an external force (unit eV/amstrong)
for each atom during MD simulation. See more in MD_DETAIL. If
IN.EXT_FORCE=T, a file IN.EXT_FORCE will be provided, it has the
following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>natom
iatom, fx, fy, fz    ! unit eV/Amstrong
.................
iatom, fx, fy, fz    ! There will be natom lines
</pre></div>
</div>
</div>
</div>
<div class="section" id="in-a-field">
<h3>IN.A_FIELD<a class="headerlink" href="#in-a-field" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.A_FIELD= T / F, a_field1, a_field2, a_field3</strong></p>
<p>Default:</p>
<p><strong>IN.A_FIELD= F 0.0 0.0 0.0</strong></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>IN.A_FIELD_LIST1= a_field1, a_field2, a_field3 IN.TDDFT_TIME1</strong></div>
<div class="line"><strong>IN.A_FIELD_LIST2= a_field1, a_field2, a_field3 IN.TDDFT_TIME2</strong></div>
<div class="line">…</div>
<div class="line">the maximum support is 20 rows. This can be used to add a circularly
polarized light.</div>
<div class="line">IN.TDDFT_TIME1,IN.TDDFT_TIME2… is the name of TDDFT_TIME file. You
need to prepare same number of TDDFT_TIME files, it has the same
format as IN.TDDFT_TIME,</div>
</div>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="mi">1</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">...</span>
        <span class="n">N</span> <span class="n">ftddft</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This controls the G-sapce external potential input for tddft
calculation. (only used when TDDFT_SPACE=-1,…)</p>
<p>The tddft hamiltonian,</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
H=1/2 (-i\nabla_x + a\_field1)^2+1/2(-i\nabla_y+ a\_field2)^2+1/2(-i\nabla_z + a\_field3)^2
    \end{aligned}\]</div>
<p>The values of <span class="math notranslate nohighlight">\(a\_field1,2,3\)</span> are all in units of 1/Bohr.</p>
</div>
<div class="section" id="in-psp-rcut1-2">
<h3>IN.PSP_RCUT1,2<a class="headerlink" href="#in-psp-rcut1-2" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.PSP_RCUT1 = rcut1</strong></p>
<p><strong>IN.PSP_RCUT2 = rcut2</strong></p>
<p>…</p>
<p><strong>IN.PSP_RCUTi = rcuti</strong></p>
<p>The Rcut of each element type. The IN.PSP_RCUTi are in the unit of Bohr,
not Amgstron. This provides a way to selectively choose the Rcut for
different atoms for the nonlocal pseudopotentials.</p>
<p>If the IN.PSP_RCUTi are not specified, the value of IN.PSP_RCUTi is
taken from the pseudopotential file from its “Rcut” value. If these
IN.PSP_RCUTi are not provided in the pseudopotential file, the default
value will be set to 3.5. Note, to get a smooth force and energy (e.g.,
for good RELAX convergence), sufficiently large rcuti should be used
(e.g., 4.0 Bohr). However, if Ecut2 is very large, then a slightly
smaller rcuti can be used.</p>
</div>
<div class="section" id="rcut">
<h3>RCUT<a class="headerlink" href="#rcut" title="Permalink to this headline">¶</a></h3>
<p><strong>RCUT = value</strong></p>
<p>Default:</p>
<p><strong>RCUT = max[IN.PSP_RCUT1, IN.PSP_RCUT2, …, IN.PSP_RCUTi]</strong></p>
<p>The RCUT (in <span class="math notranslate nohighlight">\(Bohr\)</span> unit, note:
<span class="math notranslate nohighlight">\(1 Bohr = 0.529177 \times 10^{-10} m\)</span>) is for the cut off radius
for nonlocal pseudopotential implementations. It defines the core radius
of the nonlocal part. If RCUT is not specified, PWmat will use the
maximum of IN.PSP_RCUTi as the value of Rcut.</p>
</div>
<div class="section" id="ldau-rcut-psp1-2">
<h3>LDAU_RCUT_PSP1,2<a class="headerlink" href="#ldau-rcut-psp1-2" title="Permalink to this headline">¶</a></h3>
<p><strong>LDAU_RCUT_PSP1= rcutu1</strong></p>
<p><strong>LDAU_RCUT_PSP1= rcutu2</strong></p>
<p>The Rcut of each element type for the LDA+U calculation for the atomic
wave function orbital. The unit is in Bohr, not Amgstron. This is like
the IN.PSP_RCUTi, but instead of for the nonlocal projector, it is for
the full atomic wave function used for LDA+U calculation. Note, usually,
these rcutui should be bigger than rcuti. If no explicit input for
LDAU_RCUT_PSPi is provided, the default value of 6 Bohr is used (which
is rather large). Note, for LDA+U calculation, it might be necessary to
use a large rcutui, e.g., 6, to get a fully converged and smooth force
(e.g., for better RELAX convergence). However, if Ecut2 is very large,
then a slightly smaller rcuti can be used.</p>
</div>
<div class="section" id="in-solvent">
<h3>IN.SOLVENT<a class="headerlink" href="#in-solvent" title="Permalink to this headline">¶</a></h3>
<p><strong>IN.SOLVENT = T / F</strong></p>
<p>Default:</p>
<p><strong>IN.SOLVENT = F</strong></p>
<p>When calculating the energy of a solute molecule in a liquid solvent,
e.g., in electric chemistry study, there are two possible approaches.
One is to use explicit solvent molecule (e.g., water molecules) and
carry out molecular dynamics simulations, another is to use implicit
solvent models. The implicit solvent model represents the effect of the
solvent with a continuum mediate, mostly includes its effects of
electric static polarization. Compared with the explicit solvent
molecules and molecular dynamics, the implicit solvent model is much
faster. We have followed the work of self-consistent continuum solvation
(SCCS) model <a href="#id373"><span class="problematic" id="id374">:raw-latex:`\cite{solvent1}`</span></a>, as well as similar formalism
in Ref.:raw-latex:<cite>cite{solvent2}</cite>. In quantum chemistry, this is also
called: polarizable continuum model (PCM). We have also implemented the
linearized Poisson-Boltzmann screening for the effects of free ions
(salt, or H+, OH- in low or high pH value situations)
<a href="#id375"><span class="problematic" id="id376">:raw-latex:`\cite{solvent3}`</span></a>. These models use a continuum mediate and a
space variation dielectric constanr <span class="math notranslate nohighlight">\(\epsilon(r)\)</span> to represent the
solvation effects, mostly the polarization effects. There are three
energy terms: the polarization solvation energy, the cavity energy (the
surface tension, or can also be considered as surface van der Waals
energy), and volume energy (pressure energy, PV). If Poisson-Boltzmann
equation is used to describe the ion screening, there is another term
which describes the ion energy within an electric static potential. When
the Poisson-Boltzmann equation is used, the absoulte potential zero is
defined at the far away place (there is no ambiguity of the absolute
potential position). This also allows us to define the absolute
potential of the electrode (for example, the standard hydrogen electrod,
SHE, potential in water is at -4.42 eV). In this situation, we can use a
fixed potential (fixed Fermi energy calculation). This is controlled
using Fix_Fermi = T in etot.input (please see the corresponding item in
the manual.</p>
<p><strong>IN.SOLVENT = T</strong>, will use solvent model. Note, all the other input in
etot.input will be the same. In other words, solvent model can be used
to do single SCF, RELAX, MD and TDDFT calculations. However, one has to
prepare a “IN.SOLVENT” file in the running directory, which control the
parameters for the solvent model. When IN.SOLVENT=T, after the PWmat
run, a OUT.SOLVENT file will be generated which lists all the options
used for the solvent model. The “IN.SOLVENT” has the following contents:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">DIELECTRIC_CONST = epsilon0</div>
<div class="line"><a href="#id377"><span class="problematic" id="id378">``</span></a><a href="#id379"><span class="problematic" id="id380">``</span></a>! epsilon0 is a real number: the dielectric</div>
<div class="line"><a href="#id381"><span class="problematic" id="id382">``</span></a><a href="#id383"><span class="problematic" id="id384">``</span></a>! constant of the solvent.</div>
<div class="line">SURFACE_TENSION = sigma</div>
<div class="line"><a href="#id385"><span class="problematic" id="id386">``</span></a><a href="#id387"><span class="problematic" id="id388">``</span></a>! sigma is the surface energy <span class="math notranslate nohighlight">\(dyn/cm\)</span> of the cavity.</div>
<div class="line"><a href="#id389"><span class="problematic" id="id390">``</span></a><a href="#id391"><span class="problematic" id="id392">``</span></a>! positive/negative sigma (default 50 for water) means it
will have</div>
<div class="line"><a href="#id393"><span class="problematic" id="id394">``</span></a><a href="#id395"><span class="problematic" id="id396">``</span></a>! postive/negative surface energy. Can be used to represent</div>
<div class="line"><a href="#id397"><span class="problematic" id="id398">``</span></a><a href="#id399"><span class="problematic" id="id400">``</span></a>! the solute/solvent van der Walls interaction.</div>
<div class="line"><a href="#id401"><span class="problematic" id="id402">``</span></a><a href="#id403"><span class="problematic" id="id404">``</span></a>! Can be used as a fitting parameter.</div>
<div class="line">RHOMAX_DIELECTRIC = cut1</div>
<div class="line"><a href="#id405"><span class="problematic" id="id406">``</span></a><a href="#id407"><span class="problematic" id="id408">``</span></a>! default, 0.005 (<span class="math notranslate nohighlight">\(electron/Bohr^3\)</span>), used to control</div>
<div class="line"><a href="#id409"><span class="problematic" id="id410">``</span></a><a href="#id411"><span class="problematic" id="id412">``</span></a>! epsilon(rho_e). When rho_e <span class="math notranslate nohighlight">\(&gt;\)</span> RHOMAX_DIELECTRIC,
epsilon=1</div>
<div class="line">RHOMIN_DIELECTRIC = cut2</div>
<div class="line"><a href="#id413"><span class="problematic" id="id414">``</span></a><a href="#id415"><span class="problematic" id="id416">``</span></a>! default, 0.0001, used to control epsilon(rho_e).</div>
<div class="line"><a href="#id417"><span class="problematic" id="id418">``</span></a><a href="#id419"><span class="problematic" id="id420">``</span></a>! When rho_e <span class="math notranslate nohighlight">\(&lt;\)</span> RHOMIN_DIELECTRIC,</div>
<div class="line"><a href="#id421"><span class="problematic" id="id422">``</span></a><a href="#id423"><span class="problematic" id="id424">``</span></a>! epsilon=epslion0 input above.</div>
<div class="line"><a href="#id425"><span class="problematic" id="id426">``</span></a><a href="#id427"><span class="problematic" id="id428">``</span></a>! Basically, the dielectric constant changes from 1 to
epsilon0</div>
<div class="line"><a href="#id429"><span class="problematic" id="id430">``</span></a><a href="#id431"><span class="problematic" id="id432">``</span></a>! when rho_e changes from cut1 to cut2.</div>
<div class="line"><a href="#id433"><span class="problematic" id="id434">``</span></a><a href="#id435"><span class="problematic" id="id436">``</span></a>! The choice of rho_e will be controlled by DIELECTRIC_MODEL
below.</div>
<div class="line">DIELECTRIC_MODEL = SCF_CHARGE / ATOM_CHARGE / EXP_CHARGE /</div>
<div class="line"><a href="#id437"><span class="problematic" id="id438">``</span></a><a href="#id439"><span class="problematic" id="id440">``</span></a>AEXP_CHARGE</div>
<div class="line"><a href="#id441"><span class="problematic" id="id442">``</span></a><a href="#id443"><span class="problematic" id="id444">``</span></a>! The parameter controls what to be used as the rho_e</div>
<div class="line"><a href="#id445"><span class="problematic" id="id446">``</span></a><a href="#id447"><span class="problematic" id="id448">``</span></a>! (together with cut1 and cut2) to control the dielectric
function profile.</div>
<div class="line"><a href="#id449"><span class="problematic" id="id450">``</span></a><a href="#id451"><span class="problematic" id="id452">``</span></a>! SCF_CHARGE: use the SCF calculated electron charge density
(default)</div>
<div class="line"><a href="#id453"><span class="problematic" id="id454">``</span></a><a href="#id455"><span class="problematic" id="id456">``</span></a>! ATOM_CHARGE: use the sum of neutral atomic charge density
from upf file</div>
<div class="line"><a href="#id457"><span class="problematic" id="id458">``</span></a><a href="#id459"><span class="problematic" id="id460">``</span></a>! (each atom multiplied by a prefactor param1).</div>
<div class="line"><a href="#id461"><span class="problematic" id="id462">``</span></a><a href="#id463"><span class="problematic" id="id464">``</span></a>! WE recommend this option for most calculations due to
stability</div>
<div class="line"><a href="#id465"><span class="problematic" id="id466">``</span></a><a href="#id467"><span class="problematic" id="id468">``</span></a>! EXP_CHARGE: for each atom, use an exponential</div>
<div class="line"><a href="#id469"><span class="problematic" id="id470">``</span></a><a href="#id471"><span class="problematic" id="id472">``</span></a>! param2*exp(-r/param3) form.</div>
<div class="line"><a href="#id473"><span class="problematic" id="id474">``</span></a><a href="#id475"><span class="problematic" id="id476">``</span></a>! AEXP_CHARGE: use the sum of neutral atomic charge</div>
<div class="line"><a href="#id477"><span class="problematic" id="id478">``</span></a><a href="#id479"><span class="problematic" id="id480">``</span></a>! and the exponential charge,</div>
<div class="line"><a href="#id481"><span class="problematic" id="id482">``</span></a><a href="#id483"><span class="problematic" id="id484">``</span></a>! equals: param1*rho_atom(r)+param2*exp(-r/param3)</div>
<div class="line"><a href="#id485"><span class="problematic" id="id486">``</span></a><a href="#id487"><span class="problematic" id="id488">``</span></a>! Note, for stability, especially for JOB=RELAX, we suggest
to use</div>
<div class="line"><a href="#id489"><span class="problematic" id="id490">``</span></a><a href="#id491"><span class="problematic" id="id492">``</span></a>! ATOM_CHARGE, EXP_CHARGE, or AEXP_CHARGE.</div>
<div class="line"><a href="#id493"><span class="problematic" id="id494">``</span></a><a href="#id495"><span class="problematic" id="id496">``</span></a>! There is not much benefit to use SCF charge density.</div>
<div class="line"><a href="#id497"><span class="problematic" id="id498">``</span></a><a href="#id499"><span class="problematic" id="id500">``</span></a>! AEXP_CHARGE is used to fill the possible hole at r=0 for
ATOM_CHARGE.</div>
<div class="line"><a href="#id501"><span class="problematic" id="id502">``</span></a><a href="#id503"><span class="problematic" id="id504">``</span></a>! If ATOM_CHARGE is used, the program will output an
atom.UPF.rhoatom</div>
<div class="line"><a href="#id505"><span class="problematic" id="id506">``</span></a><a href="#id507"><span class="problematic" id="id508">``</span></a>! file for each atom, which has: r,rho(r)
(Bohr,electron/<span class="math notranslate nohighlight">\(Bohr^3\)</span>).</div>
<div class="line"><a href="#id509"><span class="problematic" id="id510">``</span></a><a href="#id511"><span class="problematic" id="id512">``</span></a>! One can use these files to fit the param2,param3</div>
<div class="line"><a href="#id513"><span class="problematic" id="id514">``</span></a><a href="#id515"><span class="problematic" id="id516">``</span></a>! thus to use EXP_CHARGE to replace ATOM_CHARGE</div>
<div class="line"><a href="#id517"><span class="problematic" id="id518">``</span></a><a href="#id519"><span class="problematic" id="id520">``</span></a>! (if one wants to do that).</div>
<div class="line"><a href="#id521"><span class="problematic" id="id522">``</span></a><a href="#id523"><span class="problematic" id="id524">``</span></a>! Or to find the proper param2,param3 for AEXP_CHARGE.</div>
<div class="line"><a href="#id525"><span class="problematic" id="id526">``</span></a><a href="#id527"><span class="problematic" id="id528">``</span></a>! One can also use that to find out</div>
<div class="line"><a href="#id529"><span class="problematic" id="id530">``</span></a><a href="#id531"><span class="problematic" id="id532">``</span></a>! whether the RHOMAX_DIELECTRIC value will put some
dielectric</div>
<div class="line"><a href="#id533"><span class="problematic" id="id534">``</span></a><a href="#id535"><span class="problematic" id="id536">``</span></a>! constant at r=0., i.e., whether RHOMAX_DIELECTRIC is
larger</div>
<div class="line"><a href="#id537"><span class="problematic" id="id538">``</span></a><a href="#id539"><span class="problematic" id="id540">``</span></a>! than rho_atom(r) at r=0 (which is bad,</div>
<div class="line"><a href="#id541"><span class="problematic" id="id542">``</span></a><a href="#id543"><span class="problematic" id="id544">``</span></a>! then AEXP_CHARGE or EXP_CHARGE are better to be used).</div>
<div class="line">PARAM_CHARGE.1 = param1,param2,param3</div>
<div class="line">PARAM_CHARGE.2 = param1,param2,param3</div>
<div class="line"><a href="#id545"><span class="problematic" id="id546">``</span></a><a href="#id547"><span class="problematic" id="id548">``</span></a>! The number, 1,2,.. must be the same as the atom types</div>
<div class="line"><a href="#id549"><span class="problematic" id="id550">``</span></a><a href="#id551"><span class="problematic" id="id552">``</span></a>! the pseudopotential types. There must always be three</div>
<div class="line"><a href="#id553"><span class="problematic" id="id554">``</span></a><a href="#id555"><span class="problematic" id="id556">``</span></a>! numbers for each line, even if some are not used.</div>
<div class="line"><a href="#id557"><span class="problematic" id="id558">``</span></a><a href="#id559"><span class="problematic" id="id560">``</span></a>! These parameters are used to control the charge</div>
<div class="line"><a href="#id561"><span class="problematic" id="id562">``</span></a><a href="#id563"><span class="problematic" id="id564">``</span></a>! expression for ATOM_CHARGE,</div>
<div class="line"><a href="#id565"><span class="problematic" id="id566">``</span></a><a href="#id567"><span class="problematic" id="id568">``</span></a>! EXP_CHARGE, and AEXP_CHARGE. Param1 is a prefactor</div>
<div class="line"><a href="#id569"><span class="problematic" id="id570">``</span></a><a href="#id571"><span class="problematic" id="id572">``</span></a>! for ATOM_CHARGE.</div>
<div class="line"><a href="#id573"><span class="problematic" id="id574">``</span></a><a href="#id575"><span class="problematic" id="id576">``</span></a>! For the exponential charge, it is:
<span class="math notranslate nohighlight">\(param2*exp(-r/param3)\)</span>.</div>
<div class="line"><a href="#id577"><span class="problematic" id="id578">``</span></a><a href="#id579"><span class="problematic" id="id580">``</span></a>! Here param2 unit is electron/<span class="math notranslate nohighlight">\(Bohr^3\)</span>, and param3
unit is Bohr.</div>
<div class="line">RHOMAX_CAVITY = cut11</div>
<div class="line"><a href="#id581"><span class="problematic" id="id582">``</span></a><a href="#id583"><span class="problematic" id="id584">``</span></a>! default, 0.005 (<span class="math notranslate nohighlight">\(electron/Bohr^3\)</span>), used to control</div>
<div class="line"><a href="#id585"><span class="problematic" id="id586">``</span></a><a href="#id587"><span class="problematic" id="id588">``</span></a>! the cavity of the solute molecule.</div>
<div class="line">RHOMIN_CAVITY = cut22</div>
<div class="line"><a href="#id589"><span class="problematic" id="id590">``</span></a><a href="#id591"><span class="problematic" id="id592">``</span></a>! default, 0.0001, used to control the cavity</div>
<div class="line"><a href="#id593"><span class="problematic" id="id594">``</span></a><a href="#id595"><span class="problematic" id="id596">``</span></a>! of the solute molecule. The cavity is created inside</div>
<div class="line"><a href="#id597"><span class="problematic" id="id598">``</span></a><a href="#id599"><span class="problematic" id="id600">``</span></a>! cut11 (when rho <span class="math notranslate nohighlight">\(&gt;\)</span> cut11). The thickness of the
surface</div>
<div class="line"><a href="#id601"><span class="problematic" id="id602">``</span></a><a href="#id603"><span class="problematic" id="id604">``</span></a>! is controlled by cut11 to cut22 (the cavity disappears</div>
<div class="line"><a href="#id605"><span class="problematic" id="id606">``</span></a><a href="#id607"><span class="problematic" id="id608">``</span></a>! for rho <span class="math notranslate nohighlight">\(&lt;\)</span> cut22. Note, the cavity is always judged
by the</div>
<div class="line"><a href="#id609"><span class="problematic" id="id610">``</span></a><a href="#id611"><span class="problematic" id="id612">``</span></a>! SCF calculated valence electron charge density.</div>
<div class="line"><a href="#id613"><span class="problematic" id="id614">``</span></a><a href="#id615"><span class="problematic" id="id616">``</span></a>! Also, the cavity for the cavity and pressure term can be
different</div>
<div class="line"><a href="#id617"><span class="problematic" id="id618">``</span></a><a href="#id619"><span class="problematic" id="id620">``</span></a>! from the effective cavity of the dielectric function.</div>
<div class="line">POISSON_BOLTZMANN = T/F</div>
<div class="line"><a href="#id621"><span class="problematic" id="id622">``</span></a><a href="#id623"><span class="problematic" id="id624">``</span></a>! Used to control whether to do linearized Poisson-Boltzmann
equation.</div>
<div class="line"><a href="#id625"><span class="problematic" id="id626">``</span></a><a href="#id627"><span class="problematic" id="id628">``</span></a>! If true, we need the following parameter: RHOMAX_DEBY,
RHOMIN_DEBY,</div>
<div class="line"><a href="#id629"><span class="problematic" id="id630">``</span></a><a href="#id631"><span class="problematic" id="id632">``</span></a>! AKK0_DEBY. DEBY_AKK0 = <span class="math notranslate nohighlight">\(akk_0\)</span></div>
<div class="line"><a href="#id633"><span class="problematic" id="id634">``</span></a><a href="#id635"><span class="problematic" id="id636">``</span></a>! the inverse deby length square in the linearized</div>
<div class="line"><a href="#id637"><span class="problematic" id="id638">``</span></a><a href="#id639"><span class="problematic" id="id640">``</span></a>! Poisson-Boltmann equation. Unit: <span class="math notranslate nohighlight">\(1/Bhor^2\)</span>,</div>
<div class="line"><a href="#id641"><span class="problematic" id="id642">``</span></a><a href="#id643"><span class="problematic" id="id644">``</span></a>! default 0. Note,
<span class="math notranslate nohighlight">\(akk_0=akk_b^2=e^2*\sum_i N_i Z_i^2/kT/epsilon(0)\)</span>.</div>
<div class="line"><a href="#id645"><span class="problematic" id="id646">``</span></a><a href="#id647"><span class="problematic" id="id648">``</span></a>! Here, <span class="math notranslate nohighlight">\(N_i\)</span> is the concentration of the free</div>
<div class="line"><a href="#id649"><span class="problematic" id="id650">``</span></a><a href="#id651"><span class="problematic" id="id652">``</span></a>! ion i in the solvent, and <span class="math notranslate nohighlight">\(Z_i\)</span> is the free ion</div>
<div class="line"><a href="#id653"><span class="problematic" id="id654">``</span></a><a href="#id655"><span class="problematic" id="id656">``</span></a>! charge, and <span class="math notranslate nohighlight">\(kT\)</span> are the</div>
<div class="line"><a href="#id657"><span class="problematic" id="id658">``</span></a><a href="#id659"><span class="problematic" id="id660">``</span></a>! temperature energy. For example, at room</div>
<div class="line"><a href="#id661"><span class="problematic" id="id662">``</span></a><a href="#id663"><span class="problematic" id="id664">``</span></a>! temperature, in water with epsilon0=80, when</div>
<div class="line"><a href="#id665"><span class="problematic" id="id666">``</span></a><a href="#id667"><span class="problematic" id="id668">``</span></a>! ion concentration is 0.1<span class="math notranslate nohighlight">\(Mol\)</span>,
<span class="math notranslate nohighlight">\(akk_0=0.036/Bohr^2\)</span>.</div>
<div class="line"><a href="#id669"><span class="problematic" id="id670">``</span></a><a href="#id671"><span class="problematic" id="id672">``</span></a>! Large <span class="math notranslate nohighlight">\(akk_0\)</span>, there will be strongly ionic
screening.</div>
<div class="line"><a href="#id673"><span class="problematic" id="id674">``</span></a><a href="#id675"><span class="problematic" id="id676">``</span></a>! Small value corresponds to weaker (longer length)</div>
<div class="line"><a href="#id677"><span class="problematic" id="id678">``</span></a><a href="#id679"><span class="problematic" id="id680">``</span></a>! screening. Note, when <span class="math notranslate nohighlight">\(akk_0=0\)</span>, there will be no</div>
<div class="line"><a href="#id681"><span class="problematic" id="id682">``</span></a><a href="#id683"><span class="problematic" id="id684">``</span></a>! Poisson-Boltzmann equation. When <span class="math notranslate nohighlight">\(akk_0&gt;0\)</span>, there</div>
<div class="line"><a href="#id685"><span class="problematic" id="id686">``</span></a><a href="#id687"><span class="problematic" id="id688">``</span></a>! will be Poisson_Boltzmann equation:</div>
<div class="line"><a href="#id689"><span class="problematic" id="id690">``</span></a><a href="#id691"><span class="problematic" id="id692">``</span></a>!
<span class="math notranslate nohighlight">\(\nabla [\epsilon(r)\nabla\phi(r)]-\epsilon_0*k^2(r)\phi(r)=-4\pi (rho_{solute}-rho_{ion})\)</span></div>
<div class="line"><a href="#id693"><span class="problematic" id="id694">``</span></a><a href="#id695"><span class="problematic" id="id696">``</span></a>! RHOMAX_DEBY = cut111 default, 0.005, used</div>
<div class="line"><a href="#id697"><span class="problematic" id="id698">``</span></a><a href="#id699"><span class="problematic" id="id700">``</span></a>! to control the turn on of <span class="math notranslate nohighlight">\(k^2(r)\)</span> in the</div>
<div class="line"><a href="#id701"><span class="problematic" id="id702">``</span></a><a href="#id703"><span class="problematic" id="id704">``</span></a>! Poisson-Boltzmann equation. When rho_e <span class="math notranslate nohighlight">\(&gt;\)</span> cut111,</div>
<div class="line"><a href="#id705"><span class="problematic" id="id706">``</span></a><a href="#id707"><span class="problematic" id="id708">``</span></a>! <span class="math notranslate nohighlight">\(k^2(r)=0\)</span>.</div>
<div class="line">RHOMAX_DEBY = cut111</div>
<div class="line"><a href="#id709"><span class="problematic" id="id710">``</span></a><a href="#id711"><span class="problematic" id="id712">``</span></a>! default, 0.005 (<span class="math notranslate nohighlight">\(electron/Bohr^3\)</span>).</div>
<div class="line">RHOMIN_DEBY = cut222</div>
<div class="line"><a href="#id713"><span class="problematic" id="id714">``</span></a><a href="#id715"><span class="problematic" id="id716">``</span></a>! default, 0.0001. cut111,and cut222 are used to control the
turn</div>
<div class="line"><a href="#id717"><span class="problematic" id="id718">``</span></a><a href="#id719"><span class="problematic" id="id720">``</span></a>! on of <span class="math notranslate nohighlight">\(k^2(r)\)</span> in the Poisson-Boltzmann equation.</div>
<div class="line"><a href="#id721"><span class="problematic" id="id722">``</span></a><a href="#id723"><span class="problematic" id="id724">``</span></a>! When rho_e <span class="math notranslate nohighlight">\(&lt;\)</span> cut222, <span class="math notranslate nohighlight">\(k^2(r)=akk_0\)</span></div>
<div class="line"><a href="#id725"><span class="problematic" id="id726">``</span></a><a href="#id727"><span class="problematic" id="id728">``</span></a>! If one likes to put the free ion screening</div>
<div class="line"><a href="#id729"><span class="problematic" id="id730">``</span></a><a href="#id731"><span class="problematic" id="id732">``</span></a>! effects further away from the surface or</div>
<div class="line"><a href="#id733"><span class="problematic" id="id734">``</span></a><a href="#id735"><span class="problematic" id="id736">``</span></a>! solute molecule, we can set RHOMAX_DEBY,</div>
<div class="line"><a href="#id737"><span class="problematic" id="id738">``</span></a><a href="#id739"><span class="problematic" id="id740">``</span></a>! RHOMIN_DEBY smaller than RHOMAX_DIELECTRIC,</div>
<div class="line"><a href="#id741"><span class="problematic" id="id742">``</span></a><a href="#id743"><span class="problematic" id="id744">``</span></a>! RHOMIN_DIELETRIC.</div>
<div class="line"><a href="#id745"><span class="problematic" id="id746">``</span></a><a href="#id747"><span class="problematic" id="id748">``</span></a>! Note, here rho_e as described by DIELECTRIC_MODEL is used.</div>
<div class="line">POISSON_MIX_SCHEME = LINEAR/PULAY (must be all capital)</div>
<div class="line"><a href="#id749"><span class="problematic" id="id750">``</span></a><a href="#id751"><span class="problematic" id="id752">``</span></a>! The default is LINEAR. This is used to control which
scheme</div>
<div class="line"><a href="#id753"><span class="problematic" id="id754">``</span></a><a href="#id755"><span class="problematic" id="id756">``</span></a>! is used to solve the Poisson equation with a spatially
variation</div>
<div class="line"><a href="#id757"><span class="problematic" id="id758">``</span></a><a href="#id759"><span class="problematic" id="id760">``</span></a>! dielectric function. We have used an iterative scheme,
which</div>
<div class="line"><a href="#id761"><span class="problematic" id="id762">``</span></a><a href="#id763"><span class="problematic" id="id764">``</span></a>! generates a polarization charge, and mix the polarization
charge</div>
<div class="line"><a href="#id765"><span class="problematic" id="id766">``</span></a><a href="#id767"><span class="problematic" id="id768">``</span></a>! with previous steps. LINEAR, PULAY mixing schemes</div>
<div class="line"><a href="#id769"><span class="problematic" id="id770">``</span></a><a href="#id771"><span class="problematic" id="id772">``</span></a>! can be used. But unless the iteration does not converge,
one</div>
<div class="line"><a href="#id773"><span class="problematic" id="id774">``</span></a><a href="#id775"><span class="problematic" id="id776">``</span></a>! should use the simple LINEAR (default) mixing scheme.</div>
<div class="line"><a href="#id777"><span class="problematic" id="id778">``</span></a><a href="#id779"><span class="problematic" id="id780">``</span></a>! Usually this option is not needed.</div>
<div class="line">POISSON_MIX_COEFF = param (0.5 default)</div>
<div class="line"><a href="#id781"><span class="problematic" id="id782">``</span></a><a href="#id783"><span class="problematic" id="id784">``</span></a>! The mixing parameter used in the above mixing schemes.
Smaller</div>
<div class="line"><a href="#id785"><span class="problematic" id="id786">``</span></a><a href="#id787"><span class="problematic" id="id788">``</span></a>! the value, more stable, but slower.</div>
<div class="line"><a href="#id789"><span class="problematic" id="id790">``</span></a><a href="#id791"><span class="problematic" id="id792">``</span></a>! Usually this option is not needed.</div>
<div class="line">POISSON_ERROR = error (1.E-10 default)</div>
<div class="line"><a href="#id793"><span class="problematic" id="id794">``</span></a><a href="#id795"><span class="problematic" id="id796">``</span></a>! The tolerance and stopping error for the Poisson equation
iteration.</div>
<div class="line"><a href="#id797"><span class="problematic" id="id798">``</span></a><a href="#id799"><span class="problematic" id="id800">``</span></a>! Usually this option is not needed.</div>
</div>
</div>
</div>
<p>For the water, here is the recommended setting: dielectric_const=78,
surface_tension=50, pressure=-0.35, rhomax_dielectric=0.005,
rhomin_dielectric=0.0001. All these are according to: J. Chen. phys.
136, 064102.</p>
</div>
<div class="section" id="fix-fermi">
<h3>FIX_FERMI<a class="headerlink" href="#fix-fermi" title="Permalink to this headline">¶</a></h3>
<p><strong>FIX_FERMI = T/F, E_Fermi, mix_Q, drho_pulay</strong></p>
<p>Default:</p>
<p><strong>FIX_FERMI = F</strong></p>
<p>This control indicates whether to use fix Fermi energy (fix electrode
potential) calculation. The default is F (use fixed total charge). Note,
for T, this is usually used together with IN.SOLVENT=T, and with
POISSON_BOLTZMANN = T (for Poisson-Boltzmann screening) in the
IN.SOLVENT file for electrochemistry grand cannonical calculations. The
Poisson-Boltzmann screening is used, because in that case, the potential
at far away place is defined as zero, so the absolute Fermi energy is
well defined. This option should be used with care. The E_Fermi is the
Fermi energy in the unit of eV (usually is negative). Note, in this
case, the total number of electron NUM_ELECTRON will be adjusted
automatically, and its input value will only be used as an initial
value. mix_Q is a charge mixing parameter for the total charge. Small
value will be more stable, but slower. Suggest to try 0.1. The
drho_pulay is the value for charge density selfconsistent error drho
before to turn on the pulay charge mixing. The pulay should not be used
at the beginnning, that will cause instability. Suggest to try
drho_pulay at 0.06. Unfortunately, one might has to adjust mix_Q,
drho_pulay for better convergence and speed. Also, one might increase
the smearing of Fermi-Dirac occupation function (in the line of
SCF_ITER0) to make the calculation stable (e.g., 0.25 eV). Besides, one
usually only do a JOB=SCF calculation, with FIX_FERMI=T, instead of
doing RELAX. For relaxation, one can first do a SCF with FIX_FERMI=T,
then do RELAX with FIX_FERMI=F, but use the total charge output
(reported in REPORT) as NUM_ELECTRON to do a RELAX calculation. One can
iterate this loop.</p>
</div>
<div class="section" id="pulay-mix-opt">
<h3>PULAY_MIX_OPT<a class="headerlink" href="#pulay-mix-opt" title="Permalink to this headline">¶</a></h3>
<p><strong>PULAY_MIX_OPT = MAX_PULAY_LENGTH, IFLAG_PULAY_WRAP,
IFLAG_OUTPUT_PULAY, WEIGHT_Q0_PULAY, PENALTY_AA_PULAY</strong></p>
<p>Default:</p>
<p><strong>PULAY_MIX_OPT = 30 1 0 1.0 0.0</strong></p>
<p>Pulay mixing method will use charge density of previous steps to
precondition the input charge density of next SCF iteration. This
parameter provides some options to adjust the pulay mixing.</p>
<p>MAX_PULAY_LENGTH is the maximal steps used for pulay mixing.</p>
<p>IFLAG_PULAY_WRAP indicates whether to restart pulay mixing when total
pulay mxing step is great than MAX_PULAY_WRAP. When total pulay mixing
steps is great than MAX_PULAY_WRAP, if IFLAG_PULAY_WRAP = 0, discards
all datas of previous steps and set total mixing step to zero; if
IFLAG_PULAY_WRAP = 1, discards the datas of the one most early step,
continues to do pulay mixing with the datas of previous MAX_PULAY_LENGTH
steps.</p>
<p>If IFLAG_OUTPUT_PULAY = 1, output move pulay mixing infomation in
REPORT. Default is 0.</p>
<p>WEIGHT_Q0_PULAY is the pulay mixing weight for charge density (in
G-space) at G=0, Default is 1.0. This weight is useful for FIX_FERMI =
T. A possible setting for FIX_FERMI = T:</p>
<p>PULAY_MIX_OPT = 100, 1, 1, 0.0001, 1.0</p>
<p>PENALTY_AA_PULAY is used to add a penalty weight to datas of previous
steps, you can change the strength of the penalty by adjust this
parameter. Default is 0.0, i.e. no penalty.</p>
</div>
<div class="section" id="out-solvent-charge">
<h3>OUT.SOLVENT_CHARGE<a class="headerlink" href="#out-solvent-charge" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.SOLVENT_CHARGE = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.SOLVENT_CHARGE = F</strong></p>
<p>Output several files for viewing when IN.SOLVENT=T.</p>
<p>If OUT.SOLVENT_CHARGE=T, several files (in the same format as OUT.RHO)
will be ouput: OUT.RHO_4DIELECTRIC (the rho_e to be used to generate the
dielectric function. One can plot the isosurface plots using
RHOMAX_DIELECTRIC and RHOMIN_DIELECTRIC values described in IN.SOLVENT
to view where are the turn-in/off surfaces of the dielectric constant);
OUT.RHO_POLARIZE (the solvent induced polarization charge);
OUT.V_POLARIZE (the polarized potential generated by the polarization
charge OUT.RHO_POLARIZE); OUT.RHOP_VHION (the polarizaion charge
multiplied by the electric static potential of the solute molecule. The
integrate of this density is the polarization energy. One can use this
to see where the polazation energy comes from). One usually use VESTA to
view these files.</p>
</div>
<div class="section" id="out-wg">
<h3>OUT.WG<a class="headerlink" href="#out-wg" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.WG = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.WG = T</strong></p>
<p>If OUT.WG = T, PWmat will output a file “OUT.WG”, which stores the final
wave functions in G-space. When SPIN = 2, an extra file “OUT.WG_2” will
also be output. This is the default value. Use utility program
“plot_wg.x” to plot the wave functions. More details about “plot_wg.x”,
please refer to PWmat website <a class="reference external" href="http://www.pwmat.com/utility-download">http://www.pwmat.com/utility-download</a>.</p>
<p>If OUT.WG = F, will not output the wave function file.</p>
</div>
<div class="section" id="out-rho">
<h3>OUT.RHO<a class="headerlink" href="#out-rho" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.RHO = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.RHO = T</strong></p>
<p>If OUT.RHO = T, PWmat will output a file “OUT.RHO”, the final charge
density in real space grid (N1L, N2L, N3L). This is the default value.
If SPIN = 2, PWmat will write out an extra file “OUT.RHO_2”. If
SPIN=222, PWmat will also output OUT.RHO_SOM, a 2x2 complex spin matrix
density.</p>
<p>Use utility program “convert_rho.x” to plot the charge density (unit in
e/Bohr<span class="math notranslate nohighlight">\(^3\)</span>. More details about “convert_rho.x”, please refer to
PWmat website <a class="reference external" href="http://www.pwmat.com/utility-download">http://www.pwmat.com/utility-download</a>.</p>
<p>If OUT.RHO = F, not output the charge file.</p>
</div>
<div class="section" id="out-vr">
<h3>OUT.VR<a class="headerlink" href="#out-vr" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.VR = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.VR = F</strong></p>
<p>If OUT.VR = T, PWmat will output the total potential in file “OUT.VR”,
stored in real space grid (N1L, N2L, N3L). This is the default value.
When SPIN=2, an extra file “OUT.VR_2” will be output. When SPIN=222,
OUT.VR, OUT.VR_SOM (a 2x2 complex spin matrix potential), and
OUT.VR_DELTA (a real up-down potential) will be output. Use utility
program “convert_rho.x” to plot the potential (unit in Hartree).</p>
<p>if OUT.VR = F, not output the potential file.</p>
</div>
<div class="section" id="out-real-rhowf-sp">
<h3>OUT.REAL.RHOWF_SP<a class="headerlink" href="#out-real-rhowf-sp" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.REAL.RHOWF_SP = IFLAG, KPT1, KPT2, ISPIN1, ISPIN2, IW1, IW2</strong></p>
<p><strong>IFLAG = 0 / 1 / 11 / 12 / 2 / 21 / 22</strong></p>
<p>Default:</p>
<p><strong>OUT.REAL.RHOWG_SP = 0</strong></p>
<p>Output the charge density (or wave function) in real space. This is a
special option allow user to selectively output some charge density and
wave functions.</p>
<p>Controls the output of partial charge density (or wave function without
square) in real space grid (N1, N2, N3) from selected eigen orbitals
within the intervals: k-points: [ KPT1, KPT2 ], spins: [ ISPIN1, ISPIN2
], bands: [ IW1, IW2 ] in the file: “OUT.REAL.RHOWF_SP”. This is
different from OUT.RHO, since it can select which wave function to be
included in the charge density. For:</p>
<p><strong>IFLAG=0</strong>, not output the density or wavefunctions, default setting.</p>
<p><strong>IFLAG = 1/11/12</strong>, output the density or wavefunctions <strong>at the end of
other calculations</strong>.</p>
<ol class="arabic simple">
<li><p><strong>IFLAG=1</strong>, output charge density;</p></li>
<li><p><strong>IFLAG=11</strong>, output the wavefunctions, one after the other without
the <span class="math notranslate nohighlight">\(e^{-ikr}\)</span> phase;</p></li>
<li><p><strong>IFLAG=12</strong>, output the wavefunctions, one after the other with the
<span class="math notranslate nohighlight">\(e^{-ikr}\)</span> phase.</p></li>
</ol>
<p><strong>IFLAG = 2/21/22</strong>, output the density or wavefunctions <strong>before doing
any other calculations, then stop PWmat</strong>.</p>
<ol class="arabic simple">
<li><p><strong>IFLAG=2</strong>, output charge density;</p></li>
<li><p><strong>IFLAG=21</strong>, output the wavefunctions, one after the other without
the <span class="math notranslate nohighlight">\(e^{-ikr}\)</span> phase;</p></li>
<li><p><strong>IFLAG=22</strong>, output the wavefunctions, one after the other with the
<span class="math notranslate nohighlight">\(e^{-ikr}\)</span> phase.</p></li>
</ol>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DO</span> <span class="n">IK</span> <span class="o">=</span> <span class="n">KPT1</span><span class="p">,</span> <span class="n">KPT2</span>
   <span class="n">DO</span> <span class="n">IS</span> <span class="o">=</span> <span class="n">ISPIN1</span><span class="p">,</span> <span class="n">ISPIN2</span>
      <span class="n">DO</span> <span class="n">IW</span> <span class="o">=</span> <span class="n">IW1</span><span class="p">,</span> <span class="n">IW2</span>
         <span class="n">REAL</span> <span class="n">PART</span><span class="p">:</span>
         <span class="n">DO</span> <span class="n">INODE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NNODE</span>
            <span class="n">WRITE</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="p">(</span><span class="n">REAL</span><span class="p">(</span><span class="n">PSI</span><span class="p">(</span><span class="n">IR</span><span class="o">+</span><span class="p">(</span><span class="n">INODE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NR_N</span><span class="p">)),</span> <span class="n">IR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NR_N</span><span class="p">)</span>
         <span class="n">END</span> <span class="n">DO</span>
         <span class="n">IMAG</span> <span class="n">PART</span><span class="p">:</span>
         <span class="n">DO</span> <span class="n">INODE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NNODE</span>
            <span class="n">WRITE</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="p">(</span><span class="n">IMAG</span><span class="p">(</span><span class="n">PSI</span><span class="p">(</span><span class="n">IR</span><span class="o">+</span><span class="p">(</span><span class="n">INODE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NR_N</span><span class="p">)),</span> <span class="n">IR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NR_N</span><span class="p">)</span>
         <span class="n">END</span> <span class="n">DO</span>
      <span class="n">END</span> <span class="n">DO</span>
   <span class="n">END</span> <span class="n">DO</span>
<span class="n">END</span> <span class="n">DO</span>
</pre></div>
</div>
</div>
<p>In above PSI(IR) is the wave function in the real space grid (N1,N2,N3),
it first runs through N3, then N2, then N1. In another word, for a given
point (i,j,k), for i within [1,N1], j within [1,N2], k within [1,N3]
then: IR=(i-1)*N2*N3+(j-1)*N3+k.</p>
<p>Note, the wave function can also be viewed (perhaps more conveniently)
one by one using the utility function plot_wg.x, using OUT.WG.</p>
</div>
<div class="section" id="out-force">
<h3>OUT.FORCE<a class="headerlink" href="#out-force" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.FORCE = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.FORCE = T</strong> (JOB=RELAX or JOB=MD)</p>
<p><strong>OUT.FORCE = F</strong> (everything else)</p>
<p>If OUT.FORCE = T, the PWmat will calculate the atomic force, and output
the force in file ”OUT.FORCE”. This is for one shot (one atomic position
snap shot) JOB=SCF calculation only. For JOB=RELAX, or JOB=MD, PWmat
will always calculate the force and output them. Also note, this will
not work for JOB=NONSCF, since there the total energy and SCF charge
density will not be calculated. The force unit is eV/Amstrong. if
OUT.FORCE = F, the default, not calculate the force and output the file.</p>
</div>
<div class="section" id="out-stress">
<h3>OUT.STRESS<a class="headerlink" href="#out-stress" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.STRESS = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.STRESS = T</strong> (JOB = RELAX)</p>
<p><strong>OUT.STRESS = F</strong> (everything else)</p>
<p>Calculate and output the stress tensor.</p>
<p>Definition of stress tensor(eV/Natom),Natom is the total number of
atoms, <span class="math notranslate nohighlight">\(\epsilon_{ij}\)</span> is stain:</p>
<p><span class="math notranslate nohighlight">\(\sigma_{ij}=\frac{1}{Natom}\frac{\partial E_{tot}}{\partial \epsilon_{ij}}\)</span></p>
<p>Definition of pressure(GPascal):</p>
<p><span class="math notranslate nohighlight">\(P=-\frac{Natom}{3\Omega}(\sigma_{11}+\sigma_{22}+\sigma_{33})\)</span></p>
<p>If OUT.STRESS=T, the stress tensor will be calculated and written in
file OUT.STRESS.</p>
<p>If do cell relaxation, the stress is automatically calculated. When JOB
= SCF, if OUT.STRESS = T, the stress will be calculated; if OUT.STRESS =
F, the stress will not be calculated.</p>
</div>
<div class="section" id="out-vatom">
<h3>OUT.VATOM<a class="headerlink" href="#out-vatom" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.VATOM = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.VATOM = F</strong></p>
<p>If setting OUT.VATOM = T, it will output the atom center potential for
SCF or MD simulation. The default is F. This can be used for energy
level alignment etc. The output unit is eV. This does an average using
atomic charge density dot-product with the total potential. We do not
have core level potential. So, for band alignment, we usually use this
atomic potential.</p>
</div>
<div class="section" id="out-tddft">
<h3>OUT.TDDFT<a class="headerlink" href="#out-tddft" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.TDDFT = :math:`T_1`, :math:`T_2`, :math:`n_1`, :math:`T_3`,
:math:`n_2`</strong></p>
<p>Default:</p>
<p><strong>OUT.TDDFT = F F 1.0 F 1.0</strong></p>
<p>The output files can be used to restart TDDFT and show the process of
TDDFT.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(T1,T2,n1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(T1=T/F\)</span></p></th>
<th class="head"><p>eigen energy, <span class="math notranslate nohighlight">\(occ(i)\)</span>
per <span class="math notranslate nohighlight">\(n1\)</span> fs. The output
will be in file OUT.TDDFT1.
One can use
plot_TDDFT.f90(ref. util) to
read and output OUT.TDDFT1.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p><span class="math notranslate nohighlight">\(T2=T/F\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{ij}\)</span> per n1 fs</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T3,n2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T3=T/F\)</span></p></td>
<td><p>output all the wavefunctions
and charge densities per
<span class="math notranslate nohighlight">\(n2\)</span> fs for restart. The
output will be in file
OUT.TDDFT and directory
TDDOS/. This can be very
expensive, so use large
<span class="math notranslate nohighlight">\(n2\)</span>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tddft-space">
<h3>TDDFT_SPACE<a class="headerlink" href="#tddft-space" title="Permalink to this headline">¶</a></h3>
<p><strong>TDDFT_SPACE = itype_space, N, a(1), …, a(N)</strong></p>
<p><strong>itype_space = 0 / 1 / 2 / 3 / -1</strong></p>
<p>Default:</p>
<p><strong>TDDFT_SPACE = 0</strong></p>
<p>This controls the real space Vext_tddft(r). Vext_tddft(r) refers to the
external potential in real space for tddft calculation.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_space</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p>No external input term.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p>Read vext_tddft from file IN.VEXT_TDDFT(all capital,
same format as in IN.VEXT).</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p>:
math:<cite>Vext_tddft(r)=(x-a(1))a(4)+(x-a(1))^2a(5)+(y-a
(2))a(6)+(y-a(2))^2a(7)+(z-a(3))a(8)+(z-a(3))^2a(9)</cite>,
a(1),a(2),a(3) in fractional coordinates, a(4)-a(8)
in unit of Hartree/Bohr. output file OUT.VEXT_TDDFT.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(Vext\_tddft(r)
=a(4)e^{-[(x-a(1))^2+(y-a(2))^2+(z-a(3))^2]/a(5)^2}\)</span>,
a(1),a(2),a(3) in fractional coordinates, a(4) in
unit of Hartree, a(5) in unit of Bohr. output file
OUT.VEXT_TDDFT.</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td><p>Not use real space format, but use G-space,it wil use
IN.A_FIELD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tddft-time">
<h3>TDDFT_TIME<a class="headerlink" href="#tddft-time" title="Permalink to this headline">¶</a></h3>
<p><strong>TDDFT_TIME = itype_time, N, b(1), …, b(N)</strong></p>
<p><strong>itype_time = 0 / 1 / 2</strong></p>
<p>Default:</p>
<p><strong>TDDFT_IIME = 0</strong></p>
<p>This is used to control the time dimension of the external function
fTDDFT(i).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_time</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ftddft(t)=1.0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p>read in <span class="math notranslate nohighlight">\(ftddft(i)\)</span> from IN.TDDFT_TIME</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f
tddft(t)=b(1)e^{-(t-b(2))^2/b(3)^2)}\sin(b(4)t+b(5))\)</span>.
<span class="math notranslate nohighlight">\(b(2)\)</span>,<span class="math notranslate nohighlight">\(b(3)\)</span> in unit of <span class="math notranslate nohighlight">\(fs\)</span>;
<span class="math notranslate nohighlight">\(b(4)\)</span> in unit of rad/fs unit, <span class="math notranslate nohighlight">\(b(5)\)</span> in
unit of rad; <span class="math notranslate nohighlight">\(b(1)\)</span> no unit. output file
OUT.TDDFT_TIME</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(22\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ftddft(t)=\int^
t_0 [b(1)e^{-(t-b(2))^2/b(3)^2)}\sin(b(4)t+b(5))] dt\)</span>.
<span class="math notranslate nohighlight">\(b(2)\)</span>,<span class="math notranslate nohighlight">\(b(3)\)</span> in unit of <span class="math notranslate nohighlight">\(fs\)</span>;
<span class="math notranslate nohighlight">\(b(4)\)</span> in unit of <span class="math notranslate nohighlight">\(rad/fs\)</span>, <span class="math notranslate nohighlight">\(b(5)\)</span>
in unit of rad; <span class="math notranslate nohighlight">\(b(1)\)</span> no unit. output file
OUT.TDDFT_TIME</p></td>
</tr>
</tbody>
</table>
<p>File IN.TDDFT_TIME format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">N</span> <span class="n">ftddft</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For TDDFT Hamiltonian, we have,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_space</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\ne -1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H(t)=H_0+Vext\_tddft(r)ftddft(t)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td><p>:math:<a href="#id801"><span class="problematic" id="id802">`</span></a>H(
t)=-1/2(nabla_x+i A_x*ftddft(t))^2-1/2(nabla_y+i</p>
<blockquote>
<div><p>A_y*ftddft(t))^2-1/2(nabla_z+i A_z*ftddft(t))^2`</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tddft-boltzmann">
<h3>TDDFT_BOLTZMANN<a class="headerlink" href="#tddft-boltzmann" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>TDDFT_BOLTZMANN = flag_b, flag_scale, temp, tau, istep_start(opt),
nstep_CG(opt)</strong></div>
<div class="line">This line controls whether to introduce Boltzmann factor in order to
keep the correct detailed balance between two adiabatic states
<span class="math notranslate nohighlight">\(\phi_{i1}(t)\)</span> and <span class="math notranslate nohighlight">\(\phi_{i2}(t)\)</span>. This goes beyond the
usual Ehrenfest dynamics. In the Ehrenfest dynamics, the electronic
system will be over heated due to the lack of detailed balance (which
means the transition from the lower energy adiabatic state
<span class="math notranslate nohighlight">\(\phi_{i1}(t)\)</span> (with eigen energy <span class="math notranslate nohighlight">\(E_{i1}(t)\)</span>) to higher
energy adiabatic state <span class="math notranslate nohighlight">\(\phi_{i2}(t)\)</span> (with eigen energy
<span class="math notranslate nohighlight">\(E_{i2}(t)\)</span>) is a factor of <span class="math notranslate nohighlight">\(exp(-(E_{i2}-E_{i1})/kT)\)</span>
smaller than the transition from <span class="math notranslate nohighlight">\(\phi_{i2}(t)\)</span> to
<span class="math notranslate nohighlight">\(\phi_{i1}(t)\)</span>. This suppression of the up-lifting transition
can be realized by adding this Boltzmann factor. Adding this Boltzmann
factor is critical in order to have the proper hot electron cooling.
However, an dephasing time tau has to be used with an special
algorithm when adding this Boltzmann factor, otherwise the cooling
will be too fast (e.g., an energy conservation between the transition
states and an phonon mode in the weak coupling regime will not be
satisfied). A special algorithm is implemented in PWmat to properly
take into account the tau. In a way, this is like the Tully’s surface
hopping, but without the stochastic feature in the dynamics. Compared
with Tully’s algorithm, it has more correct dephasing behavior.
Compared with wave function collapsing behavior, it can have more
proper treatment for tau. However, this is a meanfield treatment for
the nuclear trajectory. Unlike the stochastic potential energy surface
hopping, or wave function collapsing treatment, the current meanfield
treatment does not provide a branching for the trajectory (thus might
not be good if you like to calculate the probability for different
chemical reaction, etc). The Boltzmann factor is not applied to each
individual electron state <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> (and its collapsing),
instead, it is applied to the occupation of adiabatic state
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span> (collectively for all <span class="math notranslate nohighlight">\(\{ \psi_j(t) \}\)</span>), as a
result, it has a property of unitary rotational invariance among the
group of <span class="math notranslate nohighlight">\(\psi_j(t)\)</span>.</div>
</div>
<p><strong>flag_b</strong>: indicates whether to use the Boltzmann factor: 0 means no
Boltzmann factor (Ehrenfest dynamics); 1 means with Boltzmann factor.
Note, one has to detemine according to the physics, whether to use this
Boltzmann factor. For example, if the dynamics does not involve phonon,
and it is very short (e.g., using rt-TDDFT to simulate the light
absorption), then one might not want to include the Boltzmann factor.
One thing needs to be mindful: for long time rt-TDDFT simulations, the
use of Boltzmann factor can make the simulation more stable, since all
the states are moving towards equilibrium.</p>
<p><strong>flag_scale</strong>: indicates what method to be used to scale the kinetic
energy. When using the Boltzmann factor, the total energy will not be
conserved without the rescaling of the velocity of the nuclei (usually,
the total energy will decrease due to the electron cooling). There are
different ways to deal with this.</p>
<p><strong>flag_scale=0</strong>: this means without scaling the kinetic energy, as a
result, the total energy will decrease with time.</p>
<p><strong>flag_scale=1</strong>: this means the velocities of all the nuclei will be
rescaled with a uniform scaling factor, so the total energy will be an
constant (thus the lost electronic energy will be given to the phonon
movement). For example, this will be useful for isolated molecule. In
this case, if there is an initial hot electron, the temperature of the
system will likely increase with time. Note, the Boltzmann factor
<span class="math notranslate nohighlight">\(exp(-(E_{i2}-E_{i1})/kT)\)</span> dynamically depends on this temperature
T(t).</p>
<p><strong>flag_scale=2</strong>: this means the velocities of all the nuclear will be
scaled to keep the temperature (the total kinetic energy) to a constant,
specified by <span class="math notranslate nohighlight">\(temp\)</span>. In this case, the temperature in the
<span class="math notranslate nohighlight">\(MD\_DETAIL\)</span> will not be used, but the <span class="math notranslate nohighlight">\(temp\)</span> specified here
will be used. This might be a good approximation if the studied system
is embedded in a thermal bath, which is always kept in a constant
temperature.</p>
<p><strong>flag_scale=3</strong>: this is like <span class="math notranslate nohighlight">\(flag\_scale=1\)</span>, where the kinetic
energy is modified to keep the total energy conserved. However, instead
of uniformly scale the velocity of all the atoms by a constant factor,
here the electron-phonon coupling constant is used to specify a force of
a given atom, which is then used to be added to the current velocity to
conserve the total energy. This is more rigorous treatment for what
phonon degree of freedom to give the extra kinetic energy for. More
specifically, let’s use TCD(i1,i2) to indicate the Boltzmann factor
introduced modification of the density matrix, which represents the
charge transfer between adiabatic states i1 and i2 (this modification
maintains the detailed balance between adiabatic states i1 and i2, but
also cause the violation of energy conservation). We also define
<span class="math notranslate nohighlight">\(D(i1,i2)=\sum_j C*(i1,j) C(i2,j) o(j)\)</span>, here C(i,j) is the
expansion coefficient of electron wave function <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> on
adiabatic state <span class="math notranslate nohighlight">\(\phi_i(t)\)</span>, i.e,
<span class="math notranslate nohighlight">\(\psi_j(t)=\sum_i C(i,j) \phi_i(t)\)</span>, and o(j) is the occupation
(not change with time) of electron state <span class="math notranslate nohighlight">\(\psi_j(t)\)</span>. Then the
extra atomic force due to the TCD(i1,i2) between adiabatic states
<span class="math notranslate nohighlight">\(\phi_{i1}(t)\)</span> and <span class="math notranslate nohighlight">\(\phi_{i2}(t)\)</span> will be:
<span class="math notranslate nohighlight">\(F(R)= \sum_{i1,i2} TCD(i1,i2) D(i1,i2)/abs(D(i1,i2) &lt;\phi_{i1}|\partial H/\partial R|\phi_{i2}&gt;\)</span>,
here R is the nuclear coordination. Then to conserve the total energy we
have used: <span class="math notranslate nohighlight">\(V(R)=V(R)+ x F(R)/m(R)\)</span>, here m(R) is the nuclear
mass, and x is chosen for the smallest value which satisfies the total
energy conservation. This x is reported in the screen output of PWmat in
the line: “TDDFT,boltzmann,kin:istep,x,dE,a*x**2+b*x+c=0”, together with
dE(eV), which is the energy drop due to the Boltzmann factor. The
a*x**2+b*x+c=0 is the equation used to solve for x.</p>
<p><strong>temp</strong>: the fixed temperature when <span class="math notranslate nohighlight">\(flag\_scale=2\)</span>. Note, the
temp1,temp2 in the MD_DETAIL line will not be used for rt-TDDFT
simulation (except the temp1 is used to set an initial velocity of the
system). We provide this temp here, to distinguish the temp1 for the
initial velocity and the temperature you want to use in the Boltzmann
factor.</p>
<p><strong>tau</strong>: the dephasing time (in fs unit) for all the adiabatic state
transitions. If tau=-1 (negative), then one needs to provide an file
<span class="math notranslate nohighlight">\(IN.BOLTZMANN\_TAU\)</span>, which specifies the tau for different states
as described below.</p>
<p><strong>:math:`IN.BOLTZMANN_TAU`</strong>: the tau input file when tau &lt; 0 in above.
This is recommended for the stability of the TDDFT algorithm. It has the
following format:</p>
<p>tau(<span class="math notranslate nohighlight">\(m_1\)</span>), tau(<span class="math notranslate nohighlight">\(m_1\)</span>+1),tau(<span class="math notranslate nohighlight">\(m_1\)</span>+2),…..,
tau(<span class="math notranslate nohighlight">\(m_2\)</span>).</p>
<p>There should be <span class="math notranslate nohighlight">\(m_2-m_1+1\)</span> numbers in a single line, here the
<span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> are the first and last adiabatic state index
specified in the <span class="math notranslate nohighlight">\(TDDFT\_DETAIL\)</span> line. Note, all the numbers are
in fs unit. Also note that, for an adiabatic pair i1 and i2 transition,
the actual tau for this tau(i1,i2) is sqrt(tau(i1)*tau(i2)). It is
recommended that for the few highest adiabatic states in the adiabatic
state window [<span class="math notranslate nohighlight">\(m_1\)</span>,<span class="math notranslate nohighlight">\(m_2\)</span>], use very small tau. E.g., for
the last few tau close to <span class="math notranslate nohighlight">\(m_2\)</span>, use 0.0001fs. This will make sure
these adiabatic states will not have large amplitude <span class="math notranslate nohighlight">\(C(i,j)\)</span>,
which will help the convergence of the TDDFT algorithm.</p>
<p>There are actually more rigorous formulas to calculate tau(i1,i2) from
their eigen energies time dependence:</p>
<div class="math notranslate nohighlight">
\[\tau_{i,j}=2 kT  [&lt;|\partial \epsilon_i(t)/\partial t -\partial \epsilon_j(t)/\partial t|^2&gt;_{ave}]^{-1/2}\]</div>
<p>here <span class="math notranslate nohighlight">\(\epsilon_i(t)\)</span> is the eigen energy of adiabatic state
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span> and the <span class="math notranslate nohighlight">\(&lt;&gt;_{ave}\)</span> means for a time average.
However, in our simulation, we did not calculate this
<span class="math notranslate nohighlight">\(\tau_{i,j}\)</span>, although one can use the above formulat to estimate
the decoherent time between a given pair of adiabatic states.</p>
<p><strong>istep_start (optional)</strong>: This is an optional value, to indicate from
which TDDFT MD step it begins to use the Boltzmann method. If not input,
the default value is 1. One can use this parameter to delay the
deployment of Boltzmann method, in order to make the algorithm more
stable, or for other purposes. One reason is that, for the first 1 or 2
steps, it is possible the TDDFT step itself is not converged. If the SCF
TDDFT is not converged, it might appear to be there are large rotations
between different eigen states, then that can introduce large Boltzmann
correction, and it is wrong, and make can the algorithm unstable. In
that case, one can set istep_start to be 3 or 5, to make the algorithm
more stable. Of course, one can also use this to investigate different
physics.</p>
<p><strong>nstep_CG (optional)</strong>: This is an optional parameter to control the
number of steps in an internal conjugate gradient linear solver. Note,
to input this parameter, one has to have the istep_start paremeter
before nstep_CG. The default value of nstep_CG is 1000. However, for
large systems, the solution of a linear equation can significantly slow
down the calculation. One can test the use of nstep_CG=500, or 250 to
speed up this step.</p>
</div>
<div class="section" id="num-dos-grid">
<h3>NUM_DOS_GRID<a class="headerlink" href="#num-dos-grid" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_DOS_GRID = num</strong></p>
<p>Default:</p>
<p><strong>NUM_DOS_GRID = 4000</strong></p>
<p>This is the number of energy grid points when calculating DOS, the
default is 1500. This grid is within the window [E<span class="math notranslate nohighlight">\(_{min}\)</span>,
E<span class="math notranslate nohighlight">\(_{max}\)</span>], and the <span class="math notranslate nohighlight">\(E_{min}\)</span>, <span class="math notranslate nohighlight">\(E_{max}\)</span> are
determined by the minimum and maximum eigen energies.</p>
</div>
<div class="section" id="nmap-max">
<h3>NMAP_MAX<a class="headerlink" href="#nmap-max" title="Permalink to this headline">¶</a></h3>
<p><strong>NMAP_MAX = num</strong></p>
<p>Default:</p>
<p><strong>NMAP_MAX = 50000</strong></p>
<p>If you encounter the error “nmap_tot too large, reduce rcut, grid
density,or increase NMAP_MAX stop”, you can try to increase the
NMAP_MAX.</p>
</div>
<div class="section" id="wg-error">
<h3>WG_ERROR<a class="headerlink" href="#wg-error" title="Permalink to this headline">¶</a></h3>
<p><strong>WG_ERROR = value</strong></p>
<p>Default:</p>
<p><strong>WG_ERROR = 1.0E-4</strong></p>
<p>The error tolerance (convergence criterion) for the wave function
conjugate gradient iterations (Hartree). This is related to SCF_ITER0,
SEC_ITER1 lines. It can terminate the CG steps before the NLINE0, NLINE1
have been reached. This is to stop the CG iterations.</p>
</div>
<div class="section" id="e-error">
<h3>E_ERROR<a class="headerlink" href="#e-error" title="Permalink to this headline">¶</a></h3>
<p><strong>E_ERROR = value</strong></p>
<p>Default:</p>
<p><strong>E_ERROR = 2.7211E-6*(total number of electrons)</strong></p>
<p>The error tolerance (convergence criterion) for the total energy
(Hartree) in the SCF iterations. The default value is: 2.7211E-6*(total
number of electrons) (<span class="math notranslate nohighlight">\(eV\)</span>). This is related to the SCF_ITER0,
SCF_ITER1 lines. It can terminate the SCF iteration before the maximum
steps (NITER0, NITER1) have been reached. Note, since E_ERROR is only
determined by one number (the total energy), so it can accidently reach
the convergence. It might be dangerous to relied on this error to stop
the SCF iteration. To avoid that, one can reduce this value, e.g., to
1.E-8 (<span class="math notranslate nohighlight">\(eV\)</span>).</p>
</div>
<div class="section" id="rho-error">
<h3>RHO_ERROR<a class="headerlink" href="#rho-error" title="Permalink to this headline">¶</a></h3>
<p><strong>RHO_ERROR = value</strong></p>
<p>Default:</p>
<p><strong>RHO_ERROR = 0.5E-4</strong></p>
<p>The error tolerance (convergence criterion) using the SCF iteration
difference between the input and output charge density. If the relative
error of input and output charge density in one SCF step is less than
RHO_ERROR, the SCF iteration will be stopped.</p>
</div>
<div class="section" id="rho-relative-error">
<h3>RHO_RELATIVE_ERROR<a class="headerlink" href="#rho-relative-error" title="Permalink to this headline">¶</a></h3>
<p><strong>RHO_RELATIVE_ERROR = value</strong></p>
<p>Default:</p>
<p><strong>RHO_RELATIVE_ERROR = 7.0E-2</strong></p>
<p>A variable to control the stopping of the internal CG iterations. This
is to estimate the charge density error due to the wave function of CG
iteration error. The estimated charge density error should be less than
(output-input) SCF charge density error multiplied by
RHO_RELATIVE_ERROR, in order to stop the CG steps. Note, this, like
WG_ERROR, is to stop the CG iteration (within one SCF step), not the SCF
iteration. In contrast, E_ERROR, RHO_ERROR are used to stop the SCF
iterations. The default value is 7.0E-2. Smaller this value, more
stringent requirement, as a result more likely this is not used.</p>
</div>
<div class="section" id="force-relative-error">
<h3>FORCE_RELATIVE_ERROR<a class="headerlink" href="#force-relative-error" title="Permalink to this headline">¶</a></h3>
<p><strong>FORCE_RELATIVE_ERROR = value</strong></p>
<p>Default:</p>
<p><strong>FORCE_REVATIVE_ERROR = 0.003</strong> (JOB=RELAX)</p>
<p><strong>FORCE_RELATIVE_ERROR = 0.02</strong> (JOB=MD)</p>
<p>A variable to control the stopping of the SCF iterations during MD and
RELAX. This is to estimate the atomic force error due to the charge
density error of SCF iterations. The estimated force error should be
smaller than the previous MD or RELAX step force multiplied by
FORCE_RELATIVE_ERROR in order to stop the SCF iterations. Smaller this
value, more accurate SCF is used. The default value for JOB = RELAX is
0.003; the default value for JOB=MD is 0.02.</p>
</div>
<div class="section" id="sys-type">
<h3>SYS_TYPE<a class="headerlink" href="#sys-type" title="Permalink to this headline">¶</a></h3>
<p><strong>SYS_TYPE = 1 / 2</strong></p>
<p>Default:</p>
<p><strong>SYS_TYPE = 1</strong></p>
<p>This parameter helps to identify whether the system is semiconductor,
insulator or metallic. If the sys_type = 1, the system will be
semiconductor or insulator(default). The smearing width (the “dE” in
SCF_ITER0/1 line) is 0.025; If the sys_type = 2, the system will be
metallic. The “dE” will be 0.2.</p>
</div>
<div class="section" id="scf-iter0-1-2-3">
<h3>SCF_ITER0_1/2/3…<a class="headerlink" href="#scf-iter0-1-2-3" title="Permalink to this headline">¶</a></h3>
<p><strong>SCF_ITER0_1 = NITER0_1, NLINE0, imth, icmix, dE, Fermi-Dirac</strong></p>
<p><strong>SCF_ITER0_2 = NITER0_2, NLINE0, imth, icmix, dE, Fermi-Dirac</strong></p>
<p><strong>SCF_ITER0_3 = NITER0_3, NLINE0, imth, icmix, dE, Fermi-Dirac</strong></p>
<p>…</p>
<p>Default:</p>
<p><strong>SCF_ITER0_1 = 6 4 3 0.0 0.025 1</strong></p>
<p><strong>SCF_ITER0_2 = 94 4 3 1.0 0.025 1</strong></p>
<p>These variables control the charge density self-consistent iterations
for the first SCF run for JOB = SCF, RELAX, MD. For RELAX, MD, the first
step SCF run (with the initial atomic positions) uses “SCF_ITER0” lines
, and subsequent steps (for moved atomic positions) uses the values of
“SCF_ITER1” lines. They are set differently because normally the first
run requires much more steps. It is also used for NONSCF run, in which
the ICMIX = 0 for all the NITER0 (NITER0_1+NITER0_2+…) lines in the
following. This variable is not used for JOB = DOS.</p>
<p><strong>NITER0</strong>: the number of self-consistent (SCF) iterations steps.</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
        NITER0 = NITER0\_1 + NITER0\_2 + NITER0\_3 + ...
    \end{aligned}\]</div>
<p>The Default value for NITER0 is 100. Note the SCF iteration can be
stopped before the NITER0 has been reached if the E_ERROR has been
satisfied, or the condition specified by FORCE_RELATIVE_ERROR has been
reached. So, the stopping of SCF iteration is controlled by four
parameters: <strong>NITER0, E_ERROR, RHO_ERROR, FORCE_RELATIVE_ERROR</strong>,
whichever is satisfied first.</p>
<p><strong>NLINE0</strong>: the number of CG line minimization steps to solve the wave
functions according to <span class="math notranslate nohighlight">\(H\psi_i=\varepsilon_i\psi_i\)</span> for a given
potential (hence <span class="math notranslate nohighlight">\(H\)</span>) at each charge self-consistent step. The
default value of NLINE0 is 4. Note, the CG line minimization can be
stopped if the error is smaller than WG_ERROR, or the condition
specified by RHO_RELATIVE_ERROR is reached. So, the stopping of CG
iterations is controlled by three parameters: <strong>NLINE0, WG_ERROR,
RHO_RELATIVE_ERROR, whichever is satisfied first</strong>.</p>
<p><strong>IMTH=1</strong>, the old band-by-band CG algorithm. It should not be used
unless for some special situation.</p>
<p><strong>IMTH=3</strong>, the all band conjugate gradient method. This is the default
method. We strongly recommend the use of this method.</p>
<p><strong>IMTH=2</strong>, the DIIS method. This could be faster than IMTH = 3, but
could also have stability problems. It should only be used in SCF
iteration steps where the wave function is in some degree converged
(e.g., not for random wave functions).</p>
<p><strong>ICMIX=0</strong>, no charge mixing and update at this SCF step. In other
word, at this step, it is a NONSCF step. For JOB = SCF, RELAX, MD, by
default, for the first four SCF steps, ICMIX = 0, and ICMIX = 1 for
subsequent steps. For JOB = NONSCF, for all steps, ICMIX = 0.</p>
<p><strong>ICMIX=1</strong>, with charge mixing and update for this SCF step. Note, this
is a floating point number.</p>
<p>NOTE: cne can specify something like ICMIX=1.05, as a parameter for
Kerker mixing, sometime this can significantly increase the convergence
speed. For most cases, ICMIX=1.00 is good enough.</p>
<p><strong>DE</strong>: the <span class="math notranslate nohighlight">\(kT\)</span> equivalent energy (in <span class="math notranslate nohighlight">\(eV\)</span>) for Fermi-Dirac
formula to calculate the electron occupations of the eigen wave
functions according to their eigen energies <span class="math notranslate nohighlight">\(\varepsilon_i\)</span>. The
default value is <span class="math notranslate nohighlight">\(0.025eV\)</span>. For semiconductor, especially for
defect calculation, <span class="math notranslate nohighlight">\(0.025 eV\)</span> should be used. However, for
metallic system where there are many states near the Fermi energy, one
might choose a larger value, e.g., <span class="math notranslate nohighlight">\(0.1eV\)</span> or even <span class="math notranslate nohighlight">\(0.2eV\)</span>.</p>
<p><strong>FERMI-DIRAC</strong>: (with possible values: 0, 1, 2, 3, 4, 5,-1). Different
formulas for the Fermi-Dirac-equivalent function to calculate the wave
function occupation using <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> and <span class="math notranslate nohighlight">\(dE\)</span>. These
formulas are: 0, need input external files ‘IN.OCC’ for SPIN = 1 and
‘IN.OCC’, ‘IN.OCC_2’ for SPIN = 2; 1, Fermi-Dirac; 2, Gaussian; 3,4,5
Gaussian with other prefactor polynomials; -1, need external files
‘IN.OCC,IN.CC’ for SPIN=1, ‘IN.OCC,IN.OCC_2,IN.CC,IN.CC_2’ for SPIN=2.
The default value is 1. However, for metallic systems, one might like to
choose 2,3,4, with larger DE values.</p>
<p>Files IN.OCC, IN.OCC_2 format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span> <span class="c1">#occupations for k-point1</span>
<span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span> <span class="c1">#occupations for k-point2</span>
</pre></div>
</div>
</div>
<p>Files IN.CC, IN.CC_2 format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>  <span class="mi">1</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">3</span>  <span class="mf">1.0</span>
<span class="mi">2</span>  <span class="mi">4</span>  <span class="mf">0.8</span>  <span class="mi">5</span> <span class="mf">0.2</span>
<span class="mi">1</span>  <span class="mi">5</span>  <span class="mf">1.0</span>
<span class="o">....</span>
</pre></div>
</div>
</div>
<p>The IN.CC, IN.CC_2 are used to initialize the <span class="math notranslate nohighlight">\(C_{ij}\)</span> for TDDFT,
which is used as <span class="math notranslate nohighlight">\(\psi_j(t)=\sum_i C_{ji}(t)\phi_i(t)\)</span>. Line
<span class="math notranslate nohighlight">\(j\)</span> specify the <span class="math notranslate nohighlight">\(\psi_j, j=1,mstate\)</span>. Define pair (i,CC),
<span class="math notranslate nohighlight">\(i\)</span> is the index of adiabatic states, CC is the value of
<span class="math notranslate nohighlight">\(C_{ji}\)</span>. The first column specify the number of pairs. If m, one
index of adiabatic states, is not specified , then <span class="math notranslate nohighlight">\(C_{jm}=0\)</span>.</p>
</div>
<div class="section" id="scf-iter1-1-2-3">
<h3>SCF_ITER1_1/2/3…<a class="headerlink" href="#scf-iter1-1-2-3" title="Permalink to this headline">¶</a></h3>
<p><strong>SCF_ITER1_1 = NITER1_1, NLINE1, imth, icmix, dE, Fermi-Dirac</strong></p>
<p><strong>SCF_ITER1_2 = NITER1_2, NLINE1, imth, icmix, dE, Fermi-Dirac</strong></p>
<p><strong>SCF_ITER1_3 = NITER1_3, NLINE1, imth, icmix, dE, Fermi-Dirac</strong></p>
<p>…</p>
<p>Default:</p>
<p><strong>SCF_ITER1_1 = 40 4 3 1.0 0.025 1</strong></p>
<p>This is for subsequent SCF calculations for JOB = RELAX, MD, except the
first SCF step. It has the same meaning as in SCF_ITER0_1/2/3….
Usually however, the ICMIX is always 1. As default, NITER1=40, NLINE1 =
4, IMTH = 3, ICMIX = 1, DE = 0.025, FERMI-DIRAC=1.</p>
</div>
<div class="section" id="nonlocal">
<h3>NONLOCAL<a class="headerlink" href="#nonlocal" title="Permalink to this headline">¶</a></h3>
<p><strong>NONLOCAL = 1 / 2</strong></p>
<p>Default:</p>
<p><strong>NONLOCAL = 2</strong></p>
<p>The nonlocal is the nonlocal pseudopotential implementation flag.</p>
<p><strong>NONLOCAL = 1</strong>, no nonlocal potential. One has to know what he/she is
doing. This usually should never be used, unless for testing purpose.</p>
<p><strong>NONLOCAL = 2</strong>, the default, real space nonlocal pseudo potential
implementation. It used the mask function method.</p>
</div>
<div class="section" id="md-vv-scale">
<h3>MD_VV_SCALE<a class="headerlink" href="#md-vv-scale" title="Permalink to this headline">¶</a></h3>
<p><strong>MD_VV_SCALE = NSTEP</strong></p>
<p>Default:</p>
<p><strong>MD_VV_SCALE = 100</strong></p>
<p>To scale the kinetic energy in Verlet MD (for JOB=MD, iMD=1/11) for
every NSTEP steps, so the total energy is conserved. The default NSTEP
is 100. This is used for enforce the total energy conservation for
Verlet. Note, in TDDFT, NAMD, or some MD when there is external
potential or electric field, the total energy is not supposed to be
conserved. In those case, please set MD_VV_SCALE to a very large number,
so it will never be used. The default value is MD_VV_SCALE=100 for MD,
and not used for TDDFT and NAMD.</p>
</div>
<div class="section" id="stress-corr">
<span id="subsection-corr"></span><h3>STRESS_CORR<a class="headerlink" href="#stress-corr" title="Permalink to this headline">¶</a></h3>
<p><strong>STRESS_CORR = :math:`num_pw_1,energy_1,num_pw_2,energy_2`</strong></p>
<p>No default</p>
<p>As we know, the number of plane wavefunction has respond to the size of
the lattice, i.e. different lattice will give different number of plane
wavefunctions in the same cutoff. When running cell relaxation, the
lattice will change. Correspondingly, the number of plane wavefunctions
should also change. However, the change of the plane wavefunctions will
disturb the procedure of the relaxation. As a result, in DFT
calculations, we keep the number of plane wavefunctions all the same. In
order to overcome the problem in cell relaxation, we implement an stress
correction. One can refer to the paper <a href="#id803"><span class="problematic" id="id804">:raw-latex:`\cite{stress1}`</span></a> for
more details.</p>
<p>The steps to carry out the stress correction: Before running the cell
relaxation, you should do two SCF calculations with different cutoff.
Each calculation will give the <span class="math notranslate nohighlight">\(num\_pw\)</span> (See “Weighted average
num_of_PW for all kpoint” in REPORT), the <span class="math notranslate nohighlight">\(energy\)</span> (See “E_tot” in
REPORT). Then continue doing the cell relaxation with these parameters
setting STRESS_CORR.<strong>WARNING:the difference of the two cutoff should
not be too large, about 1~2Ryd.</strong></p>
</div>
<div class="section" id="som-sphere-rcut">
<h3>SOM_SPHERE_RCUT<a class="headerlink" href="#som-sphere-rcut" title="Permalink to this headline">¶</a></h3>
<p><strong>SOM_SPHERE_RCUT = value</strong></p>
<p>Default:</p>
<p><strong>SOM_SPHERE_RCUT = RCUT</strong></p>
<p><strong>SOM_SPHERE_RUCT</strong> is used to determine the spin component for each
atom. Roughly, it should be half the bond length (in <span class="math notranslate nohighlight">\(Angstrom\)</span>).
<strong>WARNING:The default value is large, and you usually need to set a
appropriate value according to the bond length.</strong></p>
</div>
<div class="section" id="pwscf-output">
<h3>PWSCF_OUTPUT<a class="headerlink" href="#pwscf-output" title="Permalink to this headline">¶</a></h3>
<p><strong>PWSCF_OUTPUT = T/F</strong></p>
<p>Default:</p>
<p><strong>PWSCF_OUTPUT = F</strong></p>
<p>This parameter controls whether to output pwscf compatible output files
(wave function, charge density, and potential), so the result can be run
subsequently on pwscf. For T, it will output those files into the
directory “prefix.save”. For F, it will not output.</p>
<p>Some recommendations: If PWSCF_OUTPUT=T, please use the setting:
<strong>ECUT2L = ECUT2, N123L = N123, ECUT2 = 4*ECUT</strong>. Because PWmat
implement a different FFT from PWSCF.</p>
</div>
<div class="section" id="use-pwscf-inte-method">
<h3>USE_PWSCF_INTE_METHOD<a class="headerlink" href="#use-pwscf-inte-method" title="Permalink to this headline">¶</a></h3>
<p><strong>USE_PWSCF_INTE_METHOD = T / F</strong></p>
<p>Default:</p>
<p><strong>USE_PWSCF_INTE_METHOD = F</strong></p>
<p>Whether or not to use the PWSCF method to do the 1D vloc potential
integrations.</p>
<p><strong>USE_PWSCF_INTE_METHOD=T</strong>, use Simpson method and 10 Bohr radius
cutoff. When using this, PWmat will have the exact same energy results
with PWSCF.</p>
<p><strong>USE_PWSCF_INTE_METHOD=F (default)</strong>, use smooth radius cuttoff
(smaller cutoff). This is the origin PWmat integration method. We
believe it is more accurate (although the result is slightly different
from that of PWscf.</p>
</div>
<div class="section" id="num-blocked-psi">
<h3>NUM_BLOCKED_PSI<a class="headerlink" href="#num-blocked-psi" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_BLOCKED_PSI=T/F</strong></p>
<p>Default:</p>
<p>NUM_BLOCKED_PSI = F</p>
<p>In NUM_BLOCKED_PSI = T, PWmat will divide the wavefunctions into N parts
and then put the parts into GPU memory successively one after another
during scf iteration. This is to save the use of GPU memory. If a
previous run found the GPU out of memory, this can be tried. :It is not
allowed to use this parameter when “ENERGY_DECOMP = T” in etot.input. If
NUM_BLOCKED_PSI = T, the decomposed energy can suddenly be very wrong.</p>
<p>This parameter intends to save the GPU memory to calculate a larger or
more complicated systems. So when PWmat tells , one can try this
parameter by setting NUM_BLOCKED_PSI=T, and etc. Note that using this
parameter will reduce the speed of PWmat (e.g., by a factor of 1.5).</p>
</div>
<div class="section" id="wf-store2disk">
<h3>WF_STORE2DISK<a class="headerlink" href="#wf-store2disk" title="Permalink to this headline">¶</a></h3>
<p><strong>WF_STORE2DISK=1 / 0</strong></p>
<p>Default:</p>
<p><strong>WF_STORE2DISK = 0</strong></p>
<p>If WF_STORE2DISK = 1, the wavefunctions will be written into disk,
otherwise written into cpu memory. This parameter is used to save cpu
memory to calculate a larger or more complicated systems, in particular
for the case multiple k-points are calculated (then one can use
WF_STORE2DISK=1). Note that: it will reduce the performance of PWmat in
some degree.</p>
</div>
<div class="section" id="qij-detail">
<h3>QIJ_DETAIL<a class="headerlink" href="#qij-detail" title="Permalink to this headline">¶</a></h3>
<p><strong>QIJ_DETAIL = QIJ_PD, QIJL0_GS</strong></p>
<p>Default:</p>
<p><strong>QIJ_DETAIL = 0 1</strong></p>
<p>Only relevant for ultrasoft pseudopoential. This is a bit obsolete,
usually don’t use it.</p>
<p>Note: normally, should not be used by user (unless the user knows
exactly what he is doing), just take the default values (or not to write
this line in etot.input).</p>
<p><strong>QIJ_PD = 0/1</strong>: It controls whether to include the l=p and d angular
momentum core charge density QIJ(r,l) in the ultrasoft pseudopotential
calculation. The default is 0, which means only the s angular momentum
core charge density is used. We strongly recommend the use of 0. The
difference is usually very small, but the including of p and d
components of the QIJ(r,l) can make the energy manifold unsmooth, thus
makes the JOB=RELAX difficult.</p>
<p><strong>QIJL0_GS = 1/2</strong>: This parameter is only used by ultra-soft
pseudopotential calculations. It controls the core charge implementation
in ultra-soft pseudopotential. 1 means the s-component of the core Qij
charge is used and implemented in G-space; 2 means the s-component of
the core Qij charge is implemented in real-space. The default is 1. We
strongly recommend the use of default value since QIJL0_GS=2 might
introduce some jitter in the energy curve.</p>
</div>
<div class="section" id="scf-mix">
<h3>SCF_MIX<a class="headerlink" href="#scf-mix" title="Permalink to this headline">¶</a></h3>
<p><strong>SCF_MIX = CHARGE (default) / POTENTIAL</strong></p>
<p>Default:</p>
<p><strong>SCF_MIX = CHARGE</strong></p>
<p>Related input line: JOB=SCF, or any other calculations using SCF
calculations.</p>
<p>The pulay mixing method for the SCF iterations: charge-mixing or
potential-mixing.</p>
<p>: potential-mixing not support SPIN=222.</p>
</div>
<div class="section" id="pulay-kerk-parameters">
<h3>PULAY_KERK_PARAMETERS<a class="headerlink" href="#pulay-kerk-parameters" title="Permalink to this headline">¶</a></h3>
<p>This includes several parameter which can be tuned to improve the SCF
converged in Pulay mixing and Kerk mixing:</p>
<p><strong>KERK_AMIN = a_min (default 0.3)</strong></p>
<p><strong>KERK_AMIX = a_mix (default 0.4)</strong></p>
<p><strong>KERK_AMIX_MAG = a_mix_mag (default 1.0)</strong></p>
<p><strong>KERK_BMIX = b (default 0.5)</strong></p>
<p><strong>LDAU_MIX = ldau_mix (default 0.7)</strong></p>
<p><strong>PULAY_WEIGHT_SPIN = pulay_weight_spin (default 1.0)</strong></p>
<p><strong>PULAY_WEIGHT_NS = pulay_weight_ns (default 1.0)</strong></p>
<p>In Kerk mixing, for a given <span class="math notranslate nohighlight">\(V_{in}\)</span> and <span class="math notranslate nohighlight">\(V_{out}\)</span> pair
(comes out from the Pulay mixing), we get a new <span class="math notranslate nohighlight">\(V_{in}\)</span> for the
next SCF interation as (in G-space):</p>
<div class="math notranslate nohighlight">
\[V_{in}(G)={0.5 a G^2 + c \over 0.5 G^2 +b} V_{out}(G)+(1-{0.5 a G^2 +c \over 0.5 G^2 + b}) V_{in}(G)\]</div>
<p>here c is from the line: “SCF_ITER0_2 = 100,4,4,1.0x,0.025, 2”, here the
c=x. By default, c=0. So, one can use b to control the transition from
the big G to small G region, and a is used to control the mixing rate at
large G, and c is used to control the mixing rate at small G. We found
that, some time using none zero c (e.g., 0.02 or 0.05) can accelerate
the converges for non metallic system, and sometime even for metallic
system. The default values for a and b are usually good enough.</p>
<p>Note, for spin=2, for the Kerk mixing, the charge densities are group
into total charge and magnetic charge. The above mixing formula only
applies to the total charge. For the magnetic charge, a simple mixing
scheme is used, the the mixing parameter is 1 (which means the output
magnetic charge density is used as the input for the next iterations).
Right now, there is no input parameter to control this magnetic moment
mixing.</p>
<p>ldau_mix is used to control the simple mixing parameter for the LDA+U
local orbital n occupation number. Simply the
<span class="math notranslate nohighlight">\(n(new)=ldau\_mix * n_{out}+ (1-ldau\_mix)* n_{in}\)</span>, here n is the
local orbital occupation number matrix in LDA+U. Note, the default value
for this parameter is 0.7, but sometime one can use a large ldau_mix to
accelerate the converges, e.g., even ldau_mix=5.</p>
<p>pulay_weight_spin control the weight we used in Pulay mixing for SPIN=2
calculations. In SPIN=2, the charge densities of spin up and down are
recombined into total charge density and magnetic density (the
difference between up and down). The pulay_weight_spin control what
weight we give to the magnetic density when we carry out pulay mixing.
Pulay mixing is done by mixing the previous density in and out pair,
trying to reduce the resulting in and out difference. When we judge how
large is the in-out difference, we need to use a weight for the total
charge part and spin part.</p>
<p>pulay_weight_ns is the weight factor in the pulay mixing for the case of
LDA+U to place in the local orbital occupation matrix n, against the
charge density.</p>
</div>
<div class="section" id="out-mlmd">
<h3>OUT.MLMD<a class="headerlink" href="#out-mlmd" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.MLMD = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.MLMD = F</strong></p>
<p>This parameter is used to control whether to output OUT.MLMD file during
JOB = SCF. The format of OUT.MLMD is the same as MOVEMENT, including
atomic postion and atomic force setctions.</p>
</div>
<div class="section" id="num-mpi-per-gpu">
<h3>NUM_MPI_PER_GPU<a class="headerlink" href="#num-mpi-per-gpu" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_MPI_PER_GPU = N</strong></p>
<p>Default:</p>
<p><strong>NUM_MPI_PER_GPU = 1</strong></p>
<p>This parameter is used to control how many threads are bound to a GPU at
the same time.</p>
</div>
<div class="section" id="out-hsewr">
<h3>OUT.HSEWR<a class="headerlink" href="#out-hsewr" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.HSEWR = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.HSEWR = T</strong></p>
<p>This parameter is used to control whether to output OUT.HSEWR* file
while XCFUNCTIONAL=HSE. The files OUT.HSEWR* are the real space
wavefunctions of all unreduced kpoints, usually they are in big size and
take long time to be written on disk. If you’re sure that you do not
need these files, you can set OUT.HSEWR=F. (For example, files
OUT.HSEWR* will be used to run NONSCF with XCFUNCTIONAL=HSE.)</p>
</div>
<div class="section" id="out-elf">
<h3>OUT.ELF<a class="headerlink" href="#out-elf" title="Permalink to this headline">¶</a></h3>
<p><strong>OUT.ELF = T / F</strong></p>
<p>Default:</p>
<p><strong>OUT.ELF = F</strong></p>
<p>This parameter is used to control whether to output OUT.ELF file. The
file OUT.ELF is the electron localization function, you can convert it
to xsf format by using convert_rho.x utility. Usually you should set
Ecut2=4*Ecut in etot.input.</p>
</div>
<div class="section" id="set-out-fermi-pos">
<h3>SET_OUT_FERMI_POS<a class="headerlink" href="#set-out-fermi-pos" title="Permalink to this headline">¶</a></h3>
<p><strong>SET_OUT_FERMI_POS = T / F 0/1</strong></p>
<p>Default:</p>
<p><strong>SET_OUT_FERMI_POS = F 0</strong></p>
<p>This parameter is used to set fermi energy for calculations of
insulator. If SET_OUT_FERMI_POS = T 0, output VBM in file OUT.FERMI as
the fermi energy. If SET_OUT_FERMI_POS = T 1, output CBM in file
OUT.FERMI as the fermi energy.</p>
</div>
<div class="section" id="e-finite">
<h3>E_FINITE<a class="headerlink" href="#e-finite" title="Permalink to this headline">¶</a></h3>
<p><strong>E_FINITE = T / F Ex Ey Ez</strong></p>
<p>Default:</p>
<p><strong>E_FINITE = F 0 0 0</strong></p>
<p>This parameter is used to set the homogeneous electric field in the
electric enthalpy functional.:raw-latex:<cite>cite{finite}</cite> If the first
parameter is T, it will compute the self-consistent response to finite
electric fields. Ex,Ey,Ez in unit eV/Angstrom.</p>
<p>In the output of screen, one can search for “Pel”, the electronic dipole
moment, in unit e*Angstrom.The first “Pel” is the result with fields
turned off. The second “Pel” is the result with fields turned on.</p>
<p>An example of AlAs, the file atom.config:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
         <span class="n">LATTICE</span>
         <span class="mf">4.0543775558</span>         <span class="mf">0.0000000000</span>         <span class="mf">0.0000000000</span>
         <span class="mf">2.0271887779</span>         <span class="mf">3.5111939599</span>         <span class="mf">0.0000000000</span>
         <span class="mf">2.0271887779</span>         <span class="mf">1.1703979866</span>         <span class="mf">3.3103854121</span>
         <span class="n">POSITION</span>
         <span class="mi">13</span> <span class="mf">0.000000000</span>       <span class="mf">0.000000000</span>         <span class="mf">0.000000000</span>  <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
         <span class="mi">33</span> <span class="mf">0.749999998</span>       <span class="mf">0.750000011</span>         <span class="mf">0.749999994</span>  <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>the file etot.input:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
         <span class="n">JOB</span> <span class="o">=</span> <span class="n">scf</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span> <span class="o">=</span> <span class="n">As</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>

         <span class="n">Ecut</span>    <span class="o">=</span> <span class="mi">50</span>
         <span class="n">Ecut2</span>   <span class="o">=</span> <span class="mi">200</span>
         <span class="n">MP_N123</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span>

         <span class="n">e_finite</span>  <span class="o">=</span> <span class="n">T</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.001</span>

         <span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
         <span class="n">e_error</span>   <span class="o">=</span> <span class="mf">0.0</span>
         <span class="n">wg_error</span>  <span class="o">=</span> <span class="mf">0.0</span>
         <span class="n">rho_error</span> <span class="o">=</span> <span class="mf">1.</span><span class="n">d</span><span class="o">-</span><span class="mi">6</span>

         <span class="n">out</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<p>The OUT.FORCE=T is needed to calculate born effective charge, for
accurate forces, Ecut2=4*Ecut is recommended.</p>
<p>Kpoints are set by MP_N123 without symmetry(E_FINITE=T can not use
symmetry). Kpoints grid should be large enough to get converged results.</p>
<p>PRECISION=DOUBLE is set for more accurate results, much more here we set
e_error=0, wg_error=0, rho_error=1.d-6 to ensure the wavefunctions in
good convergency.</p>
<p>For systems with small gap, one need to use smaller FremidE, also need
to use much smaller strength of field in case of no local minimum, like
following example, the file atom.config:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
         <span class="n">LATTICE</span>
              <span class="mf">4.06599283</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>
              <span class="mf">2.03299642</span>     <span class="mf">3.52125308</span>     <span class="mf">0.00000000</span>
              <span class="mf">2.03299642</span>     <span class="mf">1.17375103</span>     <span class="mf">3.31986925</span>
         <span class="n">POSITION</span>
          <span class="mi">31</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span>     <span class="mf">0.00000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
          <span class="mi">33</span>     <span class="mf">0.25000000</span>     <span class="mf">0.24999999</span>     <span class="mf">0.25000000</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>the file etot.input:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>  <span class="mi">1</span>
         <span class="n">JOB</span> <span class="o">=</span> <span class="n">scf</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span> <span class="o">=</span> <span class="n">Ga</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span> <span class="o">=</span> <span class="n">As</span><span class="o">.</span><span class="n">SG15</span><span class="o">.</span><span class="n">PBE</span><span class="o">.</span><span class="n">UPF</span>
         <span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>

         <span class="n">Ecut</span>    <span class="o">=</span> <span class="mi">50</span>
         <span class="n">Ecut2</span>   <span class="o">=</span> <span class="mi">200</span>
         <span class="c1"># for correct and converged results, maybe need to use more kpoints</span>
         <span class="n">MP_N123</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span>
         <span class="n">e_finite</span>  <span class="o">=</span> <span class="n">T</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.0001</span>

         <span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
         <span class="n">e_error</span>   <span class="o">=</span> <span class="mf">0.0</span>
         <span class="n">wg_error</span>  <span class="o">=</span> <span class="mf">0.0</span>
         <span class="n">rho_error</span> <span class="o">=</span> <span class="mf">1.</span><span class="n">d</span><span class="o">-</span><span class="mi">6</span>

         <span class="n">out</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="n">t</span>

         <span class="c1">#use FermidE=0.001eV</span>
         <span class="n">SCF_ITER0_1</span> <span class="o">=</span>    <span class="mi">6</span>   <span class="mi">4</span>    <span class="mi">3</span>    <span class="mf">0.0000</span>     <span class="mf">0.0010</span>    <span class="mi">1</span>
         <span class="n">SCF_ITER0_2</span> <span class="o">=</span>   <span class="mi">94</span>   <span class="mi">4</span>    <span class="mi">3</span>    <span class="mf">1.0000</span>     <span class="mf">0.0010</span>    <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="num-electron-spin">
<h3>NUM_ELECTRON_SPIN<a class="headerlink" href="#num-electron-spin" title="Permalink to this headline">¶</a></h3>
<p><strong>NUM_ELECTRON_SPIN = NUM_UP NUM_DN</strong></p>
<p>Default:</p>
<p>This parameter has no default settings.</p>
<p>If NUM_ELECTRON_SPIN is explicitly set in etot.input, it will seperately
fix the spin-up and spin-down number of electrons to NUM_UP and NUM_DN.</p>
</div>
</div>
<div class="section" id="default-input-setting">
<span id="section-defaultinputsetting"></span><h2>Default input setting<a class="headerlink" href="#default-input-setting" title="Permalink to this headline">¶</a></h2>
<p>The following tables summarizes some default parameters.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">CONVERGENCE</div>
</div>
<div class="footnotesize docutils container">
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONVERGENCE</span>            <span class="n">EASY</span>                <span class="n">DIFFICULT</span>
<span class="n">WG_ERROR</span>               <span class="mf">1.0E-4</span>              <span class="mf">0.5E-4</span>
<span class="n">E_ERROR</span>                <span class="mf">1.0E-7</span><span class="o">*</span><span class="n">TOTNEL</span><span class="o">*</span><span class="n">Har</span>   <span class="mf">0.01E-7</span><span class="o">*</span><span class="n">TOTNEL</span><span class="o">*</span><span class="n">Har</span>
<span class="n">RHO_ERROR</span>              <span class="mf">0.5E-4</span>              <span class="mf">0.5</span><span class="o">*</span><span class="mf">0.5E-4</span>
<span class="n">RHO_RELATIVE_ERROR</span>     <span class="mf">0.07</span>                <span class="mf">0.0</span>
<span class="p">(</span><span class="n">TOTNEL</span><span class="p">:</span> <span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">electrons</span><span class="p">)</span>
<span class="p">(</span><span class="n">Har</span><span class="p">:</span> <span class="mf">27.21138602</span><span class="n">eV</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</li>
<li><div class="line-block">
<div class="line">ACCURACY</div>
</div>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ACCURACY</span>      <span class="n">NORM</span>            <span class="n">HIGH</span>         <span class="n">VERYHIGH</span>
<span class="n">ECUT</span>          <span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>       <span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>    <span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>
<span class="n">ECUT2</span>         <span class="mi">2</span><span class="o">*</span><span class="n">ECUT</span>          <span class="mi">4</span><span class="o">*</span><span class="n">ECUT</span>       <span class="mi">4</span><span class="o">*</span><span class="n">ECUT</span>
<span class="n">ECUT2L</span>        <span class="n">ECUT2</span><span class="p">(</span><span class="n">NCPP</span><span class="p">)</span>     <span class="n">ECUT2</span>        <span class="mi">4</span><span class="o">*</span><span class="n">ECUT2</span>
              <span class="mi">4</span><span class="o">*</span><span class="n">ECUT2</span><span class="p">(</span><span class="n">USPP</span><span class="p">)</span>   <span class="mi">4</span><span class="o">*</span><span class="n">ECUT2</span>      <span class="mi">4</span><span class="o">*</span><span class="n">ECUT2</span>
<span class="n">ECUTP</span>         <span class="n">ECUT</span>            <span class="mi">4</span><span class="o">*</span><span class="n">ECUT</span>       <span class="mi">4</span><span class="o">*</span><span class="n">ECUT</span>
<span class="n">RCUT</span>          <span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>       <span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>    <span class="mf">1.1</span><span class="o">*</span><span class="n">PSP</span><span class="o">/</span><span class="n">INPUT</span>
</pre></div>
</div>
</div>
</li>
<li><p>HSE_DETAIL</p>
<p>HSE_DETAIL = 1.0, 1, 0.0, 6, 1, 1</p>
</li>
<li><p>RELAX_DETAIL</p>
<p>RELAX_DETAIL = 1, 200, 0.02, 0, 0.0, -0.001 (LDA/PBE, ACCURACY=NORM)</p>
<p>RELAX_DETAIL = 1, 200, 0.01, 0, 0.0, -0.001 (LDA/PBE, ACCURACY=HIGH)</p>
<p>RELAX_DETAIL = 1, 200, 0.03, 0, 0.0, -0.001 (HSE)</p>
</li>
<li><p>RELAX_HSE</p>
<p>RELAX_HSE = 20, 0.05, 2</p>
</li>
<li><div class="line-block">
<div class="line">PRECISION</div>
</div>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PRECISION</span>             <span class="n">AUTO</span><span class="p">(</span><span class="n">DEFAULT</span><span class="p">)</span>   <span class="n">DOUBLE</span>         <span class="n">SINGLE</span>         <span class="n">MIX</span>
<span class="n">SCF</span><span class="p">(</span><span class="n">HSE</span><span class="p">)</span>              <span class="n">NCPP</span><span class="p">:</span><span class="n">DOUBLE</span>     <span class="n">NCPP</span><span class="p">:</span><span class="n">DOUBLE</span>    <span class="n">NCPP</span><span class="p">:</span><span class="n">DOUBLE</span>    <span class="n">NCPP</span><span class="p">:</span><span class="n">DOUBLE</span>
                      <span class="n">USPP</span><span class="p">:</span><span class="n">SINGLE</span>     <span class="n">USPP</span><span class="p">:</span><span class="n">SINGLE</span>    <span class="n">USPP</span><span class="p">:</span><span class="n">SINGLE</span>    <span class="n">USPP</span><span class="p">:</span><span class="n">SINGLE</span>
<span class="n">RELAX_HSE</span><span class="p">(</span><span class="n">NUM_LDA</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>  <span class="n">LDA</span><span class="p">:</span><span class="n">SINGLE</span>      <span class="n">LDA</span><span class="p">:</span><span class="n">DOUBLE</span>     <span class="n">LDA</span><span class="p">:</span><span class="n">SINGLE</span>     <span class="n">LDA</span><span class="p">:</span><span class="n">MIX</span>
                      <span class="n">HSE</span><span class="p">:</span><span class="n">DOUBLE</span>      <span class="n">HSE</span><span class="p">:</span><span class="n">DOUBLE</span>     <span class="n">HSE</span><span class="p">:</span><span class="n">DOUBLE</span>     <span class="n">HSE</span><span class="p">:</span><span class="n">DOUBLE</span>
<span class="n">SCF</span><span class="p">,</span><span class="n">RELAX</span><span class="p">(</span><span class="n">LDA</span><span class="o">/</span><span class="n">GGA</span><span class="p">)</span>    <span class="n">SINGLE</span>          <span class="n">DOUBLE</span>         <span class="n">SINGLE</span>         <span class="n">MIX</span>
</pre></div>
</div>
</div>
</li>
</ol>
</div>
<div class="section" id="atom-config">
<span id="section-atom-config"></span><h2>atom.config<a class="headerlink" href="#atom-config" title="Permalink to this headline">¶</a></h2>
<p>This file describes the supercell box, atomic positions, (optionally)
the atomic force, atomic velocity, atomic magnetic (collinear or
non-collinear magnetic moment), langevin_atomfact_tg, stress_mask,
stress_external, ptensor_external of the system. It has the following
format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">64</span>
<span class="n">LATTICE</span>
<span class="mf">0.1084993850E+02</span> <span class="mf">0.0000000000E+00</span> <span class="mf">0.0000000000E+00</span>
<span class="mf">0.0000000000E+00</span> <span class="mf">0.1084993850E+02</span> <span class="mf">0.0000000000E+00</span>
<span class="mf">0.0000000000E+00</span> <span class="mf">0.0000000000E+00</span> <span class="mf">0.1084993850E+02</span>
<span class="n">POSITION</span>
<span class="mi">30</span>  <span class="mf">0.952534560</span>  <span class="mf">0.363594470</span>  <span class="mf">0.382027650</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">30</span>  <span class="mf">0.540553000</span>  <span class="mf">0.850230410</span>  <span class="mf">0.966359450</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="o">...</span>
<span class="mi">16</span>  <span class="mf">0.242857140</span>  <span class="mf">0.140553000</span>  <span class="mf">0.684331800</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="n">FORCE</span> <span class="c1"># optional</span>
<span class="mi">30</span> <span class="o">-</span><span class="mf">0.060040948</span>  <span class="mf">0.097096690</span>  <span class="mf">0.063013193</span>
<span class="mi">30</span>  <span class="mf">0.001068674</span> <span class="o">-</span><span class="mf">0.002521614</span>  <span class="mf">0.000147553</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="o">-</span><span class="mf">0.007955164</span> <span class="o">-</span><span class="mf">0.008758074</span>  <span class="mf">0.029047748</span>
<span class="n">VELOCITY</span> <span class="c1"># optional</span>
<span class="mi">30</span>  <span class="mf">0.02339881</span>  <span class="o">-</span><span class="mf">0.287387433</span> <span class="o">-</span><span class="mf">0.109339839</span>
<span class="mi">30</span> <span class="o">-</span><span class="mf">0.23878474</span>  <span class="o">-</span><span class="mf">0.210836551</span>  <span class="mf">0.049311111</span>
<span class="o">...</span>
<span class="mi">16</span>  <span class="mf">0.53761771</span>  <span class="o">-</span><span class="mf">0.023987172</span>  <span class="mf">0.288399911</span>
<span class="n">MAGNETIC</span> <span class="c1"># optional, initial magnetic moment</span>
<span class="mi">30</span> <span class="mi">2</span>
<span class="mi">30</span> <span class="mi">2</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="mi">0</span>
<span class="n">CONSTRAINT_MAG</span> <span class="c1"># optional, to constraint magnetic moment</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="mf">0.01</span>      <span class="c1"># mag,alpha (mag: desired magnetic moment)</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="mf">0.01</span>      <span class="c1"># mag,alpha (alpha: penalty coeff, eV)</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="mi">0</span> <span class="mf">0.00</span>
<span class="n">MAGNETIC_XYZ</span> <span class="c1"># specially for non-collinear magnetic systems</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">LANGEVIN_ATOMFACT_TG</span> <span class="c1"># special for Lagenvin MD, factor for atomic temp and gamms</span>
<span class="mi">30</span>  <span class="mf">1.0</span>   <span class="mf">1.0</span>
<span class="mi">30</span>  <span class="mf">0.5</span>   <span class="mf">1.0</span>
<span class="o">...</span>
<span class="mi">16</span>  <span class="mf">0.5</span>   <span class="mf">0.5</span>
<span class="n">STRESS_MASK</span> <span class="c1"># optional</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="n">STRESS_EXTERNAL</span> <span class="c1"># optional</span>
<span class="mf">0.1</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.1</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.1</span>
<span class="n">PTENSOR_EXTERNAL</span> <span class="c1"># optional</span>
<span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>They have the following meanings:</p>
<p><strong>Natom</strong>: the number of atoms in the system, as a result, Position,
Force, Velocity, Magnetic sections will all have Natom lines, each atom
per line.</p>
<p><strong>LATTICE</strong>: The header of the lattice vector AL(3,3) section. There
will be three lines following Lattice vector:</p>
<p>AL(1,1), AL(2,1), AL(3,1) (the 1st vector of the super cell edge in Å)</p>
<p>AL(1,2), AL(2,2), AL(3,2) (the 2nd vector of the super cell edge in Å)</p>
<p>AL(1,3), AL(2,3), AL(3,3) (the 3rd vector of the super cell edge in Å)</p>
<p><strong>POSITION</strong>: the header of the atomic positions of the system. There
will be Natom lines following Position, each line describe the position
of one atom, in the following form:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Zatom</span>  <span class="n">x1</span>      <span class="n">x2</span>       <span class="n">x3</span>       <span class="n">imv1</span>  <span class="n">imv2</span>  <span class="n">imv3</span>
<span class="mi">30</span>     <span class="mf">0.2293</span>  <span class="mf">0.59822</span>  <span class="mf">0.44444</span>  <span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">1</span>
</pre></div>
</div>
</div>
<p><strong>ZATOM</strong> is the atomic number of this atom, x1, is the fractional
coordinate of this atom in the unit of AL(:,1); x2, x3 are the
fractional coordinates of this atom in the units of AL(:,2), AL(:,3).
“imv1, imv2, imv3” indicates in the atomic relaxation, whether this atom
will move in x, y, z (note not the x1, x2, x3) directions. Imv1 (2, 3) =
1, move; 0, not move.</p>
<p>Note the x, y, z coordinates of this atom can be calculated as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
        X &amp;= AL(1,1)*x_1 + AL(1,2)*x_2 + AL(1,3)*x_3\\
        Y &amp;= AL(2,1)*x_1 + AL(2,2)*x_2 + AL(2,3)*x_3\\
        Z &amp;= AL(3,1)*x_1 + AL(3,2)*x_2 + AL(3,3)*x_3
    \end{aligned}\end{split}\]</div>
<p><strong>FORCE</strong>: The header of the force section. This section is optional. It
will be followed by natom lines in the following form:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span>   <span class="n">f_y</span><span class="p">,</span>     <span class="n">f_z</span>
<span class="mi">30</span>     <span class="mf">0.0372</span> <span class="mf">0.01112</span> <span class="o">-</span><span class="mf">0.1021</span>
</pre></div>
</div>
</div>
<p>They are the x, y, z direction atomic forces in
<span class="math notranslate nohighlight">\(eV/{\textup{\AA}}\)</span>.</p>
<p><strong>VELOCITY</strong>: The header of the velocity section. This section is
optional. If will be followed by natom lines in the following form:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span><span class="p">,</span> <span class="n">v_x</span><span class="p">,</span>    <span class="n">v_y</span><span class="p">,</span>      <span class="n">v_z</span>
<span class="mi">30</span>     <span class="mf">0.39292</span> <span class="o">-</span><span class="mf">0.222933</span> <span class="mf">0.28211</span>
</pre></div>
</div>
</div>
<p>They are the x, y, z direction atomic velocity in <span class="math notranslate nohighlight">\(Bohr/fs\)</span>.</p>
<p><strong>MAGNETIC</strong>: The header of the magnetic section. This tag specify the
initial collinear magnetic moment for each atom when SPIN = 2. It will
be followed by natom lines in the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span> <span class="n">spin</span>
<span class="mi">30</span>    <span class="mi">2</span>
</pre></div>
</div>
</div>
<p>2 is the magnetic moment: 0 is no spin, the negative is spin down, the
positive is spin up.</p>
<p><strong>CONSTRAINT_MAG</strong>: The header of the constraint magnetic moment
section. This tag specifies the desired magnetic moment, and a penalty
coefficient to enforce the system to have such magnetic moment. This
only works for spin=2. It will be followed by natom lines in the
following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span> <span class="n">spin</span><span class="p">,</span><span class="n">alpha</span>
<span class="mi">30</span>    <span class="mi">2</span>    <span class="mf">0.01</span>
</pre></div>
</div>
</div>
<p>2 is the desired magnetic moment to force the atom to have: 0.01 is the
alpha coefficient (in the unit of eV) for the penalty term. Smaller this
alpha, less the enforcement. Note, if alpha is too large, the SCF
iteration might not converge.</p>
<p><strong>MAGNETIC_XYZ</strong>: The header of the non-collinear magnetic systems
section when spin = 222. It specifify the initial magnetic moment for
each atom. If will be followed by natom lines in the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span> <span class="n">spin_x</span> <span class="n">spin_y</span> <span class="n">spin_z</span>
<span class="mi">30</span>    <span class="mi">2</span>      <span class="mi">0</span>      <span class="mi">0</span>
</pre></div>
</div>
</div>
<p><strong>LANGEVIN_ATOMFACT_TG</strong>: The multiplication scaling factors for the
atomic temperatute and the gamma parameter in the Langevin molecular
dynamics. Here, in Langevin MD, we provide an option which one can tune
the temperature of each atom by providing these atomic scaling factor.
The temperature for each atom is determined by the overall desired
temperature defined by the MD_DETAIL line, multiplied by the atomic
scaling factor provided here. Similarly, the gamma parameter in the
Langevin dynamics is also determined by the global gamma factor defined
in IN.MDOPT (or its default values) multiplied by the Gamma scaling
factor provided here. Note, if this section is not provided, the default
scaling factors are 1.d0 The local temperature is maintained by
providing atomic temperature proportional atomic random force. The rate
of the local temperature dissipation is controlled by the gamma(i) term
defined in dV/dt= F(i)-gamma(i)*V(i)+F_random(i). Larger the gamma(i),
faster it reaches its desired temperature. However, note, the heat
injection from the random force will be diffused into nearby atoms. So,
one has to adjust fact_temp(i), and fact_gamma(i) to get the desired
results.</p>
<p>This section title will be followed by natom lines in the following
format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zatom</span> <span class="n">fact_temp</span><span class="p">,</span> <span class="n">fact_gamma</span>
<span class="mi">30</span>    <span class="mf">0.8</span>         <span class="mf">0.9</span>
</pre></div>
</div>
</div>
<p><strong>STRESS_MASK</strong>: used to multiply to the stress tenser for cell
relaxation(and constant pressure molecular dynamics), so some directions
of the cell can be fixed. For example, if you want to optimize the
lattice of two-dimensional materials, and vacuum direction is along z,
STRESS_MASK can be set as follows:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STRESS_MASK</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<p><strong>STRESS_EXTERNAL</strong>: used to add an external stress tensor for cell
relaxation, its unit is eV/Natom. Definition of stress tensor is
<span class="math notranslate nohighlight">\(\sigma_{ij}=\frac{1}{Natom}\frac{\partial E_{tot}}{\partial \epsilon_{ij}}\)</span>.
After cell relaxation: <span class="math notranslate nohighlight">\(STRESS+STRESS\_EXTERNAL \to 0\)</span></p>
<p><strong>PTENSOR_EXTERNAL</strong>: used to add an external stress tensor for cell
relaxation, its unit is Gpa. Definition is
<span class="math notranslate nohighlight">\(\sigma_{ij}=\frac{1}{Volume of Cell}\frac{\partial E_{tot}}{\partial \epsilon_{ij}}\)</span>.After
cell relaxation:
<span class="math notranslate nohighlight">\(STRESS+PTENSOR\_EXTERNAL * (Volume of Cell) / Natom \to 0\)</span></p>
<p>Note, the atom.config file can be converted from other format (.xyz,
.xsf) file, using: “<span class="math notranslate nohighlight">\(&gt;\)</span>convert_to_config <span class="math notranslate nohighlight">\(&lt;\)</span> system.xyz
(or xsf)”. It will generate a system.config file. The atom.config file
can also be converted into .xyz, .xsf file using
“<span class="math notranslate nohighlight">\(&gt;\)</span>convert_from_config <span class="math notranslate nohighlight">\(&lt;\)</span> xatom.config”. It will
generate the atom.xyz, and atom.xsf files.</p>
<p>Under JOB=NEB, in NEB_DETAIL line, if itype_at2=1, then atom2.config
contains the atomic configuration of the second minimum (for NEB
algorithm), while the atom.config in the IN.ATOM=atom.config contains
the first minimum atomic configuration, and Nimage image configurations
(points) will be created between these two fixed atomic configurations.
Note, the atom.config and atom2.config must have the same atom orders.
If itype_at2=2, the atom.config in IN.ATOM=atom.config is no longer used
(although it still need to be presented in etot.input), and the
atom2.config must contains Nimage+2 configurations (two ends plus Nimage
images). Besides, it must also has a fixed form for each configurations:
Natom; Lattice; Position; Force; “<code class="docutils literal notranslate"><span class="pre">------</span></code>” line. In practice, this
atom2.config is often copied from MOVEMENT from previous NEB runs.</p>
</div>
<div class="section" id="pseudo-potential-files-atom-xxxx-upf">
<h2>Pseudo-potential files: Atom.XXXX.UPF<a class="headerlink" href="#pseudo-potential-files-atom-xxxx-upf" title="Permalink to this headline">¶</a></h2>
<p>They are the files copied from the provided libraries. The default Ecut
(wfc_cuttoff) is provided in those files. They are ASCII files, thus can
be read. In the execution of PWmat, the corresponding pseudopotential
files indicated in etot.input must be copied to the running directory.
The UPF is the format developed in Quantum Espresso. Currently, PWmat
can use norm-conserving pseudopotential, or ultrasoft pseudopotential.
There are many groups developing pseudopotentials, and most of them are
in the UPF format. You can get pseudopotential libraries from PWmat
website: <a class="reference external" href="http://www.pwmat.com/potential-download">http://www.pwmat.com/potential-download</a>, and there are some
comments about different pseudopotentials, which may help to choose the
right pseudopotentials.</p>
</div>
<div class="section" id="in-kpt-out-kpt">
<span id="section-in-kpt"></span><h2>IN.KPT(OUT.KPT)<a class="headerlink" href="#in-kpt-out-kpt" title="Permalink to this headline">¶</a></h2>
<p>The file “IN.KPT” (“OUT.KPT”, please see MP_N123 ) contains the k-point
vectors and their weights. Now PWmat can also read MP_N123 to generate
OUT.KPT for calculation.</p>
<p>Note that, for JOB=NEB calculation, very often the image configuration
along the path might have lower symmetry than the one at the initial
minimum (in IN.ATOM=atom.config). Since symmetry is generated based on
atom.config, one must use a general (not highly symmetric) atom.config
when generating IN.SYMM and IN.KPT for NEB calculations.</p>
<p>Finally, the IN.KPT can also be edited by hand. It has the following
format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>                      <span class="c1"># nkpt</span>
<span class="mi">2</span> <span class="mf">1.0000</span>               <span class="c1"># iflag, a0</span>
<span class="mf">0.250</span> <span class="mi">0</span><span class="p">,</span><span class="mi">250</span> <span class="mf">0.250</span> <span class="mf">0.25</span> <span class="c1"># ak1, ak2, ak3, weight</span>
<span class="mf">0.250</span> <span class="mf">0.250</span> <span class="mf">0.750</span> <span class="mf">0.75</span>
</pre></div>
</div>
</div>
<p><strong>nkpt</strong>: The number of k-points.</p>
<p><strong>iflag</strong>:</p>
<ol class="arabic simple">
<li><p>iflag = 1, the k-points are in x, y, z directions (which is defined
by the x, y, z in AL(3,3) in “atom.config”).</p></li>
<li><p>iflag = 2, the k-points are in the reciprocal lattice of the super
cell AL(3,3). “<span class="math notranslate nohighlight">\(a_0\)</span>” will not be used.</p></li>
</ol>
<p><strong>a:math:`_0`</strong>: only used when iflag = 1. (in atomic unit
<span class="math notranslate nohighlight">\(Bohr\)</span>)</p>
<p><strong>ak1,ak2,ak3</strong>:</p>
<ol class="arabic">
<li><p>iflag = 1, the k-points are defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
            k_x &amp;= 2 * \pi * ak_1 / a_0\\
            k_y &amp;= 2 * \pi * ak_2 / a_0\\
            k_z &amp;= 2 * \pi * ak_3 / a_0
        \end{aligned}\end{split}\]</div>
</li>
<li><p>iflag = 2, the k-points are defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
            k = G_1*ak_1 + G_2*ak_2 + G_3*ak_3
        \end{aligned}\]</div>
<p>Here <span class="math notranslate nohighlight">\(G_1\)</span>, <span class="math notranslate nohighlight">\(G_2\)</span>, <span class="math notranslate nohighlight">\(G_3\)</span> are the reciprocal lattice
vector of lattice AL(3,3).</p>
</li>
</ol>
<p><strong>weight</strong>: This is the weight of this reduced k-point (it can represent
several symmetric k-points). This is used for SCF calculations, and the
total weight as the sum of individual k-points should be 1.</p>
</div>
<div class="section" id="in-symm-out-symm">
<span id="section-in-symm"></span><h2>IN.SYMM(OUT.SYMM)<a class="headerlink" href="#in-symm-out-symm" title="Permalink to this headline">¶</a></h2>
<p>This is the symmetry operation file. PWmat will use MP_N123 to generate
“OUT.SYMM” for calculations. It contains the space group. It has the
following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">12</span> <span class="mi">24</span> <span class="o">|</span> <span class="n">nsym</span><span class="p">,</span> <span class="n">nrot</span>
<span class="s2">&quot;identity and corresponding fractional translation &quot;</span>
<span class="mi">1</span>   <span class="mi">0</span>   <span class="mi">0</span>
<span class="mi">0</span>   <span class="mi">1</span>   <span class="mi">0</span>
<span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">1</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="mf">0.000</span>
<span class="s2">&quot;180 deg rotation - cart. axis [0,0,1]...&quot;</span>
<span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>   <span class="mi">0</span>
<span class="mi">0</span> <span class="o">-</span><span class="mi">1</span>   <span class="mi">0</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mf">0.000</span> <span class="mf">0.000</span> <span class="o">-</span><span class="mf">0.500</span>
<span class="o">...</span>
<span class="mi">180</span> <span class="n">deg</span> <span class="n">rotation</span> <span class="o">-</span> <span class="n">cryst</span><span class="o">.</span> <span class="n">axis</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="o">-</span><span class="mi">1</span>  <span class="mi">1</span>  <span class="o">-</span><span class="mi">1</span>
 <span class="mi">0</span>  <span class="mi">1</span>   <span class="mi">0</span>
 <span class="mi">0</span>  <span class="mi">0</span>  <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<p>The first line is the two variables: “nsym” and “nrot”. “nsym” is the
number of the crystal symmetries operations (space group) and “nrot” is
the number of the crystal Bravais lattice symmetries (only for the
lattice, not considering the atoms, thus nrot is always larger than
nsym). For PWmat, only nsym is used. For the rest of the file, there
will be “nsym” operations, each has this following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;180 deg rotation - cart. axis [0,0,1]...&quot;</span>
<span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>            <span class="c1"># s(1,1), s(2,1), s(3,1)</span>
 <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>            <span class="c1"># s(1,2), s(2,2), s(3,2)</span>
 <span class="mi">0</span>  <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span>            <span class="c1"># s(1,3), s(2,3), s(3,3)</span>
 <span class="mf">0.000</span> <span class="mf">0.000</span> <span class="o">-</span><span class="mf">0.500</span> <span class="c1"># l(1), l(2), l(3)</span>
</pre></div>
</div>
</div>
<p>The first line is the explanation of this symmetry operation. The
following three line defines the point group rotation matrix
<span class="math notranslate nohighlight">\(s(3,3)\)</span> around the origin (<span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span>
= 0, 0, 0) point. The rotation <span class="math notranslate nohighlight">\(s(3,3)\)</span> will convert a real space
point (<span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span>) (in lattice cell
fractional coordination) into another point following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    y_1 &amp;= s(1,1)*x_1 + s(2,1)*x_2 + s(3,1)*x_3\\
    y_2 &amp;= s(1,2)*x_1 + s(2,2)*x_2 + s(3,2)*x_3\\
    y_3 &amp;= s(1,3)*x_1 + s(2,3)*x_2 + s(3,3)*x_3\end{aligned}\end{split}\]</div>
<p>The next line defines the fractional translation in the space group.
Thus we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    y_1 &amp;= y_1 + l(1)\\
    y_2 &amp;= y_2 + l(2)\\
    y_3 &amp;= y_3 + l(3)\end{aligned}\end{split}\]</div>
</div>
<div class="section" id="other-input-files">
<h2>Other input files<a class="headerlink" href="#other-input-files" title="Permalink to this headline">¶</a></h2>
<p>One might use other input files, e.g., IN.WG (wave function input file),
IN.RHO (charge density input file), IN.VR (potential input file),
IN.VEXT (external potential file). These are usually generated from the
previous SCF calculations (e.g., can be copied over from the
corresponding OUT.XXX files). They are binary files. The internal format
for wave function file IN.WG is complicated, it is the wave functions in
G-space, we usually do not view it, only copy it from OUT.WG to IN.WG
for next run. For IN.RHO, IN.VR, IN.VEXT, internally, it has the
following format (can be written or read out like this):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WRITE</span> <span class="p">(</span><span class="n">IN</span><span class="o">.</span><span class="n">XX</span><span class="p">)</span> <span class="n">N1L</span><span class="p">,</span> <span class="n">N2L</span><span class="p">,</span> <span class="n">N3L</span><span class="p">,</span> <span class="n">NODE1</span>
<span class="n">WRITE</span> <span class="p">(</span><span class="n">IN</span><span class="o">.</span><span class="n">XX</span><span class="p">)</span> <span class="n">AL</span>
<span class="n">DO</span> <span class="n">IPROC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NODE1</span>
    <span class="n">WRITE</span> <span class="p">(</span><span class="n">IN</span><span class="o">.</span><span class="n">XX</span><span class="p">)</span> <span class="p">(</span><span class="n">VR</span><span class="p">(</span><span class="n">IR</span><span class="o">+</span><span class="n">NR_NL</span><span class="o">*</span><span class="p">(</span><span class="n">IPROC</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span><span class="n">IR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NR_NL</span><span class="p">)</span>
<span class="n">END</span> <span class="n">DO</span>
</pre></div>
</div>
</div>
<p>NR_NL = N1L*N2L*N3L/NODE1. <span class="math notranslate nohighlight">\(V_r(ii)\)</span> is a 1D-array form of
<span class="math notranslate nohighlight">\(V_r(i,j,k)\)</span> where <span class="math notranslate nohighlight">\(ii\)</span> to <span class="math notranslate nohighlight">\((i,j,k)\)</span> correspondence
as:</p>
<p><span class="math notranslate nohighlight">\(ii = (i-1)*n2L*n3L + (j-1)*n3L + k\)</span>.</p>
</div>
</div>
<div class="section" id="output-files">
<h1>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="standard-output">
<h2>Standard output<a class="headerlink" href="#standard-output" title="Permalink to this headline">¶</a></h2>
<p>Standard (on-screen) output contains the verbose information of each SCF
calculation. Standard output has almost all the information for PWmat,
but it might be messy to read. If we use: “<span class="math notranslate nohighlight">\(&gt;\)</span>mpirun –np num
PWmat <span class="math notranslate nohighlight">\(&gt;\)</span> out &amp;” to run our job, the standard output will be
stored in the file “out”.</p>
</div>
<div class="section" id="report">
<h2>REPORT<a class="headerlink" href="#report" title="Permalink to this headline">¶</a></h2>
<p>The “REPORT” file contains the most useful information in a concise way
for the run. It might have the following format, with the corresponding
explanation given in blue.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">1 4</div>
<div class="line">PRECISION = AUTO</div>
<div class="line">JOB = RELAX</div>
<div class="line">IN.PSP1 = Si.SG15.PBE.UPF</div>
<div class="line">IN.ATOM = atom.config</div>
<div class="line">CONVERGENCE = EASY</div>
<div class="line">ACCURACY = NORM</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">RELAX_DETAIL</span> <span class="pre">=</span> <span class="pre">1</span>&#160; <span class="pre">200</span>&#160; <span class="pre">0.10000E-01</span>&#160; <span class="pre">0</span>&#160; <span class="pre">0.00000E+00</span>&#160;&#160; <span class="pre">-0.10000E-02</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">VFF_DETAIL</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">500</span> <span class="pre">0.50000000E-02</span> <span class="pre">30.00000</span> <span class="pre">4.00000</span> <span class="pre">0.00000</span> <span class="pre">1.00000</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">EGG_DETAIL</span> <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3</span></code></div>
<div class="line">IN.RELAXOPT = F</div>
<div class="line">SPIN = 1</div>
<div class="line">CONSTRAINT_MAG = 0</div>
<div class="line">QIJ_DETAIL = 0 1</div>
<div class="line">PWSCF_OUTPUT = F</div>
<div class="line">Ecut = 50.0000000000000</div>
<div class="line">Ecut2 = 200.000000000000</div>
<div class="line">Ecut2L = 200.000000000000</div>
<div class="line">EcutP = 50.0000000000000</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">N123</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160; <span class="pre">36</span>&#160;&#160;&#160; <span class="pre">36</span>&#160;&#160;&#160; <span class="pre">36</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NS123</span>&#160;&#160;&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160; <span class="pre">70</span>&#160;&#160;&#160; <span class="pre">70</span>&#160;&#160;&#160; <span class="pre">70</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">N123L</span>&#160;&#160;&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160; <span class="pre">36</span>&#160;&#160;&#160; <span class="pre">36</span>&#160;&#160;&#160; <span class="pre">36</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">MP_N123</span> <span class="pre">=8</span> <span class="pre">8</span> <span class="pre">8</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">STRESS_CORR</span> <span class="pre">=</span>&#160;&#160; <span class="pre">0.100000E+01</span>&#160; <span class="pre">0.000000E+00</span>&#160; <span class="pre">0.200000E+01</span>&#160; <span class="pre">0.000000E+00</span></code></div>
<div class="line">XCFUNCTIONAL = PBE</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">HSE_DETAIL</span>&#160;&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">1.00000000</span>&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000000</span>&#160;&#160;&#160; <span class="pre">6</span> <span class="pre">1</span> <span class="pre">1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">RELAX_HSE</span>&#160;&#160;&#160; <span class="pre">=</span>&#160;&#160;&#160; <span class="pre">20</span>&#160;&#160; <span class="pre">0.50000E-01</span>&#160;&#160;&#160;&#160; <span class="pre">2</span></code></div>
<div class="line">VDW = NONE</div>
<div class="line">LONDON_S6 = 0.000000000000000E+000</div>
<div class="line">LONDON_C6(1) = -1.00000000000000</div>
<div class="line">LONDON_RCUT = 0.000000000000000E+000</div>
<div class="line">DFTD3_S6 = 1.00000000000000</div>
<div class="line">DFTD3_RS6 = 1.21700000000000</div>
<div class="line">DFTD3_S18 = 0.722000000000000</div>
<div class="line">DFTD3_RS18 = 1.00000000000000</div>
<div class="line">DFTD3_ALPHA6 = 14.0000000000000</div>
<div class="line">DFTD3_VERSION = 3</div>
<div class="line">DFTD3_3BODY = T</div>
<div class="line">COULOMB = 0</div>
<div class="line">IN.WG = F</div>
<div class="line">OUT.WG = T</div>
<div class="line">IN.RHO = F</div>
<div class="line">OUT.RHO = T</div>
<div class="line">IN.VR = F</div>
<div class="line">OUT.VR = T</div>
<div class="line">IN.VEXT = F</div>
<div class="line">OUT.VATOM = F</div>
<div class="line">OUT.REAL.RHOWF_SP= 0</div>
<div class="line">OUT.FORCE = T</div>
<div class="line">OUT.STRESS = F</div>
<div class="line">IN.SYMM = T</div>
<div class="line">NUM_KPT = 29</div>
<div class="line">CHARGE_DECOMP = F</div>
<div class="line">ENERGY_DECOMP = F</div>
<div class="line">IN.SOLVENT = F</div>
<div class="line">NUM_ELECTRON = 8.00000000000000</div>
<div class="line">IN.NONSCF = F</div>
<div class="line">NUM_BAND = 14</div>
<div class="line">WG_ERROR = 1.000000000000000E-004</div>
<div class="line">E_ERROR = 2.176910881600000E-005</div>
<div class="line">RHO_ERROR = 5.000000000000000E-005</div>
<div class="line">RHO_RELATIVE_ERROR = 7.000000000000001E-002</div>
<div class="line">FORCE_RELATIVE_ERROR = 0.000000000000000E+000</div>
<div class="line">SYS_TYPE = 1</div>
<div class="line">IN.OCC = F -1</div>
<div class="line">IN.CC = F</div>
<div class="line">IN.OCC_ADIA = F</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">SCF_ITER0_1</span> <span class="pre">=</span>&#160;&#160;&#160; <span class="pre">6</span>&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160; <span class="pre">0.0000</span>&#160;&#160;&#160;&#160; <span class="pre">0.02500</span>&#160;&#160;&#160; <span class="pre">1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">SCF_ITER0_2</span> <span class="pre">=</span>&#160;&#160; <span class="pre">94</span>&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160; <span class="pre">1.0000</span>&#160;&#160;&#160;&#160; <span class="pre">0.02500</span>&#160;&#160;&#160; <span class="pre">1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">SCF_ITER1_1</span> <span class="pre">=</span>&#160;&#160; <span class="pre">40</span>&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160; <span class="pre">1.0000</span>&#160;&#160;&#160;&#160; <span class="pre">0.02500</span>&#160;&#160;&#160; <span class="pre">1</span></code></div>
<div class="line">NONLOCAL = 2</div>
<div class="line">RCUT = 3.20000000000000</div>
<div class="line">IN.PSP_RCUT1 = 3.20000000000000</div>
<div class="line">MD_VV_SCALE = 100</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">LDAU_PSP1</span>&#160;&#160; <span class="pre">=</span>&#160; <span class="pre">-1</span>&#160; <span class="pre">2.721138638331097E-009</span>&#160; <span class="pre">2.721138638331097E-009</span>&#160; <span class="pre">eV</span></code></div>
<div class="line">NUM_BLOCKED_PSI= F</div>
<div class="line">WF_STORE2DISK = 0</div>
<div class="line">NUM_DOS_GRID = 4000</div>
<div class="line">NMAP_MAX = 50000</div>
<div class="line">KERK_AMIN = 0.300000000000000</div>
<div class="line">KERK_AMIX = 0.400000000000000</div>
<div class="line">KERK_AMIX_MAG = 1.00000000000000</div>
<div class="line">KERK_BMIX = 0.500000000000000</div>
<div class="line">LDAU_MIX = 0.700000000000000</div>
<div class="line">PULAY_WEIGHT_SPIN = 1.00000000000000</div>
<div class="line">PULAY_WEIGHT_NS = 1.00000000000000</div>
<div class="line">OUT.MLMD = F</div>
<div class="line">NUM_MPI_PER_GPU = 1</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">K-point:</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">29</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00195</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.07653</span>&#160;&#160;&#160; <span class="pre">0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.01562</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.01562</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.22958</span>&#160;&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160;&#160; <span class="pre">0.01562</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.00781</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.01172</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.07653</span>&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.22958</span>&#160;&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160; <span class="pre">0.38263</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.38263</span>&#160;&#160;&#160;&#160; <span class="pre">0.38263</span>&#160;&#160;&#160; <span class="pre">0.53568</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.02344</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.01172</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.07653</span>&#160;&#160;&#160; <span class="pre">0.38263</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.22958</span>&#160;&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160; <span class="pre">0.53568</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.02344</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.01172</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.07653</span>&#160;&#160;&#160; <span class="pre">0.53568</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.02344</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.00000</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.00586</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160; <span class="pre">0.38263</span>&#160;&#160;&#160;&#160; <span class="pre">0.09375</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.45916</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.07653</span>&#160;&#160;&#160;&#160; <span class="pre">0.22958</span>&#160;&#160;&#160; <span class="pre">0.53568</span>&#160;&#160;&#160;&#160; <span class="pre">0.09375</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.15305</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.04688</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.15305</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.02344</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.00000</span>&#160;&#160;&#160;&#160; <span class="pre">0.30611</span>&#160;&#160;&#160; <span class="pre">0.61221</span>&#160;&#160;&#160;&#160; <span class="pre">0.01172</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">------------------------------------------------</span></code></div>
<div class="line">*********************************************</div>
<div class="line">*********** end of etot.input report ********</div>
<div class="line">minimum n1,n2,n3 from Ecut2</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">32.668</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">32.668</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">32.668</span></code></div>
<div class="line">minimum n1L,n2L,n3L from Ecut2L</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">32.668</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">32.668</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">32.668</span></code></div>
<div class="line">*********************************************</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Weighted</span> <span class="pre">average</span> <span class="pre">num_of_PW</span> <span class="pre">for</span> <span class="pre">all</span> <span class="pre">kpoint=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1614.291</span></code></div>
<div class="line">************************************</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">E_Hxc(eV)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-50.3360515430143</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">E_ion(eV)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-70.7758020324849</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">E_Coul(eV)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">15.7159812114520</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">E_Hxc+E_ion(eV)</span>&#160; <span class="pre">-121.111853575499</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NONSCF</span>&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AVE_STATE_ERROR=</span> <span class="pre">0.2502E+01</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NONSCF</span>&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AVE_STATE_ERROR=</span> <span class="pre">0.1139E+00</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NONSCF</span>&#160;&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AVE_STATE_ERROR=</span> <span class="pre">0.7470E-02</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NONSCF</span>&#160;&#160;&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AVE_STATE_ERROR=</span> <span class="pre">0.2787E-03</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NONSCF</span>&#160;&#160;&#160;&#160; <span class="pre">5</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">AVE_STATE_ERROR=</span> <span class="pre">0.1178E-04</span></code></div>
<div class="line">iter= 7 ave_lin= 3.5 iCGmth= 3</div>
<div class="line">Ef(eV) = 0.7661625E+01</div>
<div class="line">err of ug = 0.5951E-07</div>
<div class="line">dv_ave, drho_tot = 0.0000E+00 0.1150E+00</div>
<div class="line">E_tot = -.21438186533335E+03 -.2144E+03</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">------------------------------</span></code></div>
<div class="line">…</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">------------------------------</span></code></div>
<div class="line">iter= 13 ave_lin= 2.0 iCGmth= 3</div>
<div class="line">Ef(eV) = 0.7534412E+01</div>
<div class="line">err of ug = 0.3069E-05</div>
<div class="line">dv_ave, drho_tot = 0.7833E-03 0.8271E-04</div>
<div class="line">E_tot = -.21450877234593E+03 -.6187E-05</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line">E_Fermi(eV)= 7.53441246287097</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line">Ef(eV) = 0.7534412E+01</div>
<div class="line">dvE, dvE(n)-dvE(n-1) = 0.6136E-06 -.6254E-06</div>
<div class="line">dv_ave, drho_tot = 0.7833E-03 0.8271E-04</div>
<div class="line">err of ug = 0.3069E-05</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line">ending_scf_reason = tol Etot_err 2.176910881600000E-005</div>
<div class="line">Ewald = -.22851918665832E+03</div>
<div class="line">Alpha = -.82589820281155E+01</div>
<div class="line">E_extV = 0.00000000000000E+00 0.0000E+00</div>
<div class="line">E_NSC = 0.17584653226505E+02 -.1047E-01</div>
<div class="line">E[-rho*V_Hxc]= 0.55177198633373E+02 0.1047E-01</div>
<div class="line">E_Hxc = -.50492455446920E+02 -.5492E-02</div>
<div class="line">-TS = -.72446553375796E-07 -.3101E-09</div>
<div class="line">E_tot(eV) = -.21450877234593E+03 -.6187E-05</div>
<div class="line">E_tot(Ryd) = -.15766104099826E+02 -.2274E-06</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line">occup for: kpt=1,spin=1,m=(totN/2-2,totN/2+2) 1.000 1.000 1.000
0.000 0.000 eigen(eV) for: kpt=1,spin=1,m=(totN/2-2,totN/2+2)
7.245 7.245 7.245 9.802 9.802
<code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">E_Hart,E_xc,E_ion</span> <span class="pre">=0.15028296881420E+02</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-.65520752328340E+02</span>&#160; <span class="pre">-.62726190797084E+02</span></code></div>
<div class="line">E_Hxc+E_ion =-.11321864624400E+03</div>
<div class="line">E_kin+E_nonloc =0.13548804265696E+03</div>
<div class="line">E_rhoVext,E_IVext =0.00000000000000E+00 0.00000000000000E+00</div>
<div class="line">E_psiV,E_dDrho =-.11790779330926E+03 0.00000000000000E+00</div>
<div class="line">ave(vtot):v0 =-.89820491030616E+01</div>
<div class="line">ave(V_ion_s(or p,d))=ave(V_Hatree)=0; ave(Vtot)=ave(V_xc)=v0</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------</span></code></div>
<div class="line">**</div>
<div class="line">**</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">RESULT:</span> <span class="pre">atom_move_step,</span> <span class="pre">E_tot:</span>&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160; <span class="pre">-0.214508772345929E+03</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">****</span> <span class="pre">finished</span> <span class="pre">input</span> <span class="pre">atom</span> <span class="pre">config</span> <span class="pre">calc.</span>&#160; <span class="pre">***</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">****</span> <span class="pre">following</span> <span class="pre">are</span> <span class="pre">atomic</span>&#160; <span class="pre">relaxation</span>&#160; <span class="pre">***</span></code></div>
<div class="line">**</div>
<div class="line">**</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">force\_max,stress</span> <span class="pre">.lt.</span> <span class="pre">tolforce,tol\_stress</span> <span class="pre">finished</span></code></div>
<div class="line">*********************************</div>
<div class="line">Eigen energies are values after setting ave(Vtot)=0”</div>
<div class="line">For Vtot=V_ion+V_Hartree+V_xc, and</div>
<div class="line">ave(V_ion+V_Hatree)=0, ave(V_xc).ne.0: E=E+v0</div>
<div class="line">*********************************</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">iislda,kpt=</span>&#160;&#160; <span class="pre">1,</span>&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">0.000000</span>&#160; <span class="pre">0.000000</span>&#160; <span class="pre">0.000000</span>&#160; <span class="pre">kpoint</span> <span class="pre">in</span> <span class="pre">xyz</span> <span class="pre">unit</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">err</span> <span class="pre">of</span> <span class="pre">each</span> <span class="pre">states,</span> <span class="pre">A.U</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.573674E-04</span>&#160; <span class="pre">0.215818E-04</span>&#160; <span class="pre">0.218771E-04</span>&#160; <span class="pre">0.234885E-04</span>&#160; <span class="pre">0.133999E-04</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.135147E-04</span>&#160; <span class="pre">0.137877E-04</span>&#160; <span class="pre">0.312014E-04</span>&#160; <span class="pre">0.322240E-04</span>&#160; <span class="pre">0.308460E-04</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.941030E-04</span>&#160; <span class="pre">0.297856E-04</span>&#160; <span class="pre">0.262598E-04</span>&#160; <span class="pre">0.298091E-04</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">eigen</span> <span class="pre">energies,</span> <span class="pre">in</span> <span class="pre">eV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-4.699596</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">7.245389</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">7.245391</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">7.245395</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">9.801827</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">9.801834</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">9.801837</span>&#160;&#160;&#160;&#160; <span class="pre">10.593119</span>&#160;&#160;&#160;&#160; <span class="pre">14.861113</span>&#160;&#160;&#160;&#160; <span class="pre">14.861115</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">15.189885</span>&#160;&#160;&#160;&#160; <span class="pre">18.458619</span>&#160;&#160;&#160;&#160; <span class="pre">18.458622</span>&#160;&#160;&#160;&#160; <span class="pre">18.458625</span></code></div>
<div class="line">*********************************</div>
<div class="line">*********************************</div>
<div class="line">…</div>
<div class="line">*********************************</div>
<div class="line">*********************************</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">iislda,kpt=</span>&#160;&#160; <span class="pre">1,</span> <span class="pre">29</span>&#160; <span class="pre">0.000000</span>&#160; <span class="pre">0.306106</span>&#160; <span class="pre">0.612211</span>&#160; <span class="pre">kpoint</span> <span class="pre">in</span> <span class="pre">xyz</span> <span class="pre">unit</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">err</span> <span class="pre">of</span> <span class="pre">each</span> <span class="pre">states,</span> <span class="pre">A.U</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.471671E-04</span>&#160; <span class="pre">0.471350E-04</span>&#160; <span class="pre">0.449899E-04</span>&#160; <span class="pre">0.449497E-04</span>&#160; <span class="pre">0.463574E-04</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.412857E-04</span>&#160; <span class="pre">0.499375E-04</span>&#160; <span class="pre">0.499620E-04</span>&#160; <span class="pre">0.315688E-04</span>&#160; <span class="pre">0.404333E-04</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">0.960614E-04</span>&#160; <span class="pre">0.962922E-04</span>&#160; <span class="pre">0.470290E-03</span>&#160; <span class="pre">0.637003E-03</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">eigen</span> <span class="pre">energies,</span> <span class="pre">in</span> <span class="pre">eV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">-0.391756</span>&#160;&#160;&#160;&#160; <span class="pre">-0.391756</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">3.413886</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">3.413891</span>&#160;&#160;&#160;&#160; <span class="pre">11.472384</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">11.472387</span>&#160;&#160;&#160;&#160; <span class="pre">12.224273</span>&#160;&#160;&#160;&#160; <span class="pre">12.224277</span>&#160;&#160;&#160;&#160; <span class="pre">17.739918</span>&#160;&#160;&#160;&#160; <span class="pre">17.739925</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">20.202989</span>&#160;&#160;&#160;&#160; <span class="pre">20.202993</span>&#160;&#160;&#160;&#160; <span class="pre">23.588241</span>&#160;&#160;&#160;&#160; <span class="pre">23.588244</span></code></div>
<div class="line">*********************************</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">computation</span> <span class="pre">time</span> <span class="pre">(sec)=</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">9</span></code></div>
</div>
</div>
</div>
</div>
<div class="section" id="relaxsteps">
<h2>RELAXSTEPS<a class="headerlink" href="#relaxsteps" title="Permalink to this headline">¶</a></h2>
<p>The “RELAXTEPS” is the file concisely reports the atomic relaxation
steps, and the energy and atomic forces at each atom, as well as the SCF
convergence for each ab initio step calculations. A typical “RELAXSTEPS”
file will look like:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">It</span><span class="o">=</span> <span class="mi">0</span> <span class="n">NEW</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.7526919500493E+03</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.17E+00</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.32E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">4E-04</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">4E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">4</span>
<span class="n">dL</span><span class="o">=-.</span><span class="mf">70E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span> <span class="o">=-</span><span class="mf">0.38E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.77E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.10E+01</span>
<span class="n">It</span><span class="o">=</span> <span class="mi">1</span> <span class="n">CORR</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.7527130487491E+03</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.18E+00</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.37E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">3E-04</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">2E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">dL</span><span class="o">=-.</span><span class="mf">14E+00</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=-</span><span class="mf">0.23E-02</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.77E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.10E+01</span>
<span class="n">It</span><span class="o">=</span> <span class="mi">2</span> <span class="n">NEW</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.7527421363137E+03</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.10E+00</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.20E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">5E-04</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">9E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">2</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.49E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span> <span class="o">=-</span><span class="mf">0.19E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.51E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.10E+01</span>
<span class="n">It</span><span class="o">=</span> <span class="mi">3</span> <span class="n">CORR</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.7527473988358E+03</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.12E+00</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.23E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">7E-05</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">3E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">2</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.78E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=</span> <span class="mf">0.80E-03</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.51E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.10E+01</span>
</pre></div>
</div>
</div>
<p><strong>It</strong>: The index of total line-minimization number (iteration, or step
index).</p>
<p><strong>NEW</strong>: this is a new line-minimization direction. The search direction
p has changed.</p>
<p><strong>CORR</strong>: this is a middle step in the line-minimization process
(correction step). Its search direction p is the same as in previous
steps (all the way to the last NEW step). Note the energy of this trial
step can be higher than previous step. So, to see the convergence, only
the energies for the NEW steps should be used.</p>
<p><strong>E</strong>: total energy of this step in <span class="math notranslate nohighlight">\(eV\)</span>;</p>
<p><strong>Av_F, M_F</strong>: average and maximum atomic forces
(<span class="math notranslate nohighlight">\(eV/{\textup{\AA}}\)</span>);</p>
<p><strong>Av_e</strong>: average stress (<span class="math notranslate nohighlight">\(eV/NATOM\)</span>), Natom is the total number
of atoms;</p>
<p><strong>dE</strong>: the SCF iteration <span class="math notranslate nohighlight">\(E(n)-E(n-1)(eV)\)</span>. This is used to judge
whether the SCF iteration is converged. Note, this is not the dE between
this relaxation step and previous relaxation step!</p>
<p><strong>dRho</strong>: the SCF iteration <span class="math notranslate nohighlight">\(|rho(n)-rho(n-1)|\)</span> relative error.
This is used to judge whether the SCF is converged.</p>
<p><strong>SCF</strong>: the SCF iteration number for this step.</p>
<p><strong>dL</strong>: the movement <span class="math notranslate nohighlight">\(|R-R(new\_initial)|\)</span> of this step (in atomic
unit <span class="math notranslate nohighlight">\(Bohr\)</span>). <span class="math notranslate nohighlight">\(R(new\_initial)\)</span> is the initial atomic
position of this line-minimization direction. Note, for the NEW step,
there is already one <span class="math notranslate nohighlight">\(dL\)</span>. In another word, the <span class="math notranslate nohighlight">\(dL\)</span> shown
in the NEW line is actually the <span class="math notranslate nohighlight">\(|R-R(new\_initial)|\)</span> for the
<span class="math notranslate nohighlight">\(R\)</span> in the following CORR line (i.e, it is the length of the first
trial step). Similarly, the <span class="math notranslate nohighlight">\(dL\)</span> of one CORR line, is the
<span class="math notranslate nohighlight">\(dL\)</span> of the <span class="math notranslate nohighlight">\(R\)</span> in the following line. The <span class="math notranslate nohighlight">\(dL\)</span>’s in
the NEW, and subsequent CORR (before the next NEW) lines are in the same
search direction, and all measured from the beginning point of this new
line direction.</p>
<p><strong>p*F</strong>: the force of the current step project to the search direction.
Note, the purpose of the line-minimization is to make <span class="math notranslate nohighlight">\(p*F\)</span> zero
(it uses linear interpolation of <span class="math notranslate nohighlight">\(p*F\)</span>) to predict the next step
size (<span class="math notranslate nohighlight">\(dL\)</span>) in this line-minimization.</p>
<p><strong>p*F0</strong>: the same as <span class="math notranslate nohighlight">\(p*F_0\)</span>, however, not use the force of this
configuration, but use the force of <span class="math notranslate nohighlight">\(R(new\_initial)\)</span>. Thus this
<span class="math notranslate nohighlight">\(p*F_0\)</span> is the same throughout one line-minimization direction.</p>
<p><strong>Fch</strong>: the force check, calculated as <span class="math notranslate nohighlight">\(dL*(F+F_0)/2/dE\)</span>,
<span class="math notranslate nohighlight">\(dL\)</span> is the displacement for this step from the
<span class="math notranslate nohighlight">\(R(new\_initial)\)</span>, <span class="math notranslate nohighlight">\(F, F0\)</span> are the forces are the two ends
of this step, (<span class="math notranslate nohighlight">\(F\)</span> is the force at the current position,
<span class="math notranslate nohighlight">\(F_0\)</span> is the initial force at <span class="math notranslate nohighlight">\(R(new\_initial)\)</span>. <span class="math notranslate nohighlight">\(dE\)</span>
is the total energy difference of this step (the current energy minus
the initial energy at the beginning of the new search direction).
<span class="math notranslate nohighlight">\(Fch=1\)</span> indicates all the calculations are accurate. Note, for
single precision GPU calculation, the dE is usually less accurate than
<span class="math notranslate nohighlight">\(dL*(F+F_0)/2\)</span>, so Fch not equaling 1 can still be fine, since the
force is good, and the relaxation algorithms are based on force, not the
total energy. When using HSE functional to do relaxation, the RELAXSTEPS
will like this:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">hse</span><span class="o">=</span> <span class="mi">1</span> <span class="n">HSE</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021519099504E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.49E-01</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.20E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">3E-01</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">5E-03</span> <span class="n">SCF</span><span class="o">=</span><span class="mi">40</span>
<span class="mi">2</span> <span class="n">It</span><span class="o">=</span> <span class="mi">0</span> <span class="n">TRIAL</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021525446280E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.22E-01</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.12E+00</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">2E-02</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">1E-02</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">6</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.30E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=-</span><span class="mf">0.10E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.27E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.10E+01</span>
<span class="mi">3</span> <span class="n">It</span><span class="o">=</span> <span class="mi">1</span> <span class="n">CORR</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021527108036E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.20E-01</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.84E-01</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">6E-03</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">2E-02</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.49E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=</span> <span class="mf">0.42E-03</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.27E-01</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.11E+01</span>
<span class="o">...</span>
<span class="mi">15</span> <span class="n">It</span><span class="o">=</span> <span class="mi">13</span> <span class="n">TRIAL</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021529742117E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.21E-02</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.66E-02</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">4E-04</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">5E-04</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">dL</span><span class="o">=-.</span><span class="mf">48E-02</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=-</span><span class="mf">0.15E-03</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.14E-02</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.12E+01</span>
<span class="mi">17</span> <span class="n">hse</span><span class="o">=</span> <span class="mi">2</span> <span class="n">HSE</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021523919362E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.57E-02</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.35E-01</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">3E-02</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">3E-04</span> <span class="n">SCF</span><span class="o">=</span><span class="mi">26</span>
<span class="mi">18</span> <span class="n">It</span><span class="o">=</span> <span class="mi">0</span> <span class="n">TRIAL</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021525066203E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.42E-02</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.18E-01</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">8E-02</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">2E-02</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.10E-01</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=</span> <span class="mf">0.46E-04</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.31E-02</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.82E+01</span>
<span class="mi">19</span> <span class="n">It</span><span class="o">=</span> <span class="mi">1</span> <span class="n">CORR</span> <span class="n">E</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.3021523932495E+05</span> <span class="n">Av_F</span><span class="o">=</span> <span class="mf">0.43E-02</span> <span class="n">M_F</span><span class="o">=</span> <span class="mf">0.19E-01</span> <span class="n">dE</span><span class="o">=.</span><span class="mf">2E-03</span> <span class="n">dRho</span><span class="o">=.</span><span class="mf">3E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">3</span>
<span class="n">dL</span><span class="o">=</span><span class="mf">0.98E-02</span> <span class="n">p</span><span class="o">*</span><span class="n">F</span><span class="o">=-</span><span class="mf">0.10E-04</span> <span class="n">p</span><span class="o">*</span><span class="n">F0</span><span class="o">=-</span><span class="mf">0.31E-02</span> <span class="n">Fch</span><span class="o">=</span> <span class="mf">0.94E-01</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<p>The new item is HSE. That means in this iteration, PWmat will use HSE
functional to do the relaxation.</p>
</div>
<div class="section" id="neb-barrier">
<h2>NEB.BARRIER<a class="headerlink" href="#neb-barrier" title="Permalink to this headline">¶</a></h2>
<p>The “NEB.BARRIER” is the file concisely report the energies along the
images for different relaxation iteration steps. One can yield the
barrier height and profiles from NEB.BARRIER. It has the following
format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">iter</span><span class="o">=</span> <span class="mi">19</span> <span class="n">Etot</span><span class="p">(</span><span class="n">eV</span><span class="p">),</span><span class="n">dist</span><span class="p">(</span><span class="n">Bohr</span><span class="p">),</span><span class="n">angle</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">))</span>
 <span class="mi">0</span> <span class="o">-</span><span class="mf">0.75306186045042E+03</span> <span class="mf">0.504486E+00</span> <span class="mf">0.000000E+00</span>
 <span class="mi">1</span> <span class="o">-</span><span class="mf">0.75305820517778E+03</span> <span class="mf">0.520270E+00</span> <span class="mf">0.944578E+00</span>
 <span class="mi">2</span> <span class="o">-</span><span class="mf">0.75304052843358E+03</span> <span class="mf">0.530724E+00</span> <span class="mf">0.846617E+00</span>
 <span class="mi">3</span> <span class="o">-</span><span class="mf">0.75296036069356E+03</span> <span class="mf">0.526520E+00</span> <span class="mf">0.355627E+00</span>
 <span class="mi">4</span> <span class="o">-</span><span class="mf">0.75266754347227E+03</span> <span class="mf">0.517507E+00</span> <span class="mf">0.883061E+00</span>
 <span class="mi">5</span> <span class="o">-</span><span class="mf">0.75234053674623E+03</span> <span class="mf">0.512514E+00</span> <span class="mf">0.961894E+00</span>
 <span class="mi">6</span> <span class="o">-</span><span class="mf">0.75234044035416E+03</span> <span class="mf">0.517438E+00</span> <span class="mf">0.961928E+00</span>
 <span class="mi">7</span> <span class="o">-</span><span class="mf">0.75266732167841E+03</span> <span class="mf">0.526413E+00</span> <span class="mf">0.883176E+00</span>
 <span class="mi">8</span> <span class="o">-</span><span class="mf">0.75296021410969E+03</span> <span class="mf">0.530651E+00</span> <span class="mf">0.356206E+00</span>
 <span class="mi">9</span> <span class="o">-</span><span class="mf">0.75304050727950E+03</span> <span class="mf">0.520291E+00</span> <span class="mf">0.846314E+00</span>
<span class="mi">10</span> <span class="o">-</span><span class="mf">0.75305820226225E+03</span> <span class="mf">0.504589E+00</span> <span class="mf">0.944466E+00</span>
<span class="mi">11</span> <span class="o">-</span><span class="mf">0.75306185743092E+03</span> <span class="mf">0.000000E+00</span> <span class="mf">0.000000E+00</span>
</pre></div>
</div>
</div>
<p>This means Nimage=10. The <span class="math notranslate nohighlight">\(Etot(eV\)</span>) indicates the total energy of
this image. Dist is the distance between the neighboring images (between
image and image+1). For good NEB run, the distance should be roughly the
same. Angle is the <span class="math notranslate nohighlight">\(cos\theta\)</span> of the angle theta between two
<span class="math notranslate nohighlight">\(R(image+1)-R(image)\)</span>, and <span class="math notranslate nohighlight">\(R(image)-R(image-1)\)</span>. For good
NEB run, <span class="math notranslate nohighlight">\(cos\theta\)</span> should be close to 1 (especially around the
barrier height). In practice, it should be fine as long as the
<span class="math notranslate nohighlight">\(cos\theta\)</span> is close to 1 near the barrier height. Also, for a
good NEB run, the distance between the images should be roughly equal.
Iter=19 means this is the 19th line minization result. In NEB.BARRIER,
it writes out the results for every relaxation iterations.</p>
</div>
<div class="section" id="mdsteps">
<h2>MDSTEPS<a class="headerlink" href="#mdsteps" title="Permalink to this headline">¶</a></h2>
<p>The “MDSTEPS” is the file concisely describes the steps of a molecular
dynamics simulation. It can have the following format:</p>
<p>For NVE and NVT systems:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.100000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698558736E+05</span> <span class="o">-</span><span class="mf">0.1699177467E+05</span>
<span class="mf">0.6187317043E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">598.34048</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">598.34048</span> <span class="n">dE</span><span class="o">=</span> <span class="o">-.</span><span class="mf">46E-03</span>
<span class="n">dRho</span><span class="o">=</span> <span class="mf">0.35E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">8</span> <span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span> <span class="mf">0.106E+01</span>
<span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.200000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698558872E+05</span>  <span class="o">-</span><span class="mf">0.1699171678E+05</span>
<span class="mf">0.6128058892E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">592.60996</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">595.47522</span> <span class="n">dE</span><span class="o">=</span> <span class="mf">0.37E-04</span>
<span class="n">dRho</span><span class="o">=</span> <span class="mf">0.42E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">5</span> <span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span> <span class="mf">0.103E+01</span>
<span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.300000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698559089E+05</span>  <span class="o">-</span><span class="mf">0.1699161871E+05</span>
<span class="mf">0.6027821480E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">582.91656</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">591.28900</span> <span class="n">dE</span><span class="o">=</span> <span class="o">-.</span><span class="mf">16E-03</span>
<span class="n">dRho</span><span class="o">=</span> <span class="mf">0.51E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">5</span> <span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span> <span class="mf">0.102E+01</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<p><strong>Iter</strong> is the simulation time in <span class="math notranslate nohighlight">\(fs\)</span>.</p>
<p><strong>Etot</strong> is the total energy (DFT energy plus kinetic energy) in
<span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Ep</strong> is the potential energy (here, DFT energy) in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Ek</strong> is the kinetic energy in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Temp</strong> is the temperature calculated from the <span class="math notranslate nohighlight">\(E_k\)</span> in <span class="math notranslate nohighlight">\(K\)</span></p>
<p><strong>aveTemp</strong> is the average temperature in <span class="math notranslate nohighlight">\(K\)</span></p>
<p><strong>dE</strong> is the <span class="math notranslate nohighlight">\(E(n)-E(n-1)\)</span> in the SCF iteration (<span class="math notranslate nohighlight">\(eV\)</span>).</p>
<p><strong>drho</strong> = <span class="math notranslate nohighlight">\(|rho_{in}-rho_{out}|\)</span> relative error, in the SCF
calculation.</p>
<p><strong>SCF</strong> is the number of SCF iterations for this MD step.</p>
<p>For NPT systems:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.100000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698570268E+05</span>  <span class="o">-</span><span class="mf">0.1699177647E+05</span>
<span class="mf">0.6073782319E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">587.36118</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">587.36118</span> <span class="n">Press</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span>
<span class="mf">0.75287E-05</span> <span class="n">aveP</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.75287E-05</span> <span class="n">dE</span><span class="o">=</span> <span class="o">-.</span><span class="mf">52E-03</span> <span class="n">dRho</span><span class="o">=</span> <span class="mf">0.35E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">8</span>
<span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span> <span class="mf">0.116E+01</span>
<span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.200000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698575833E+05</span>  <span class="o">-</span><span class="mf">0.1699172623E+05</span>
<span class="mf">0.5967897923E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">577.12169</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">582.24144</span> <span class="n">Press</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span>
<span class="mf">0.72836E-05</span> <span class="n">aveP</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.74061E-05</span> <span class="n">dE</span><span class="o">=</span> <span class="o">-.</span><span class="mf">89E-03</span> <span class="n">dRho</span><span class="o">=</span> <span class="mf">0.82E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">4</span>
<span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span><span class="mf">0.116E+01</span>
<span class="n">Iter</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.300000E+01</span> <span class="n">Etot</span><span class="p">,</span><span class="n">Ep</span><span class="p">,</span><span class="n">Ek</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">0.1698579068E+05</span>  <span class="o">-</span><span class="mf">0.1699163917E+05</span>
<span class="mf">0.5848493662E+01</span> <span class="n">Temp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span> <span class="mf">565.57478</span> <span class="n">aveTemp</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">576.68589</span> <span class="n">Press</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span>
<span class="mf">0.82208E-05</span> <span class="n">aveP</span><span class="p">(</span><span class="n">Hartree</span><span class="o">/</span><span class="n">bohr</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span> <span class="mf">0.76777E-05</span> <span class="n">dE</span><span class="o">=</span> <span class="mf">0.33E-03</span> <span class="n">dRho</span><span class="o">=</span> <span class="mf">0.44E-03</span> <span class="n">SCF</span><span class="o">=</span> <span class="mi">5</span>
<span class="n">dL</span><span class="o">=</span> <span class="mf">0.14E-01</span> <span class="n">Fcheck</span><span class="o">=</span><span class="mf">0.112E+01</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<p><strong>Iter</strong> is the simulation time in <span class="math notranslate nohighlight">\(fs\)</span>.</p>
<p><strong>Etot</strong> is the total energy (DFT energy plus kinetic energy) in
<span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Ep</strong> is the potential energy (here, DFT energy) in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Ek</strong> is the kinetic energy in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p><strong>Temp</strong> is the temperature calculated from the <span class="math notranslate nohighlight">\(E_k\)</span> in <span class="math notranslate nohighlight">\(K\)</span></p>
<p><strong>aveTemp</strong> is the average temperature in <span class="math notranslate nohighlight">\(K\)</span></p>
<p><strong>Press</strong> is the pressure in <span class="math notranslate nohighlight">\(Hartree/bohr^3\)</span></p>
<p><strong>aveP</strong> is the average pressure in <span class="math notranslate nohighlight">\(Hartree/bhor^3\)</span></p>
<p><strong>dE</strong> is the <span class="math notranslate nohighlight">\(E(n)-E(n-1)\)</span> in the SCF iteration (<span class="math notranslate nohighlight">\(eV\)</span>).</p>
<p><strong>drho</strong> = <span class="math notranslate nohighlight">\(|rho_{in}-rho_{out}|\)</span> relative error, in the SCF
calculation.</p>
<p><strong>SCF</strong> is the number of SCF iterations for this MD step.</p>
</div>
<div class="section" id="movement">
<h2>MOVEMENT<a class="headerlink" href="#movement" title="Permalink to this headline">¶</a></h2>
<p>This is the file generated in RELAX, NEB and MD. It outputs the
atom.config of every atomic movement steps (including the correction
steps in the line minimization of RELAX) in a single file, one after
another. It contains the atomic position, atomic force sections. For MD,
it also contains the velocity section. So, it can be copied to
atom.config, to continue the run of MD. It can also be converted to
other format for visualization (e.g., as animation), by using:
“<span class="math notranslate nohighlight">\(&gt;\)</span>convert_from_config.x <span class="math notranslate nohighlight">\(&lt;\)</span> MOVEMENT”.</p>
<p>For JOB=NEB, the MOVEMENT contains the configurations for all the image
points. Note, inside MOVEMENT, the new configuration is appended on the
old ones already in the file. The format of MOVEMENT is the same as in
atom.config.</p>
</div>
<div class="section" id="other-output-files">
<h2>other output files<a class="headerlink" href="#other-output-files" title="Permalink to this headline">¶</a></h2>
<p>There could be other output files.</p>
<ol class="arabic simple">
<li><p>BINARY files.</p>
<ol class="arabic simple">
<li><p>OUT.WG (wave function output file)</p></li>
<li><p>OUT.HSEWR(i) (real space wave functions for the Fock exchange
kernel for all the extended k-points on GPU(i))</p></li>
<li><p>OUT.REAL.RHOWF_SP (the charge density or wave function in real
space)</p></li>
<li><p>OUT.RHO (charge density output file)</p></li>
<li><p>OUT.RHO_2 (spin down components)</p></li>
<li><p>OUT.RHO_SOM (a complex 2x2 spin matrix density)</p></li>
<li><p>OUT.RHO_4DIELECTRIC (the rho_e to be used to generate the
dielectric function)</p></li>
<li><p>OUT.RHO_POLARIZE (the solvent induced polarization charge)</p></li>
<li><p>OUT.V_POLARIZE (the polarized potential generated by the
polarization charge OUT.RHO_POLARIZE)</p></li>
<li><p>OUT.RHOP_VHION (the polarization charge multiplied by the electric
static potential of the slolute molecule)</p></li>
<li><p>OUT.VR (toal potential output file)</p></li>
<li><p>OUT.VR_hion (Hartree + Vion, the electrostatic potential without
XC potential)</p></li>
<li><p>OUT.VR_2 (spin down potential output file)</p></li>
<li><p>OUT.VR_SOM (a 2x2 complex spin matrix potential)</p></li>
<li><p>OUT.VR_DELTA (a real up-down potential)</p></li>
<li><p>OUT.DENS (selective wave function charge density file)</p></li>
<li><p>bpsiiofil10000x (wave function to atomic orbital projection file
for kpoint x)</p></li>
<li><p>OUT.SPIN_X/Y/Z (spin charge density in x/y/z direction at every r
point)</p></li>
<li><p>OUT.EIGEN (the eigen energies output file)</p></li>
</ol>
</li>
<li><p>final.config (stores the final atom configurations in RELAX/MD/NEB)</p></li>
<li><p>OUT.KPT (contains the k-point vectors and their weights)</p></li>
<li><p>OUT.SYMM (contains symmetry operation file)</p></li>
<li><p>OUT.OCC (the occupation of eigen states)</p></li>
<li><p>OUT.VATOM (the atom center potential for SCF or MD simulation)</p></li>
<li><p>OUT.FERMI (stores the FERMI energy in scf calculation, which will be
used in plotting band structure or density of states)</p></li>
<li><p>OUT.FORCE (the atomic foce file)</p></li>
<li><p>OUT.STRESS (the stress tensor output file)</p></li>
<li><p>OUT.QDIV (the atomic charge on each atom)</p></li>
<li><p>OUT.ENDIV (the decomposed atomic energy on each atom)</p></li>
<li><p>OUT.ATOMSPIN (contains local charge and magnetic moment in
spin-polarized calculations when SPIN = 222)</p></li>
</ol>
</div>
</div>
<div class="section" id="the-basic-calculations">
<h1>The basic calculations<a class="headerlink" href="#the-basic-calculations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="self-consistent-calculations-job-scf">
<h2>Self-consistent calculations(JOB=SCF)<a class="headerlink" href="#self-consistent-calculations-job-scf" title="Permalink to this headline">¶</a></h2>
<p>This is a one-shot DFT calculation for a fixed atomic position. It can
be used to study the total energy, the magnetic moment, the charge
density, the electronic structure, etc. It will not move the atoms. The
charge density will be iteratively calculated, until it converges (input
charge density equals the output charge density). If subsequent runs
(e.g., for NONSCF or DOS) are expected, one should set: OUT.WG = T,
OUT.RHO = T, OUT.VR = T (they are all defaults for SCF runs), so they
will output files: OUT.WG, OUT.RHO, OUT.VR for subsequent uses. For band
structure plot and DOS plot, remember to copy OUT.FERMI (so the Fermi
energy can be read out).</p>
</div>
<div class="section" id="none-self-consist-calculations-job-nonscf">
<h2>None self-consist calculations(JOB=NONSCF)<a class="headerlink" href="#none-self-consist-calculations-job-nonscf" title="Permalink to this headline">¶</a></h2>
<p>This is usually used, following a SCF calculation, to study the
electronic structure of the system, in particular the band structure. It
can use the OUT.VR from the previous calculation (copy them to IN.VR,
and set IN.VR to T in etot.input), but with different k-points in
IN.KPT, to study the band structure. It can also be used to study some
special cases (e.g., with patched together potential, or charge
density). Note, in NONSCF, it can still generate the potential from an
input charge density. One needs to set IN.VR=T (to input potential from
IN.VR), or IN.RHO=T (to input charge density from IN.RHO, then generate
the potential). It will then simply calculate the eigen energies (e.g.,
for different k-points listed in IN.KPT).</p>
<p>To do a band structure calculation, it usually run PWmat in the
following procedure: Set Monkhorst-Pack line in etot.input: “MP_N123 =
nk1, nk2, nk3, sk1, sk2, sk3”, then run a SCF calculation, get OUT.VR,
and copy OUT.VR to IN.VR. edit the high symmetry kpoints by hand, then
run a NONSCF calculation using this IN.KPT (IN.KPT=T, IN.VR=T). The band
structure information will then be reported in “REPORT”. One can use
“plot_band_structure.x” for post-process to view the band structure.</p>
</div>
<div class="section" id="density-of-states-calculations-job-dos">
<h2>Density of States Calculations(JOB=DOS)<a class="headerlink" href="#density-of-states-calculations-job-dos" title="Permalink to this headline">¶</a></h2>
<p>This usually also follows from one SCF calculation (just like for
NONSCF), then to calculate the DOS in this step. In other words, there
need to have three calculations in order to get DOS. As for NONSCF, one
first gets OUT.VR from SCF calculation. Then in DOS calculation, copy
OUT.VR as IN.VR, set IN.VR = T (read this IN.VR). Also, one might want
to use more k-points for a nice DOS. To do that, one can use a larger
Monkhorst-Pack grids in etot.input (MP_N123 = nk1, nk2, nk3, sk1, sk2,
sk3), to generate a new IN.KPT. Then, one needs to do a JOB = NONSCF
calculation to get the eigen energies (stored in OUT.EIGEN) and eigen
wave functions (OUT.WG). (If one doesn’t want to use more k-points, then
one can use the SCF calculation’s eigen energies and wave functions,
thus skip the JOB = NONSCF calculation step). After this, one can copy
OUT.WG to IN.WG, and do a JOB = DOS calculation. The PWmat will output a
file: DOS.totalspin (if SPIN=2, there will also be DOS.spinup,
DOS.spindown). The format in DOS.totalspin is (each line) (example):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Energy</span> <span class="n">Total</span> <span class="n">Zn</span><span class="o">-</span><span class="n">s</span> <span class="n">Zn</span><span class="o">-</span><span class="n">p</span> <span class="n">Zn</span><span class="o">-</span><span class="n">d</span> <span class="n">O</span><span class="o">-</span><span class="n">s</span> <span class="n">O</span><span class="o">-</span><span class="n">p</span> <span class="n">O</span><span class="o">-</span><span class="n">d</span>
</pre></div>
</div>
</div>
<p>One can plot this file for graphics. The default energy
smoothing/broadening parameter is 0.1 eV. If one wants to have different
broadening parameter, or have partial DOS for different atoms, one can
use the postprocessing utility code: plot_dos.x. In order to have atom
selective partial DOS, one needs to provide a modified atom.config file,
with the position section looks like:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">30</span> <span class="mf">0.952534560</span> <span class="mf">0.363594470</span> <span class="mf">0.382027650</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w1</span>
<span class="mi">30</span> <span class="mf">0.540553000</span> <span class="mf">0.850230410</span> <span class="mf">0.966359450</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w2</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="mf">0.242857140</span> <span class="mf">0.140553000</span> <span class="mf">0.684331800</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w3</span>
</pre></div>
</div>
</div>
<p>Here w1, w2, w3 are the weights for this atom in the partial DOS. The
plot_dos.x also uses bpsiiofil10000x, which are the eigen wavefunciton
to atomic orbital projection coefficients for different k-points x,
which is output from the JOB = DOS run.</p>
</div>
<div class="section" id="atomic-relaxation-job-relax">
<h2>Atomic Relaxation(JOB=RELAX)<a class="headerlink" href="#atomic-relaxation-job-relax" title="Permalink to this headline">¶</a></h2>
<p>This is to relax the atomic positions following the DFT energy and
force. It will generate the RELAXSTEPS, and MOVEMENT files. If it is not
fully relaxed, the MOVEMENT can be copied to atom.config (remove all the
other iterations, except the last one), then run the PWmat again. Pay
attention to FORCE_RELATIVE_ERROR. This parameter is used to stop the
SCF iterations. It takes the last iteration average force, and the
estimated force error (estimated from <span class="math notranslate nohighlight">\(|V_{in}-V_{out}|\)</span> in SCF
calculations), if the estimated_force_error is less than
last_iteration_force*FORCE_RELATIVE_ERROR, then it will jump out the SCF
loop. So, smaller FORCE_RELATIVE_ERROR (and larger niter1), more SCF
loop might be carried out, and more accurate will be the force. This
might be particularly critical if very accurate final atomic positions
are needed. The default FORCE_RELATIVE_ERROR for RELAX is 0.003. There
are two relaxation methods: imth=1, conjugated gradient method; imth=2,
BFGS method (the imth is specified in line RELAX_DETAIL). Their
performances are similar. More advanced methods will be introduced in
later version of PWmat. When JOB = RELAX is used, one can also include
an etot.input line: “RELAX_DETAIL = imth, nstep, force_tol”. If the
max_force becomes smaller than force_tol(<span class="math notranslate nohighlight">\(a.u\)</span>), the relaxation
step will stop (before nstep).</p>
</div>
<div class="section" id="nudged-elastic-band-calculations-job-neb">
<h2>Nudged Elastic Band Calculations(JOB=NEB)<a class="headerlink" href="#nudged-elastic-band-calculations-job-neb" title="Permalink to this headline">¶</a></h2>
<p>Nudged Elastic Band (NEB) method is often used to calculate the
potential barrier from one local minimum configuration to another local
minimum configuration. In order to do NEB calculation, the two local
minimum must be known already. They can be calculated by JOB=RELAX, with
their atomic configurations being atom1.config, atom2.config, and
energies being <span class="math notranslate nohighlight">\(E_1\)</span>,<span class="math notranslate nohighlight">\(E_2\)</span>. The idea of NEB is to use a
string of images (configuration points) between the two end points
(atom1.config, atom2.config). This can guarantee the path can go from
one configuration to the other configuration. To avoid the force from
the potential (DFT energy) to move the images away from the barrier
saddle point (which lower the potential energy), the tangent component
of the potential force will be removed. To avoid the force of the
elastic string from moving the string away from the saddle point (corner
cutting, since an elastic string like to have the minimum length), the
perpendicular (to the string tangent) component of the string force will
be removed. So the force of the string will only maintain equal
distances between the images. This is the essence of the NEB. However,
after such modification, there is no guarantee the remaining total force
can be written down as a gradient of a potential (i.e, the vortices of
the force might not be zero). This can cause significant difficulty in
the relaxation procedure to make the force zero (e.g., if one just
follows the force to make atomic movement, it is possible that the
relaxation iteration can end up in an infinite loop). Another common
problem is that string is not smooth, with the vector
<span class="math notranslate nohighlight">\(R(image+1)-R(image)\)</span> and <span class="math notranslate nohighlight">\(R(image)-R(image-1)\)</span> having an
angle not close to 180 degree. Thus, there are several points need to be
considered when doing a JOB=NEB calculation. First, it is better to use
imth=3 (steepest decent for the atomic relaxation method). This is
because the CG or BFGS method, which assumes a parabolic potential and
the related force might no longer work in NEB. Second, we have
implemented two types of string (to deal with the string force).
type_string=1 means the original NEB string (remove the perpendicular
string force); while type_string=2 means the conventional string (the
perpendicular string force is not removed). If the problem failed to
converge, one possibility is to first use type_string=2, and a relative
large string constant <span class="math notranslate nohighlight">\(ak\)</span>. Then, after that is converged, one can
do a second NEB calculation (copy MOVEMENT to atom2.config, and use
itype_at2=2) using either itype_string=1, or a smaller <span class="math notranslate nohighlight">\(ak\)</span> while
still use type_string=2. All these choices are to increase the
flexibility in NEB calculations.</p>
<p>A normal NEB calculation should have the following steps:</p>
<ol class="arabic">
<li><p>using JOB=RELAX to calculate the two local minimum, their atomic
positions atom1.config, atom2,config and energies <span class="math notranslate nohighlight">\(E_1\)</span>,
<span class="math notranslate nohighlight">\(E_2\)</span>. Note, the atomic orders in atom1.config and atom2.config
must be the same.</p></li>
<li><p>Use JOB=NEB, and write NEB_DETAIL as:</p>
<p><strong>IN.ATOM=atom1.config</strong></p>
<p><strong>NEB_DETAIL=imth, nstep, force_tol, Nimage, ak, type_string, E0, En,
itype_at2, atom2.config</strong></p>
<p>Make sure imth=3, nstep, force_tol can be similar as in RELAX_DETAIL.
Nimage is the number of images between the first and last images.
Typically Nimage can be 5 to 10. Choose a string constant. Typically,
<span class="math notranslate nohighlight">\(ak\)</span>=0.1<span class="math notranslate nohighlight">\(\sim\)</span>1 (<span class="math notranslate nohighlight">\(eV/{\textup{\AA}}^2\)</span>)
sounds reasonable. If the relaxation is difficult (to reduce the
atomic force, as reported in RELAXSTEPS), one can use type_string=2,
otherwise, just use type_string=1. Place the
<span class="math notranslate nohighlight">\(E_0\)</span>,<span class="math notranslate nohighlight">\(E_N\)</span> from previous RELAX calculations to the
line NEB_DETAIL. Use itype_at2=1. Then do the JOB=NEB calculation.</p>
<p>If type_string=2 was used, and <span class="math notranslate nohighlight">\(ak\)</span> is a bite large, one can do
another calculation:</p>
</li>
<li><p>copy MOVEMENT into atom.continue (remove all the previous
iterations). Replace “1, atom2.config” in NEB_DETAIL by “2,
atom.continue”. Now, either use type_string=1 (true NEB method), or
still use type_string=2, but with a much smaller <span class="math notranslate nohighlight">\(ak\)</span>. Do the
calculation again. Check “NEB.BARRIER”, make sure the images are
roughly in equal distance, and the angle between
<span class="math notranslate nohighlight">\(R(image+1)-R(image)\)</span>, and <span class="math notranslate nohighlight">\(R(image)-R(image-1)\)</span>,
especially around the saddle point, is close to 0 degree
(<span class="math notranslate nohighlight">\(cos(\theta)\)</span> close to 1).</p></li>
</ol>
</div>
<div class="section" id="molecular-dynamics-job-md">
<h2>Molecular Dynamics(JOB=MD)<a class="headerlink" href="#molecular-dynamics-job-md" title="Permalink to this headline">¶</a></h2>
<p>This is for ab initio molecular dynamics simulations. There are three
methods:</p>
<ol class="arabic simple">
<li><p>md = 1, Verlet algorithm (for energy conserved true Newton dynamics);</p></li>
<li><p>md = 2, Nose-Hoover (stochastic methods for given temperature control
simulation).</p></li>
<li><p>md = 3, Langevin dynamics (with a viscosity and a thermos bath, for
given temperature control simulation);</p></li>
</ol>
<p>We recommend to use either md=1, or md=3. This simulation will output
MDSTEPS, and MOVEMENT. One can continue the simulation by copying
MOVEMENT to atom.config (remove all the other iterations except the last
one), then restart the calculation (only retype the running commands in
the terminal). The PWmat will automatically detect whether there is a
velocity section in atom.config. If yes, then it will use it as the
initial velocity. If no, it will use temp1 to randomly generate an
initial velocity. When using “JOB = MD”, one has to include an
etot.input line: “MD_DETAIL = md, mstep, dt, temp1, temp2”.</p>
<p>“md” specifies the method. For md=1 (verlet), only when it is start from
scratch, temp1 will be used. It is used to generate the initial random
velocity according to this temperature. For md=1, temp2 is not used. For
continued run, the initial velocity is read-in from the atom.config
file, so temp1 is not used. For md=2, 3, if start from scratch (initial
atom.config does not provide the velocity), then temp1 is used to
generate the initial velocity. The md=2,3 dynamics will scale the
temperature linearly with steps from temp1 to temp2.</p>
</div>
<div class="section" id="noncollinear-magnetic-moment">
<h2>Noncollinear magnetic moment<a class="headerlink" href="#noncollinear-magnetic-moment" title="Permalink to this headline">¶</a></h2>
<p>This is the calculation with SPIN=222. It includes the SPIN-ORBIT
coupling. Note, one should usually specify the initial magnetic moment
in atom.config, or if there is already an initial input from previous
runs. The output charge density is no longer just a density, but a
density matrix.</p>
</div>
<div class="section" id="f-states">
<h2>f-states<a class="headerlink" href="#f-states" title="Permalink to this headline">¶</a></h2>
<p>For some heavy elements, the f-states electrons play an important role
in some poperties calculations. If one wants to consider these effects,
just use the corresponding pseudopotentials which contain f electrons.
The pseudopotential with f electron has the tag “lmax = 3” in the
description part. One must check this on himself/herself.</p>
</div>
<div class="section" id="optical-spectrum">
<h2>optical spectrum<a class="headerlink" href="#optical-spectrum" title="Permalink to this headline">¶</a></h2>
<p>If one want to calculate optical absorption spectrum (using Fermi Gordon
rule, no excition effects), one can just do the calculation like DOS.
But one need do interpolation in DOS calculation.<strong>(WARNING)</strong>: when
do interpolatation, K point parallelization is not allowed. Then PWmat
will output files: OUT.GKK, OUT.WG (slightly modified). One can use
ug_moment.x to calculate <span class="math notranslate nohighlight">\(&lt;\psi_i|p_x|\psi_j&gt;\)</span> or use
plot_ABSORB_interp.x to calculate the absorption spectrum directly. The
result is written in “absorb.spectrum”. Note when using
plot_ABSORB_interp.x, one should add Fermi energy in “DOS.input” like
this (starting with # is the comment line):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
<span class="mi">1</span>
<span class="mf">0.05</span>  <span class="mf">14.9982034</span>
<span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
<span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">SYMM</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span>
</pre></div>
</div>
</div>
<p>The <strong>1st</strong> line: if setting 0, it means plotting DOS for all atoms; if
setting 1, for partial atoms. Note, when doing for partial atoms, one
need to add the 8th column to set the weights for all the atoms.</p>
<p>The <strong>2nd</strong> line: if setting 1, it means using interpolation for DOS
plotting; if setting 0, it keeps the old method, not doing
interpolation, just using a Gaussian broadening.</p>
<p>The <strong>3rd</strong> line: energy smearing, in <span class="math notranslate nohighlight">\(eV\)</span> and fermi energy.</p>
<p>The <strong>4th</strong> line: <span class="math notranslate nohighlight">\(NM_1, NM_2, NM_3\)</span>:, the interpolation grid,
with in each grid in :math:<a href="#id805"><span class="problematic" id="id806">`</span></a>NQ_1,</p>
<blockquote>
<div><p>NQ_2,NQ_3`.</p>
</div></blockquote>
<p>The <strong>5th</strong> line: <span class="math notranslate nohighlight">\(dE_{T}\)</span>(eV, for temp occup), <span class="math notranslate nohighlight">\(dE_{cut}\)</span>
(eV) (to cut off the E origin, E(m2)-E(m1) &lt; <span class="math notranslate nohighlight">\(dE_{cut}\)</span>)</p>
<p>The <strong>6th</strong> line: symm file name and atom.config file name.</p>
<p>The <strong>7th-9th</strong> line: <span class="math notranslate nohighlight">\(a1,a2,a3\)</span>, the polarization is:
<span class="math notranslate nohighlight">\(a1*px+a2*py+a3*pz\)</span></p>
</div>
<div class="section" id="compatible-runs-with-pwscf">
<h2>Compatible runs with PWSCF<a class="headerlink" href="#compatible-runs-with-pwscf" title="Permalink to this headline">¶</a></h2>
<p>The PWmat can be run compatibly with the open source code PWSCF. Mostly,
the PWmat can generate the wave function, charge density, and potential
files, which can be read by the PWSCF program, or the PWSCF compatible
programs (e.g., Wannier90 function generator, or GW calculations). These
programs can be run on CPU. To run those programs, the user is
responsible to prepare their control input files. One should also copy
the corresponding PWSCF pseudopotential files from our library.</p>
<p>With the compatibility of PWmat and PWSCF, one can fully take the
advantages of the wide functionalities of the PWSCF, while enjoy the
speed of PWmat for some of the key calculations. The available PWSCF
capabilities include: Wannier function generation; linear-response
phonon band structure calculation; linear-response TDDFT calculation; GW
calculation. We refer the user to consult the open source PWSCF manual
for how to calculate these properties.</p>
<p>To generate the PWSCF compatible wave function and potential files, set
PWSCF_OUTPUT = T in etot.input.</p>
<div class="section" id="wannier-function">
<h3>Wannier function<a class="headerlink" href="#wannier-function" title="Permalink to this headline">¶</a></h3>
<p>Interface between PWmat and wannier90 are available now. To use the
wannier90 program, please follow the next descriptions.</p>
<ol class="arabic simple">
<li><p>Run “scf”/“nonscf” calculations with <strong>PWmat</strong>. If setting
<strong>PWSCF_OUTPUT = T</strong>, PWmat will output files with QE format into the
directory <strong>prefix.save</strong>.</p></li>
<li><p>Run <strong>wannier90.x</strong> with <strong>postproc_setup = .true.</strong> to generate
<strong>seedname.nnkp</strong></p></li>
<li><p>Run <strong>pw2wannier90.x</strong> (from Quantum Espresso package “PP”). First it
reads an input file e.g., <strong>seedname.pw2wan</strong>, which defines
<strong>prefix</strong> and <strong>outdir</strong> for the underlying “scf” calculation, as
well as the name of the file <strong>seedname.nnkp</strong>, and does a
consistency check between the direct and reciprocal lattice vectors
read from <strong>seedname.nnkp</strong> and those defined in the files specified
by <strong>prefix</strong>. <strong>pw2wannier90</strong> generates <strong>seedname.mmn</strong>,
<strong>seedname.amn</strong> and <strong>seedname.eig</strong></p></li>
<li><p>Run <strong>wannier90</strong> with <strong>postproc_setup = .false.</strong> to disentangle
bands (if required), localise MLWF, and use MLWF for plotting,
bandstructures, Fermi surfaces etc.</p></li>
</ol>
<p>Note, more infomation about using QE and wannier90 programs can be found
on the websites (the websites are listed in page .)</p>
</div>
</div>
</div>
<div class="section" id="pseudopotentials">
<span id="chapter-pseudopotentials"></span><h1>Pseudopotentials<a class="headerlink" href="#pseudopotentials" title="Permalink to this headline">¶</a></h1>
<p>In PWmat2.0 release, we provide a few new set of pseudopotentials (PSP)
in our package.</p>
<p>The current release include the following pseudopotential sets:
ONCV-PWM, NCPP-SG15, NCPP-PD03,NCPP-PD04, NCPP-FHI, USPP-SOFT,
USPP-GBRV. The NCPP means norm conserving pseudopotential, while USPP
means ultrasoft pseudopotential. In the current version, ultrasoft PSP
cannot be mixed with norm conserving PSP, but the PSP from different
sets can be used in a mixed way (i.e, one element from NCPP-SG15,
another from NCPP-PD03). We also provide a set of NCPP for spin-orbit
coupling (SPIN=22 or 222) calculations: NCPP-SG15-PBE-SOC.
Unfortunately, we cannot use the spin-orbit coupling PSP directly from
UPF format, due to different implementation. However, if one has a NCPP
UPF with SOC, one can use our utility routine: upf2upfSO.x to convert it
into our special UPF format for our SOC calculation. ONCV-PWM is norm
conserving pseudopotential, compared with SG15, it has no semicore
valence electron, and the plane wave cutoff energy for wavefunction can
be relatively greatly reduced (our recommended cutoff is 45Ry).
Therefore, it may be useful for large system calculations.</p>
<p>We did not generate these pseudopotentials ourselves, instead they are
taken from other open source data, or published pseudopotential input
files. The NCPP-SG15, NCPP-PD03, NCPP-PD04, USPP-GBRV are recently
developed pseudopotentials. They are quite accurate. However, they might
contain semi-cores, and large energy cut off need to be used. This makes
their calculations relatively slow and need large memory. The NCPP-FHI
and USPP-SOFT are soft pseudopoentials, but the error in NCPP-FHI might
be relatively large. Thus, one has to choose carefully for the
pseudopotentials. For fast runs, one might use NCPP-FHI. One might also
choose USPP-SOFT. However, for very accurate calculations, one might
choose NCPP-SG15, NCPP-PD03, USPP-GBRV. Note, some of the
functionalities might not fully implemented in the ultrasoft PSP. So for
more complete functionality set, one might want to use NCPP.</p>
<p>For NCPP-PD03, NCPP-PD04, NCPP-SG15 (these two are rather similar), one
recommend the user to use Ecut=50 Ryd (if it is not converged, one can
even use 60, or 80 Ryd). The most challenging calculation is for the
atomic relaxation where smooth energy surface is required. For that
purpose, for these two sets of pseudopotentials, we recommend:
Ecut2=4Ecut, and Ecut2L=4Ecut2 (e.g., N123L=2N123). In other words,
choose Accuracy=high. On the other hand, for NCPP-FHI, one can use
Ecut=40,50, while Ecut2=2Ecut, Ecut2L=Ecut2 (e.g., choose
Accuracy=norm). For USPP-SOFT, in most cases, one can choose: Ecut=30,
Ecut2=2Ecut, Ecut2L=4Ecut2. FOr USPP-GBRV, Ecut=40 Ryd is recommended,
along with, perhaps, Ecut2=2Ecut, Ecut2L=4Ecut2.</p>
<p>Note, the above requirement is only true for JOB=RELAX. For other jobs,
including JOB=MD, or band structure, one can relax the requirement,
perhaps using Ecut2=2Ecut, and Ecut2L=Ecut2 ( Accuracy=norm) even for
NCPP-PD03 and NCPP-SG15.</p>
<p>Note, the pseudopotential file also contains information for Ecut, and
rcut. That will be the default Ecut, and rcut when they are used.</p>
</div>
<div class="section" id="utility-programs">
<h1>utility programs<a class="headerlink" href="#utility-programs" title="Permalink to this headline">¶</a></h1>
<div class="spacing docutils container">
<div class="mdframed docutils container">
<div class="line-block">
<div class="line">poscar2config.x</div>
<div class="line">cell2config.x</div>
<div class="line">xsf2config.x</div>
<div class="line">pwscf2config.x</div>
<div class="line">convert_from_config.x</div>
<div class="line">config2poscar.x</div>
<div class="line">atominfo.x</div>
<div class="line">vwr2upf.x</div>
<div class="line">uspp2upf.x</div>
<div class="line">upf2upfSO.x</div>
<div class="line">convert_rho.x</div>
<div class="line">convert_realwg.x</div>
<div class="line">convert_wg2rho.x</div>
<div class="line">plot_band_structrure.x</div>
<div class="line">plot_DOS.py</div>
<div class="line">plot_DOS_interp.x</div>
<div class="line">absorption_spec_K2step.x</div>
<div class="line">plot_ABSORB_interp.x</div>
<div class="line">plot_wg.x</div>
<div class="line">plot_TDDFT.x</div>
<div class="line">plot_fatband_structure.x</div>
<div class="line">plot_electrical_conductivity.x</div>
<div class="line">plot_tddft_absorp.x</div>
<div class="line">split_kp.x</div>
<div class="line">add_field.x</div>
<div class="line">NAMD_psi.x</div>
<div class="line">NAMD_Boltzman.x</div>
<div class="line">ug_moment.x</div>
<div class="line">vacumm.x</div>
<div class="line">Gap_Read</div>
<div class="line">nonradiative.x</div>
</div>
</div>
</div>
<div class="section" id="format-conversion">
<h2>Format conversion<a class="headerlink" href="#format-conversion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="poscar2config-x">
<h3>poscar2config.x<a class="headerlink" href="#poscar2config-x" title="Permalink to this headline">¶</a></h3>
<p>convert VASP POSCAR file to atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ poscar2config.x POSCAR
</pre></div>
</div>
</div>
<div class="section" id="cell2config-x">
<h3>cell2config.x<a class="headerlink" href="#cell2config-x" title="Permalink to this headline">¶</a></h3>
<p>convert CASTEP CELL format file to atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cell2config.x &lt; input.cell
</pre></div>
</div>
</div>
<div class="section" id="xsf2config-x">
<h3>xsf2config.x<a class="headerlink" href="#xsf2config-x" title="Permalink to this headline">¶</a></h3>
<p>convert xsf format file to atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xsf2config.x &lt; input.xsf
</pre></div>
</div>
</div>
<div class="section" id="pwscf2config-x">
<h3>pwscf2config.x<a class="headerlink" href="#pwscf2config-x" title="Permalink to this headline">¶</a></h3>
<p>convert pwscf input file to atom.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pwscf2config.x &lt; pwscf.in
</pre></div>
</div>
</div>
<div class="section" id="convert-from-config-x">
<h3>convert_from_config.x<a class="headerlink" href="#convert-from-config-x" title="Permalink to this headline">¶</a></h3>
<p>convert atom.config or final.config or MOVEMENT to .xsf and .xyz format
file , so they can be used by different visualization tools for viewing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ convert_from_config.x atom.config
</pre></div>
</div>
</div>
<div class="section" id="config2poscar-x">
<h3>config2poscar.x<a class="headerlink" href="#config2poscar-x" title="Permalink to this headline">¶</a></h3>
<p>convert atom.config or final.config to VASP POSCAR format</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ config2poscar.x atom.config
</pre></div>
</div>
</div>
<div class="section" id="atominfo-x">
<h3>atominfo.x<a class="headerlink" href="#atominfo-x" title="Permalink to this headline">¶</a></h3>
<p>show structure information in atom.config or final.config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ atominfo.x atom.config
</pre></div>
</div>
</div>
<div class="section" id="vwr2upf-x">
<h3>vwr2upf.x<a class="headerlink" href="#vwr2upf-x" title="Permalink to this headline">¶</a></h3>
<p>convert vwr format pseudopotential file to upf format pseudopotential
file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vwr2upf.x input.vwr
</pre></div>
</div>
</div>
<div class="section" id="uspp2upf-x">
<h3>uspp2upf.x<a class="headerlink" href="#uspp2upf-x" title="Permalink to this headline">¶</a></h3>
<p>convert uspp format pseudopotential file to upf format pseudopotential
file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ uspp2upf.x input.uspp
</pre></div>
</div>
</div>
<div class="section" id="upf2upfso-x">
<h3>upf2upfSO.x<a class="headerlink" href="#upf2upfso-x" title="Permalink to this headline">¶</a></h3>
<p>convert spin-orbital pseudopotential file of pwscf to spin-orbital
pseudopotential file of PWmat</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ upf2upfSO.x &lt; input
</pre></div>
</div>
</div>
<div class="section" id="convert-rho-x">
<h3>convert_rho.x<a class="headerlink" href="#convert-rho-x" title="Permalink to this headline">¶</a></h3>
<p>convert potential file OUT.VR or charge density file OUT.RHO or
OUT.REAL.RHOWF_SP to RHO.xsf which can be visualized with VESTA</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ convert_rho.x OUT.RHO or convert_rho.x OUT.VR
</pre></div>
</div>
</div>
<div class="section" id="convert-realwg-x">
<h3>convert_realwg.x<a class="headerlink" href="#convert-realwg-x" title="Permalink to this headline">¶</a></h3>
<p>convert the wave function file (OUT.REAL_RHOWF_SP) in real space. Like
the convert_rho.x, it will output a file in XSF type which will be read
by VESTA.</p>
<p><strong>Syntax</strong>: convert_realwg.x OUT.REAL.RHOWF_SP01</p>
</div>
<div class="section" id="convert-wg2rho-x">
<h3>convert_wg2rho.x<a class="headerlink" href="#convert-wg2rho-x" title="Permalink to this headline">¶</a></h3>
<p>convert one or more wave function in OUT.WG file to charge density,
stored in OUT.WG2RHO</p>
<p><strong>Syntax</strong>: convert_wg2rho.x</p>
</div>
</div>
<div class="section" id="data-visualization">
<h2>Data visualization<a class="headerlink" href="#data-visualization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="plot-band-structure-x">
<h3>plot_band_structure.x<a class="headerlink" href="#plot-band-structure-x" title="Permalink to this headline">¶</a></h3>
<p>Before run the plot_band_structure.x, please prepare REPORT and
OUT.FERMI (this file is copied from the SCF calculation). Then it will
generate the following files: bandstructure.eps, bandstructure.png,
bandstructure.pdf and bandstructure_1.txt (the data file of band
structure), which can be used to plot band with specified scale and
regions. Note, for “spin=2”, another data file bandstructure_2.txt will
be generated.</p>
<p><strong>Syntax</strong>: plot_band_structure.x</p>
</div>
<div class="section" id="plot-dos-py-plot-dos-interp-x">
<h3>plot_DOS.py &amp; plot_DOS_interp.x<a class="headerlink" href="#plot-dos-py-plot-dos-interp-x" title="Permalink to this headline">¶</a></h3>
<p>This program uses the DOS.totalspin with 0.1 eV energy broadening. If
one want to shift the Fermi energy to zero, the OUT.FERMI is needed.
After running the plot_DOS.py, it will generate dos.eps or dos.jpg.
However, if one wishes to change this broadening, or more importantly,
plot the atomic selected partial DOS, one can use this
plot_DOS_interp.x. To do that, one needs to provide a modified
xatom.input file, with the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">30</span> <span class="mf">0.952534560</span> <span class="mf">0.363594470</span> <span class="mf">0.382027650</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w1</span>
<span class="mi">30</span> <span class="mf">0.540553000</span> <span class="mf">0.850230410</span> <span class="mf">0.966359450</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w2</span>
<span class="o">...</span>
<span class="mi">16</span> <span class="mf">0.242857140</span> <span class="mf">0.140553000</span> <span class="mf">0.684331800</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">w3</span>
</pre></div>
</div>
</div>
<p>Here w1, w2, w3 are the weight for this atom in the partial DOS. Note,
the plot_DOS_interp.x will rewrite the file “DOS.totalspin”.</p>
<p>Note, the plot_DOS_interp.x uses k-point interpolation to generate the
DOS. It is very useful for bulk systems. In order to use this, when
running JOB=DOS, one has to use DOS_DETAIL with IDOS_interp=1.
Furthermore, when running plot_DOS_interp.x, one has to provide an input
file: DOS.input, with the following contents:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
<span class="mi">1</span>
<span class="mf">0.05</span>
<span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
<p>The <strong>1st</strong> line: if setting 0, it means plotting DOS for all atoms; if
setting 1, for partial atoms. Note, when doing for partial atoms, one
need to add the 8th column to set the weights for all the atoms.</p>
<p>The <strong>2nd</strong> line: if setting 1, it means using interpolation for DOS
plotting; if setting 0, it keeps the old method, not doing
interpolation, just using a Gaussian broadening.</p>
<p>The <strong>3rd</strong> line: energy smearing, in <span class="math notranslate nohighlight">\(eV\)</span>.</p>
<p>The <strong>4th</strong> line: <span class="math notranslate nohighlight">\(NM_1, NM_2, NM_3\)</span>:, the interpolation grid,
with in each grid in :math:<a href="#id807"><span class="problematic" id="id808">`</span></a>NQ_1,</p>
<blockquote>
<div><p>NQ_2,NQ_3`.</p>
</div></blockquote>
<p>Here ipart_DOS indicate whether to do partial DOS. For partial DOS, the
weight has to be provided in atom.config as discussed above. interp=0 or
1. For 0, there is no k-point interpolation. For 1, there is k-point
interpolation (must use DOS_DETAIL with IDOS_interp=1). E_b is the
energy smearing in the unit of eV. nm1,nm2,nm3 is the number of
interpolation point for each k-point grid in the original JOB=DOS
calculation. Larger nm1,nm2,nm3 will result in smoother DOS, but cost
more time to run plot_DOS_interp.x. Usually 30,30,30 is good enough.</p>
<p><strong>Syntax</strong>: plot_DOS.py or plot_DOS_interp.x</p>
</div>
<div class="section" id="absorption-spec-k2step-x">
<h3>absorption_spec_K2step.x<a class="headerlink" href="#absorption-spec-k2step-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to plot optical absorption spectrum, it reads PWmat
output files: MDDIPOLE.KSPACE, OUT.TDDFT_TIME. In addition, one has to
provide a input file: absorp_K.input, with the following contents:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>5.0                   !broading fact
200 0.001             !MD_step1, dt1(fs)
1000 0.01             !MD_step2, dt2(fs)
1.8, 20               !w_cut_min, w_cut_max (eV)
8                     !N_electron
0.002                 !E_field
2.7155 2.7155 0.0     !AL(:,1)
2.7155 0.0    2.7155  !AL(:,2)
0.0    2.7155 2.7155  !AL(:,3)
</pre></div>
</div>
</div>
<p>For more detail information about absorption_spec_K2step.x and
absorp_K.input, please refer to “<a class="reference external" href="http://www.pwmat.com/module-download">module
18</a>” on PWmat website.</p>
<p><strong>Syntax</strong>: absorption_spec_K2step.x</p>
</div>
<div class="section" id="plot-absorb-interp-x">
<h3>plot_ABSORB_interp.x<a class="headerlink" href="#plot-absorb-interp-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to plot optical absorption spectrum with RPA
method, one could use LDA, PBE, or HSE functions for this calculation.
One can just do the calculation like DOS, but need do interpolation.
<strong>(WARNING)</strong>: when do interpolatation, K point parallelization is not
allowed. Then PWmat will output files: OUT.GKK, OUT.WG (slightly
modified). One can use ug_moment.x to calculate
<span class="math notranslate nohighlight">\(&lt;\psi_i|p_x|\psi_j&gt;\)</span> or use plot_ABSORB_interp.x to calculate the
absorption spectrum directly. The result is written in
“absorb.spectrum”. Note when using plot_ABSORB_interp.x, one should add
Fermi energy in “DOS.input” like this (starting with # is the comment
line):</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
<span class="mi">1</span>
<span class="mf">0.05</span>  <span class="mf">14.9982034</span>
<span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>
<span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">SYMM</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span>
</pre></div>
</div>
</div>
<p><strong>Syntax</strong>: plot_ABSORB_interp.x</p>
</div>
<div class="section" id="plot-wg-x">
<h3>plot_wg.x<a class="headerlink" href="#plot-wg-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to plot OUT.WG, and the output file is written in
PSI.xsf, which can be visualized by VESTA.</p>
<p><strong>Syntax</strong>: plot_wg.x</p>
</div>
<div class="section" id="plot-tddft-x">
<h3>plot_TDDFT.x<a class="headerlink" href="#plot-tddft-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to plot RT-TDDFT output, it reads PWmat output
file: OUT.TDDFT1. Here we give some descriptions of the code about how
to read the “OUT.TDDFT1“.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">open</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s2">&quot;OUT.TDDFT1&quot;</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s2">&quot;unformatted&quot;</span><span class="p">)</span>
<span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">islda</span><span class="p">,</span><span class="n">nkpt</span><span class="p">,</span><span class="n">mx</span><span class="p">,</span><span class="n">nref_tot_8</span><span class="p">,</span><span class="n">natom</span><span class="p">,</span><span class="n">nnodes</span>
<span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">mst_win0</span><span class="p">,</span><span class="n">mst_win</span><span class="p">,</span><span class="n">mst_td</span><span class="p">,</span><span class="n">mst</span>
<span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">isTddftOut1_Cmat</span><span class="p">,</span><span class="n">dtTddftout1</span>
<span class="n">do</span> <span class="n">iislda</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">islda</span>
    <span class="n">do</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
        <span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
        <span class="n">dt_time</span><span class="p">,</span><span class="n">iislda</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">weighkpt_2</span><span class="p">(</span><span class="n">kpt</span><span class="p">),</span><span class="n">akx_2</span><span class="p">(</span><span class="n">kpt</span><span class="p">),</span><span class="n">aky_2</span><span class="p">(</span><span class="n">kpt</span><span class="p">),</span><span class="n">akz_2</span><span class="p">(</span><span class="n">kpt</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">E_st</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mst</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span><span class="o">*</span><span class="n">Hartree_ev</span>
        <span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">dos_adiabatic</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mst</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">isTddftOut1_Cmat</span><span class="p">)</span> <span class="n">then</span>
            <span class="n">write</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">Cmat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">mst</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">mst_td</span><span class="p">,</span><span class="n">kpt</span><span class="p">,</span><span class="n">iislda</span><span class="p">)</span>
        <span class="n">endif</span>
    <span class="n">enddo</span>
<span class="n">enddo</span>
</pre></div>
</div>
</div>
<p><strong>Syntax</strong>: plot_TDDFT.x</p>
</div>
<div class="section" id="plot-fatband-structure-x">
<h3>plot_fatband_structure.x<a class="headerlink" href="#plot-fatband-structure-x" title="Permalink to this headline">¶</a></h3>
<p>Before run the plot_fatband_structure.x, please prepare REPORT and
OUT.FERMI (this file is copied from the SCF calculation). Then it will
generate the output file: fatbandstructure_1.txt (the data file of band
structure), which can be used to plot band with specified scale and
regions. Note, for “spin=2”, another data file fatbandstructure_2.txt
will be generated. For more detail information, please refer to “<a class="reference external" href="http://www.pwmat.com:8080/upload/module/pdf/projected_DOS_and_band_structure.pdf">module
15</a>”
on PWmat website.</p>
<p><strong>Syntax</strong>: plot_fatband_structure.x</p>
</div>
<div class="section" id="plot-electrical-conductivity-x">
<h3>plot_electrical_conductivity.x<a class="headerlink" href="#plot-electrical-conductivity-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate electrical conductivity using
Kubo-Greenwood electrical conductivity formulation. In addition, one has
to provide a input file: DOS.input, with the following contents:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
<span class="mi">1</span>
<span class="mf">0.2</span> <span class="mf">10.2703558119227</span> <span class="mi">300</span>
<span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<p>The <strong>1st</strong> line: if setting 0, it means plotting DOS for all atoms; if
setting 1, for partial atoms. Note, when doing for partial atoms, one
need to add the 8th column to set the weights for all the atoms.</p>
<p>The <strong>2nd</strong> line: if setting 1, it means using interpolation for DOS
plotting; if setting 0 , it keeps the old method, not doing
interpolation, just using a Gaussian broadening.</p>
<p>The <strong>3rd</strong> line: energy smearing, unit eV; Fermi energy, uniteV;
temperature, unit Kevine. the temperaturefor Fermi-Dirac formula to
calculate the electron occupations of the eigen wave functions according
to their eigen energies.</p>
<p>The <strong>4th</strong> line: NM1, NM2, NM3,the interpolation grid, with in each
grid in NQ1, NQ2, NQ3.</p>
<p>For more detail information about plot_electrical_conductivity.x, please
refer to “<a class="reference external" href="http://www.pwmat.com:8080/upload/module/pdf/15b0ddc6d827ad92fb59981221000863.pdf">module
16</a>”
on PWmat website.</p>
<p><strong>Syntax</strong>: plot_electrical_conductivity.x</p>
</div>
<div class="section" id="plot-tddft-absorp-x">
<h3>plot_tddft_absorp.x<a class="headerlink" href="#plot-tddft-absorp-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate RT-TDDFT optical absorption spectrum
for isolated systems, such as clusters and molecules, please refer to
<a class="reference external" href="http://www.pwmat.com:8080/upload/module/pdf/plot_tddft_absorp.pdf">module
2</a>
on PWmat website.</p>
</div>
<div class="section" id="split-kp-x">
<h3>split_kp.x<a class="headerlink" href="#split-kp-x" title="Permalink to this headline">¶</a></h3>
<p>To generate the k-points between the specific points of the Brillouin
zone, one can use “split_kp.x”. One should prepare an input file for
“split_kp.x”. Note the file name can be arbitrary except for “IN.KPT”,
because “split_kp.x” will output the k-points file which PWmat will use
for band structure calculation. The input file naming “gen.kpt”:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BAND</span>    <span class="c1"># TAG line</span>
<span class="mi">10</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="n">G</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="n">X</span>
<span class="mi">15</span>
<span class="mf">0.5</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="n">X</span>
<span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="n">R</span>
<span class="mi">10</span>
<span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="n">R</span>
<span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.0</span> <span class="n">M</span>
</pre></div>
</div>
</div>
<p>After running “split_kp.x gen.kpt”, “split_kp.x” will generate
10 k-points between “G” and “X”, 15 k-points between “X” and “R” …,
and write all the k-points in “IN.KPT”. The coordinates of the k-points
should be in reciprocal coordinates. Note the words start with # is the
comment line, not essential.</p>
</div>
</div>
<div class="section" id="post-processing">
<h2>post processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-field-x">
<h3>add_field.x<a class="headerlink" href="#add-field-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to add external electric field, and it will
generate IN.VR.EXT file. You can copy IN.VR.EXT to IN.VEXT, which can be
read by PWmat. One should prepare two input files: IN.VR and gen.vext.
IN.VR is a binary file, which can be obtained by PWmat. Here is a way:
set “OUT.REAL.RHOWF_SP=2” in etot.input, then PWmat will generate output
file: OUT.REAL.RHOWF_SP. The data structure of OUT.REAL.RHOWF_SP is
similar to OUT.VR and OUT.RHO. One can copy OUT.REAL.RHOWF_SP to IN.VR.
The other input file is gen.vext, with the following contents:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Illustration</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VR_CENTER</p></td>
<td><p>VR_CNETER = a1 a2 a3, Center of external electric
field, default values: 0.5 0.5 0.5 (fractional
coordinates in x, y, z drection)</p></td>
</tr>
<tr class="row-odd"><td><p>VR_TYPE</p></td>
<td><p>VR_TYPE supports three type of external electric
field, please refer to VR_DETAIL</p></td>
</tr>
<tr class="row-even"><td><p>VR_DETAIL</p></td>
<td><p>VR_TYPE = 1, VR_DETAIL= a4 a5 a6 (the units of a3, a4,
a5 are <span class="math notranslate nohighlight">\(Hartree/Bohr\)</span>),
Vext(r)=(x-a1)*a4+(y-a2)*a5+(z-a3)*a6 ; VR_TYPE = 2,
VR_DETAIL= a4 a5 a6 a7 a8 a9 (the units of a4, a8 are
<span class="math notranslate nohighlight">\(Hartree/Bohr\)</span>; the units of a5, a6, a7, a9 are
<span class="math notranslate nohighlight">\(Hartree/Bohr^2\)</span>),
Vext(
r)=(x-a1)*a4+<span class="math notranslate nohighlight">\((x-a1)^2\)</span>*a5+(y-a2)*a6+:mat
h:<cite>(y-a2)^2</cite>*a7+(z-a3)*a8+<span class="math notranslate nohighlight">\((z-a3)^2\)</span>*a9;
VR_TYPE = 3, VR_DETAIL= a4 a5 (the unit of a4 is
Hartree, the unit of a5 is Bohr),
Vext(r)=a4*exp-[<span class="math notranslate nohighlight">\((x-a1)^2\)</span>+<span class="math notranslate nohighlight">\((y-a2)^2\)</span>+<span class="math notranslate nohighlight">\((z-a3)^2\)</span>]/<span class="math notranslate nohighlight">\(a5^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>ADD_VR</p></td>
<td><p>ADD_VR = T, add the external electric file to the
original potential file (for example, IN.VR), and
generate EXT file; ADD_VR = F, only import the
external electric field to EXT file.</p></td>
</tr>
</tbody>
</table>
<p>For more detail information, please refer to
<a class="reference external" href="http://www.pwmat.com:8080/upload/utility/pdf/add_field.pdf">utility</a>
on PWmat website.</p>
<p><strong>Syntax</strong>: add_field.x IN.VR</p>
</div>
<div class="section" id="namd-psi-x">
<h3>NAMD_psi.x<a class="headerlink" href="#namd-psi-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to plot NAMD output wave functions.</p>
<p><strong>Syntax:</strong> NAMD_psi.x</p>
</div>
<div class="section" id="nam-boltzman-x">
<h3>NAM_Boltzman.x<a class="headerlink" href="#nam-boltzman-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate boltzmann constant for NAMD
calculation.</p>
<p><strong>Syntax:</strong> NAMD_Boltzman.x</p>
</div>
<div class="section" id="ug-moment-x">
<h3>ug_moment.x<a class="headerlink" href="#ug-moment-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate angular momentum, it reads PWmat
outputs: OUT.GKK and IN.WG, and generate moment.matrix file.
moment.matrix is a binary file, which save px, py, pz. You can read
moment.matrix by the following code:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>program read_moment_matrix
    !
    integer :: nkpt, ispin, mx
    complex(kind=8), allocatable, dimension(:,:) :: cdot_gkx, cdot_gky, cdot_gkz
    open (12, file = &#39;moment.matrix&#39;, form = &#39;unformatted&#39;)
    read (12) nkpt, ispin, mx
    allocate (cdot_gkx(mx,mx), cdot_gky(mx,mx), cdot_gkz(mx,mx))
    read (12) cdot_gkx
    read (12) cdot_gky
    read (12) cdot_gkz
    !
end program
</pre></div>
</div>
</div>
<p><strong>Syntax:</strong> ug_moment.x</p>
</div>
<div class="section" id="vacuum-x">
<h3>vacuum.x<a class="headerlink" href="#vacuum-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate vacum level, please refer to
<a class="reference external" href="http://www.pwmat.com:8080/upload/utility/pdf/vacuum.pdf">utility</a> on
PWmat website.</p>
<p><strong>Syntax:</strong> vacuum.x</p>
</div>
<div class="section" id="gap-read">
<h3>Gap_Read<a class="headerlink" href="#gap-read" title="Permalink to this headline">¶</a></h3>
<p>This program is used to read band gap from REPORT file.</p>
<p><strong>Syntax:</strong> Gap_Read</p>
</div>
<div class="section" id="nonradiative-x">
<h3>nonradiative.x<a class="headerlink" href="#nonradiative-x" title="Permalink to this headline">¶</a></h3>
<p>This program is used to calculate defect nonradiative decay, please
refer to <a class="reference external" href="http://www.pwmat.com:8080/upload/module/pdf/defect_nonradiative.pdf">module
13</a>
on PWmat website.</p>
<p><strong>Syntax:</strong> nonradiative.x</p>
</div>
<div class="section" id="out-rho-data-structure">
<h3>OUT.RHO Data Structure<a class="headerlink" href="#out-rho-data-structure" title="Permalink to this headline">¶</a></h3>
<p>Here we give some descriptions of the code about how to read the
“OUT.RHO”.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>OPEN (11, FILE = `OUT.RHO&#39;, FORM = `UNFORMATTED&#39;)
REWIND (11)
! READ THE FFT GRIDS
READ (11, IOSTAT = IERR) N1, N2, N3, NNODES, NSTATE
IF (IERR /= 0) THEN
    REWIND (11)
    READ (11) N1, N2, N3, NNODES
    NSTATE = 1
END IF
READ (11) AL ! READ LATTICE AL(3,3)
NR = N1 * N2 * N3
NR_N = NR / NNODES
ALLOCATE (VR_TMP(NR_N), VR(N1,N2,N3))
DO IST = 1, NSTATE
    DO IREAD = 1, NNODES
       READ (11) VR_TMP
       DO II = 1, NR_N
          JJ = II + (IREAD-1)*NR_N
          I = (JJ-1)/(N2*N3) + 1
          J = (JJ-1-(I-1)*N2*N3)/N3 + 1
          K = JJ - (I-1)*N2*N3 - (J-1)*N3
          VR(I,J,K) = VR_TMP(II)
       END DO
    END DO
END DO
</pre></div>
</div>
</div>
</div>
<div class="section" id="out-wg-data-structure">
<h3>OUT.WG Data Structure<a class="headerlink" href="#out-wg-data-structure" title="Permalink to this headline">¶</a></h3>
<p>Here we give some descriptions of the code about how to read the
“OUT.WG”.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>OPEN (11, FILE = `OUT.WG&#39;, FORM = `UNFORMATTED&#39;)
READ (11) N1, N2, N3, MX
ALLOCATE (UG(N1*N2*N3,MX))
READ (11) ECUT
READ (11) AL ! READ LATTICE AL(3,3)
READ (11) NNODES
DO KPT = 1, NKPT
   DO IWAVEFUN = 1, NBLOCK_BAND_MX
       READ (11) UG(:,IWAVEFUN)
   END DO
END DO
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="work-flow-and-websites">
<h1>Work Flow and Websites<a class="headerlink" href="#work-flow-and-websites" title="Permalink to this headline">¶</a></h1>
<div class="section" id="work-flow">
<span id="appendix-workflow"></span><h2>Work Flow<a class="headerlink" href="#work-flow" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pre-process">
<h3>Pre-process<a class="headerlink" href="#pre-process" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>prepare xyz and xsf format file</p></li>
<li><p>convert_to_config.x</p></li>
<li><p>prepare etot.input</p></li>
</ol>
</div>
<div class="section" id="run-pwmat">
<h3>Run PWmat<a class="headerlink" href="#run-pwmat" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>MD</p></li>
<li><p>RELAX</p></li>
<li><p>SCF</p></li>
<li><p>NONSCF</p></li>
<li><p>DOS</p></li>
<li><p>TDDFT</p></li>
<li><p>NAMD</p></li>
</ol>
</div>
<div class="section" id="post-process">
<h3>Post-process<a class="headerlink" href="#post-process" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>plot_band.x</p></li>
<li><p>plot_dos.x</p></li>
<li><p>convert_rho.x</p></li>
<li><p>convert_from_config.x</p></li>
<li><p>Post-pwscf calculation</p></li>
</ol>
</div>
</div>
<div class="section" id="useful-websites">
<h2>Useful Websites<a class="headerlink" href="#useful-websites" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>PWmat: <a class="reference external" href="http://www.pwmat.com/">http://www.pwmat.com/</a></p></li>
<li><p>Quantum Espresso: <a class="reference external" href="http://www.quantum-espresso.org/">http://www.quantum-espresso.org/</a></p></li>
<li><p>Wannier90: <a class="reference external" href="http://www.wannier.org/">http://www.wannier.org/</a></p></li>
<li><p>American Mineralogist Crystal Structure Database:
<a class="reference external" href="http://rruff.geo.arizona.edu/AMS/amcsd.php">http://rruff.geo.arizona.edu/AMS/amcsd.php</a></p></li>
<li><p>NIST Chemistry WebBook: <a class="reference external" href="http://webbook.nist.gov/chemistry/">http://webbook.nist.gov/chemistry/</a></p></li>
<li><p>Nvidia Cuda Zone: <a class="reference external" href="https://developer.nvidia.cn/">https://developer.nvidia.cn/</a></p></li>
<li><p>XCrySDen: <a class="reference external" href="http://www.xcrysden.org/">http://www.xcrysden.org/</a></p></li>
<li><p>VESTA: <a class="reference external" href="http://www.jp-minerals.org/vesta/en/">http://www.jp-minerals.org/vesta/en/</a></p></li>
<li><p>VMD: <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/">http://www.ks.uiuc.edu/Research/vmd/</a></p></li>
</ol>
</div>
</div>
<div class="section" id="tddft-and-namd-manual-and-examples">
<span id="chapter-appendix"></span><h1>TDDFT and NAMD Manual and Examples<a class="headerlink" href="#tddft-and-namd-manual-and-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="job-tddft">
<h2>JOB=TDDFT<a class="headerlink" href="#job-tddft" title="Permalink to this headline">¶</a></h2>
<p>carry out real time TDDFT (rt-TDDFT) simulations. The It supports,</p>
<ol class="arabic simple">
<li><p>xcfunctional=lda/pbe</p></li>
<li><p>norm-conserving pseudopotential</p></li>
</ol>
<p>Note, JOB=TDDFT requires TDDFT_DETAIL, MD_DETAIL.</p>
</div>
<div class="section" id="tddft-detail">
<h2>TDDFT_DETAIL<a class="headerlink" href="#tddft-detail" title="Permalink to this headline">¶</a></h2>
<p><strong>TDDFT_DETAIL = :math:`m_1` :math:`m_2` mstate</strong></p>
<p>Default: TDDFT_DETAIL = 1,NUM_BAND,NUM_BAND.</p>
<p>This is mostly required for JOB=TDDFT. We strongly encourage to include
this line. In the TDDFT simulation, we will calculate time dependent
state <span class="math notranslate nohighlight">\(\psi_j(t)\)</span>, j=1,mstate. Note, mstate is different from
NUM_BAND. The NUM_BAND is the number of calculated adiabatic state
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span>. For the first <span class="math notranslate nohighlight">\(m_1-1\)</span> <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> state
(j=1,<span class="math notranslate nohighlight">\(m_1-1\)</span>), <span class="math notranslate nohighlight">\(\psi_j(t)=\phi_j(t)\)</span>, e.g., they are just
the adiabatic states (just like in Born-Oppenheimer MD). However, for
the rest, mstate-<span class="math notranslate nohighlight">\(m_1\)</span>+1 <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> states, they are
expanded by the adiabatic state window [<span class="math notranslate nohighlight">\(m_1\)</span>,<span class="math notranslate nohighlight">\(m_2\)</span>]. The
occupation number of <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> are fixed. They are either given
by the first SCF iteration Fermi-Dirac distribution, or given by input.
Thus, in total, there will be <span class="math notranslate nohighlight">\(m_2\)</span> state to be used, with the
first <span class="math notranslate nohighlight">\(m_1-1\)</span> to be the same as <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> to be occupied,
and the rest of the state, the [<span class="math notranslate nohighlight">\(m_1\)</span>,<span class="math notranslate nohighlight">\(m_2\)</span>] as the window
to expand the rest of wave function <span class="math notranslate nohighlight">\(\psi_j(t)\)</span>.</p>
<p>Expand <span class="math notranslate nohighlight">\(\psi_j(t)\)</span> in terms of the adiabatic eigenstates
<span class="math notranslate nohighlight">\(\phi_i(t)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\psi_j(t)=\sum\limits_{i}C_{ji}\phi_i(t)\end{aligned}\]</div>
<p>Define the Adiabatic window <span class="math notranslate nohighlight">\([m1,m2]\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\psi_j(t)=\phi_j(t), j=1,m1-1\end{aligned}\]</div>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\psi_j(t)=\sum_i C_{ji}(t)\phi_i(t), j=m1,mstate;i=m1,m2\end{aligned}\]</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\([m1,m2]\)</span></p></th>
<th class="head"><p>Adiabatic window <span class="math notranslate nohighlight">\(\phi_{i,i=m1,m2}\)</span>. The
<span class="math notranslate nohighlight">\([1,m1-1]\)</span> will always be occupied by
the first <span class="math notranslate nohighlight">\(\psi_{j,j=1,m1-1}\)</span> states.
<span class="math notranslate nohighlight">\(m2 \in [m1,NUM\_BAND]\)</span>, usually
<span class="math notranslate nohighlight">\(m2\)</span> is smaller than <span class="math notranslate nohighlight">\(NUM\_BAND\)</span>
by a few states, cause the last few states
maybe not converge well.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([1,mstate]\)</span></p></td>
<td><p>Wavefunction index.
<span class="math notranslate nohighlight">\(\psi_{j,j=1,mstate}\)</span>.
<span class="math notranslate nohighlight">\(mstate\in [m1,m2]\)</span></p></td>
</tr>
</tbody>
</table>
<div class="section" id="example-b-2-1-default-settings">
<h3>example B.2.1: default settings<a class="headerlink" href="#example-b-2-1-default-settings" title="Permalink to this headline">¶</a></h3>
<p>atom.config:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
<span class="n">Lattice</span> <span class="n">vector</span>
<span class="mf">5.65</span>      <span class="mf">0.00</span>      <span class="mf">0.00</span>
<span class="mf">0.00</span>      <span class="mf">5.65</span>      <span class="mf">0.00</span>
<span class="mf">0.00</span>      <span class="mf">0.00</span>      <span class="mf">5.65</span>
<span class="n">Position</span><span class="p">,</span> <span class="n">move_x</span><span class="p">,</span> <span class="n">move_y</span><span class="p">,</span> <span class="n">move_z</span>
<span class="mi">31</span>    <span class="mf">0.0010</span>   <span class="mf">0.0000</span>   <span class="mf">0.0000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">1.0</span>
<span class="mi">31</span>    <span class="mf">0.0000</span>   <span class="mf">0.5010</span>   <span class="mf">0.5020</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">1.0</span>
<span class="mi">31</span>    <span class="mf">0.5000</span>   <span class="mf">0.0000</span>   <span class="mf">0.5000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">1.0</span>
<span class="mi">31</span>    <span class="mf">0.5000</span>   <span class="mf">0.5000</span>   <span class="mf">0.0000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">1.0</span>
<span class="mi">33</span>    <span class="mf">0.2500</span>   <span class="mf">0.2500</span>   <span class="mf">0.2500</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">0.0</span>
<span class="mi">33</span>   <span class="o">-</span><span class="mf">0.2500</span>  <span class="o">-</span><span class="mf">0.2500</span>   <span class="mf">0.2500</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">0.0</span>
<span class="mi">33</span>   <span class="o">-</span><span class="mf">0.2500</span>   <span class="mf">0.2500</span>  <span class="o">-</span><span class="mf">0.2500</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">0.0</span>
<span class="mi">33</span>    <span class="mf">0.2500</span>  <span class="o">-</span><span class="mf">0.2500</span>  <span class="o">-</span><span class="mf">0.2500</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>   <span class="mf">0.0</span>
</pre></div>
</div>
</div>
<p>etot.input:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
<div class="section" id="example-b-2-2-adiabatic-window">
<h3>example B.2.2: adiabatic window<a class="headerlink" href="#example-b-2-2-adiabatic-window" title="Permalink to this headline">¶</a></h3>
<p>from the output file OUT.OCC of example1,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KPOINTS</span>   <span class="mi">1</span><span class="p">:</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>
<span class="n">NO</span><span class="o">.</span>   <span class="n">ENERGY</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span> <span class="n">OCCUPATION</span>
 <span class="mi">1</span>    <span class="o">-</span><span class="mf">10.7422</span>   <span class="mf">2.00000</span>
 <span class="mi">2</span>     <span class="o">-</span><span class="mf">8.3784</span>   <span class="mf">2.00000</span>
 <span class="mi">3</span>     <span class="o">-</span><span class="mf">8.2272</span>   <span class="mf">2.00000</span>
 <span class="mi">4</span>     <span class="o">-</span><span class="mf">8.1217</span>   <span class="mf">2.00000</span>
 <span class="mi">5</span>     <span class="o">-</span><span class="mf">5.0553</span>   <span class="mf">2.00000</span>
 <span class="mi">6</span>     <span class="o">-</span><span class="mf">5.0473</span>   <span class="mf">2.00000</span>
 <span class="mi">7</span>     <span class="o">-</span><span class="mf">5.0042</span>   <span class="mf">2.00000</span>
 <span class="mi">8</span>     <span class="o">-</span><span class="mf">0.8431</span>   <span class="mf">2.00000</span>
 <span class="mi">9</span>     <span class="o">-</span><span class="mf">0.8061</span>   <span class="mf">2.00000</span>
<span class="mi">10</span>     <span class="o">-</span><span class="mf">0.7368</span>   <span class="mf">2.00000</span>
<span class="mi">11</span>     <span class="o">-</span><span class="mf">0.7011</span>   <span class="mf">2.00000</span>
<span class="mi">12</span>     <span class="o">-</span><span class="mf">0.6666</span>   <span class="mf">2.00000</span>
<span class="mi">13</span>     <span class="o">-</span><span class="mf">0.6165</span>   <span class="mf">2.00000</span>
<span class="mi">14</span>      <span class="mf">1.8319</span>   <span class="mf">1.99983</span>
<span class="mi">15</span>      <span class="mf">2.0285</span>   <span class="mf">1.99966</span>
<span class="mi">16</span>      <span class="mf">2.1978</span>   <span class="mf">1.99956</span>
<span class="mi">17</span>      <span class="mf">2.4204</span>   <span class="mf">0.00095</span>
<span class="mi">18</span>      <span class="mf">3.0161</span>   <span class="mf">0.00000</span>
<span class="mi">19</span>      <span class="mf">3.0985</span>   <span class="mf">0.00000</span>
<span class="mi">20</span>      <span class="mf">3.2698</span>   <span class="mf">0.00000</span>
<span class="mi">21</span>      <span class="mf">3.3809</span>   <span class="mf">0.00000</span>
<span class="mi">22</span>      <span class="mf">3.4191</span>   <span class="mf">0.00000</span>
<span class="mi">23</span>      <span class="mf">3.5045</span>   <span class="mf">0.00000</span>
<span class="mi">24</span>      <span class="mf">5.4035</span>   <span class="mf">0.00000</span>
<span class="mi">25</span>      <span class="mf">5.5223</span>   <span class="mf">0.00000</span>
<span class="mi">26</span>      <span class="mf">5.6578</span>   <span class="mf">0.00000</span>
</pre></div>
</div>
</div>
<p>we know that the <span class="math notranslate nohighlight">\([1,16]\)</span> states are occupied, and the total num
of band is 26. Then we can set the TDDFT_DETAIL=m1 m2
mstate,<span class="math notranslate nohighlight">\(m1 \in [1,16]\)</span>, <span class="math notranslate nohighlight">\(m2 \in [m1,26]\)</span>,
<span class="math notranslate nohighlight">\(mstate \in [m1,m2]\)</span></p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_DETAIL</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">23</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">convergence</span> <span class="o">=</span> <span class="n">difficult</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="out-tddft-1">
<span id="id809"></span><h2>OUT.TDDFT<a class="headerlink" href="#out-tddft-1" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><strong>OUT.TDDFT = :math:`T_1`, :math:`T_2`, :math:`n_1`, :math:`T_3`,
:math:`n_2`</strong></div>
<div class="line"><strong>DEFAULT:= F F 1.0 F 1.0</strong></div>
</div>
<p>The output files can be used to restart TDDFT and show the process of
TDDFT.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(T1,T2,n1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(T1=T/F\)</span></p></th>
<th class="head"><p>eigen energy, <span class="math notranslate nohighlight">\(occ(i)\)</span>
per <span class="math notranslate nohighlight">\(n1\)</span> fs. The output
will be in file OUT.TDDFT1.
One can use
plot_TDDFT.f90(ref. util) to
read and output OUT.TDDFT1.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p><span class="math notranslate nohighlight">\(T2=T/F\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{ij}\)</span> per n1 fs</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T3,n2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(T3=T/F\)</span></p></td>
<td><p>output all the wavefunctions
and charge densities per
<span class="math notranslate nohighlight">\(n2\)</span> fs for restart. The
output will be in file
OUT.TDDFT and directory
TDDOS/. This can be very
expensive, so use large
<span class="math notranslate nohighlight">\(n2\)</span>.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="example-b-3-1-output-files">
<h3>example B.3.1: output files<a class="headerlink" href="#example-b-3-1-output-files" title="Permalink to this headline">¶</a></h3>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span> <span class="o">=</span> <span class="n">T</span> <span class="n">T</span> <span class="mf">1.0</span> <span class="n">T</span>  <span class="mf">5.0</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span>ls</p>
<div class="tabular docutils container">
<p>./&amp;OUT.TDDFT1&amp;</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>update per 1.0 fs</p></td>
</tr>
<tr class="row-even"><td><p>used by plot_TDDFT.f90</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">./&amp;</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>OUT.TDDFT</p></td>
</tr>
</tbody>
</table>
<p>&amp;</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>update per 5.0 fs</p></td>
</tr>
<tr class="row-even"><td><p>used by restarting TDDFT</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">TDDOS/&amp;</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>OUT.WG.<span class="math notranslate nohighlight">\(*\)</span></p></td>
</tr>
<tr class="row-even"><td><p>OUT.EIGEN.<span class="math notranslate nohighlight">\(*\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>OUT.RHO.<span class="math notranslate nohighlight">\(*\)</span></p></td>
</tr>
</tbody>
</table>
<p>&amp;</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>update per 5.0 fs</p></td>
</tr>
<tr class="row-even"><td><p>used by ploting DOS</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="tddft-space-1">
<span id="id810"></span><h2>TDDFT_SPACE<a class="headerlink" href="#tddft-space-1" title="Permalink to this headline">¶</a></h2>
<p><strong>TDDFT_SPACE = itype_space, N, a(1), …, a(N)</strong></p>
<p><strong>DEFAULT:= 0 …</strong></p>
<p>In the TDDFT calculation, we often need to have external potential to
perturb the system (e.g., for optical absorption, or plasmon
excitation). The descriptions of these time dependent, spatial dependent
external potential are controlled by the tags: TDDFT_SPACE, TDDFT_TIME,
or input file IN.VEXT_TDDFT, IN.TDDFT_TIME.</p>
<p>The TDDFT_SPACE controls the real space Vext_tddft(r). Vext_tddft(r)
refers to the external potential in real space for tddft calculation.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_space</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p>No external input term.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p>Read vext_tddft from file IN.VEXT_TDDFT(all capital,
same format as in IN.VEXT).</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p>:
math:<cite>Vext_tddft(r)=(x-a(1))a(4)+(x-a(1))^2a(5)+(y-a
(2))a(6)+(y-a(2))^2a(7)+(z-a(3))a(8)+(z-a(3))^2a(9)</cite>,
a(1),a(2),a(3) in fractional coordinates, a(4)-a(8)
in unit of Hartree/Bohr. output file OUT.VEXT_TDDFT.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(Vext\_tddft(r)
=a(4)e^{-[(x-a(1))^2+(y-a(2))^2+(z-a(3))^2]/a(5)^2}\)</span>,
a(1),a(2),a(3) in fractional coordinates, a(4) in
unit of Hartree, a(5) in unit of Bohr. output file
OUT.VEXT_TDDFT.</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td><p>Not use real space format, but use G-space,it wil use
IN.A_FIELD</p></td>
</tr>
</tbody>
</table>
<div class="section" id="example-b-4-1-itype-space-1-or-2">
<h3>example B.4.1: itype_space=1 or 2<a class="headerlink" href="#example-b-4-1-itype-space-1-or-2" title="Permalink to this headline">¶</a></h3>
<p>First we can get IN.VEXT_TDDFT by set itype_space=2.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>            <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.01</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp OUT.VEXT_TDDFT IN.VEXT_TDDFT</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>            <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
<div class="section" id="example-b-4-2-itype-space-3">
<h3>example B.4.2: itype_space=3<a class="headerlink" href="#example-b-4-2-itype-space-3" title="Permalink to this headline">¶</a></h3>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="in-a-field-1">
<span id="id811"></span><h2>IN.A_FIELD<a class="headerlink" href="#in-a-field-1" title="Permalink to this headline">¶</a></h2>
<p><strong>IN.A_FIELD= T / F, a_field1, a_field2, a_field3</strong></p>
<p>Default:</p>
<p><strong>IN.A_FIELD= F 0.0 0.0 0.0</strong></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><strong>IN.A_FIELD_LIST1= a_field1, a_field2, a_field3 IN.TDDFT_TIME1</strong></div>
<div class="line"><strong>IN.A_FIELD_LIST2= a_field1, a_field2, a_field3 IN.TDDFT_TIME2</strong></div>
<div class="line">…</div>
<div class="line">the maximum support is 20 rows. This can be used to add a circularly
polarized light.</div>
<div class="line">IN.TDDFT_TIME1,IN.TDDFT_TIME2… is the name of TDDFT_TIME file. You
need to prepare same number of TDDFT_TIME files, it has the same
format as IN.TDDFT_TIME,</div>
</div>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="mi">1</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">...</span>
        <span class="n">N</span> <span class="n">ftddft</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This controls the G-sapce external potential input for tddft
calculation. (only used when TDDFT_SPACE=-1,…)</p>
<p>The tddft hamiltonian,</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
H=1/2 (-i\nabla_x + a\_field1)^2+1/2(-i\nabla_y+ a\_field2)^2+1/2(-i\nabla_z + a\_field3)^2
    \end{aligned}\]</div>
<p>The values of <span class="math notranslate nohighlight">\(a\_field1,2,3\)</span> are all in units of 1/Bohr.</p>
<div class="section" id="example-b-5-1-itype-space-1">
<h3>example B.5.1: itype_space=-1<a class="headerlink" href="#example-b-5-1-itype-space-1" title="Permalink to this headline">¶</a></h3>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">A_FIELD</span> <span class="o">=</span> <span class="n">T</span>  <span class="mf">0.1</span> <span class="mf">0.2</span> <span class="mf">0.3</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="tddft-time-1">
<span id="id812"></span><h2>TDDFT_TIME<a class="headerlink" href="#tddft-time-1" title="Permalink to this headline">¶</a></h2>
<p><strong>TDDFT_TIME = itype_time, N, b(1), …, b(N)</strong></p>
<p><strong>DEFAULT:= 0 …</strong></p>
<p>This is used to control the time dimension of the external function
fTDDFT(i).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_time</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ftddft(t)=1.0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p>read in <span class="math notranslate nohighlight">\(ftddft(i)\)</span> from IN.TDDFT_TIME</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f
tddft(t)=b(1)e^{-(t-b(2))^2/b(3)^2)}\sin(b(4)t+b(5))\)</span>.
<span class="math notranslate nohighlight">\(b(2)\)</span>,<span class="math notranslate nohighlight">\(b(3)\)</span> in unit of <span class="math notranslate nohighlight">\(fs\)</span>;
<span class="math notranslate nohighlight">\(b(4)\)</span> in unit of rad/fs, <span class="math notranslate nohighlight">\(b(5)\)</span> in unit
of rad; <span class="math notranslate nohighlight">\(b(1)\)</span> no unit. output file
OUT.TDDFT_TIME</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(22\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ftddft(t)=\int^
t_0 [b(1)e^{-(t-b(2))^2/b(3)^2)}\sin(b(4)t+b(5))] dt\)</span>.
<span class="math notranslate nohighlight">\(b(2)\)</span>,<span class="math notranslate nohighlight">\(b(3)\)</span> in unit of <span class="math notranslate nohighlight">\(fs\)</span>;
<span class="math notranslate nohighlight">\(b(4)\)</span> in unit of <span class="math notranslate nohighlight">\(rad/fs\)</span>, <span class="math notranslate nohighlight">\(b(5)\)</span>
in unit of rad; <span class="math notranslate nohighlight">\(b(1)\)</span> no unit. output file
OUT.TDDFT_TIME</p></td>
</tr>
</tbody>
</table>
<p>File IN.TDDFT_TIME format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">ftddft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">N</span> <span class="n">ftddft</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For TDDFT Hamiltonian, we have,</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>itype_space</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\ne -1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H(t)=H_0+Vext\_tddft(r)ftddft(t)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H
(t)=1/2(-i\nabla_x+A_x*ftddft(t))^2+1/2(-i\nabla_y
+A_y*ftddft(t))^2+1/2(-i\nabla_z+A_z*ftddft(t))^2\)</span></p></td>
</tr>
</tbody>
</table>
<div class="section" id="example-b-6-1-itype-space-2-itype-time-1-or-2">
<h3>example B.6.1: itype_space=2,itype_time=1 or 2<a class="headerlink" href="#example-b-6-1-itype-space-2-itype-time-1-or-2" title="Permalink to this headline">¶</a></h3>
<p>First set itype_time=2,we can get OUT.TDDFT_TIME,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp OUT.TDDFT_TIME IN.TDDFT_TIME</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergence</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="in-occ-in-occ-2">
<h2>IN.OCC/IN.OCC_2<a class="headerlink" href="#in-occ-in-occ-2" title="Permalink to this headline">¶</a></h2>
<p>IN.OCC=T/F</p>
<p>The files are used to set the occupation of adiabatic eigenstates when
FERMI-DIRAC=0 in line “SCF_ITER0_X”. This initial adiabatic states
(<span class="math notranslate nohighlight">\(\phi_i(t=0)\)</span>) are used as the initial time dependent state
(<span class="math notranslate nohighlight">\(\psi_j(t=0)=\psi_j(t=0)\)</span> for all j=1,mstate.</p>
<p>spin=1, use IN.OCC. spin=2, use both IN.OCC and IN.OCC_2.</p>
<p>Files IN.OCC, IN.OCC_2 format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span>
<span class="c1">#occupations for k-point1 (this line should have NUM_BAND number)</span>
<span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span>
<span class="c1">#occupations for k-point2 (this line should have NUM_BAND number)</span>
</pre></div>
</div>
</div>
<p>or</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">*</span><span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span>
<span class="mi">3</span><span class="o">*</span><span class="mf">1.0</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="example-b-7-1-in-occ">
<h3>example B.7.1: IN.OCC<a class="headerlink" href="#example-b-7-1-in-occ" title="Permalink to this headline">¶</a></h3>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">17</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">IN</span><span class="o">.</span><span class="n">OCC</span>  <span class="o">=</span> <span class="n">T</span>
</pre></div>
</div>
</div>
<p>IN.OCC:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mf">0.66666666666666</span>
<span class="mf">0.66666666666666</span> <span class="mf">0.66666666666666</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<p>or</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">13</span><span class="o">*</span><span class="mi">1</span> <span class="mi">3</span><span class="o">*</span><span class="mf">0.66666666666666</span> <span class="mi">1</span> <span class="mi">9</span><span class="o">*</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="in-cc-in-cc-2">
<h2>IN.CC/IN.CC_2<a class="headerlink" href="#in-cc-in-cc-2" title="Permalink to this headline">¶</a></h2>
<p>IN.CC=T/F</p>
<p>The files are used to initialize the <span class="math notranslate nohighlight">\(C_{ij}\)</span> for TDDFT when
FREMI-DIRAC=-1 (Please see “SCF_ITER0_1” for more information), which is
used as <span class="math notranslate nohighlight">\(\psi_j(t)=\sum_i C_{ji}(t)\phi_i(t)\)</span>.</p>
<p>spin=1, use IN.CC. spin=2, use both IN.CC and IN.CC_2.</p>
<p>Files IN.CC, IN.CC_2 format,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>  <span class="mi">1</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">3</span>  <span class="mf">1.0</span>
<span class="mi">2</span>  <span class="mi">4</span>  <span class="mf">0.8</span>  <span class="mi">5</span> <span class="mf">0.2</span>
<span class="mi">1</span>  <span class="mi">5</span>  <span class="mf">1.0</span>
<span class="o">....</span>
</pre></div>
</div>
</div>
<p>Line <span class="math notranslate nohighlight">\(j\)</span> specify the <span class="math notranslate nohighlight">\(\psi_j, j=1,mstate\)</span>. Define pair
(i,CC), <span class="math notranslate nohighlight">\(i\)</span> is the index of adiabatic states, CC is the value of
<span class="math notranslate nohighlight">\(C_{ji}\)</span>. Each line corresponds to one j state: <span class="math notranslate nohighlight">\(\psi_j\)</span> in
the consecutive order of j. The first column number n_pair specifies the
number of pairs described in this line. If m, one index of adiabatic
states, is not specified within a given line, then <span class="math notranslate nohighlight">\(C_{jm}=0\)</span>.</p>
<div class="section" id="example-b-8-1-in-cc">
<h3>example B.8.1: IN.CC<a class="headerlink" href="#example-b-8-1-in-cc" title="Permalink to this headline">¶</a></h3>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">26</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.002</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">NUM_BAND</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">IN</span><span class="o">.</span><span class="n">CC</span><span class="o">=</span><span class="n">T</span>
</pre></div>
</div>
</div>
<p>IN.OCC:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mf">0.66666666666666</span>
<span class="mf">0.66666666666666</span> <span class="mf">0.66666666666666</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<p>IN.CC:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>  <span class="mi">1</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">2</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">3</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">4</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">5</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">6</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">7</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">8</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">9</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">10</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">11</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">12</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">13</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">14</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">15</span> <span class="mf">1.0</span>
<span class="mi">2</span>  <span class="mi">16</span> <span class="mf">0.8</span>  <span class="mi">17</span> <span class="mf">0.2</span>
<span class="mi">1</span>  <span class="mi">17</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">18</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">19</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">20</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">21</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">22</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">23</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">24</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">25</span> <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mi">26</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="md-detail-md-mstep-dt-temp1-temp2">
<h2>MD_DETAIL = MD, MSTEP, DT, TEMP1, TEMP2<a class="headerlink" href="#md-detail-md-mstep-dt-temp1-temp2" title="Permalink to this headline">¶</a></h2>
<p>Note: this is a required line for JOB=MD, JOB=TDDFT and JOB=NAMD. (ref.
PWmat manual 2.1.6.)</p>
</div>
<div class="section" id="restart">
<h2>RESTART<a class="headerlink" href="#restart" title="Permalink to this headline">¶</a></h2>
<p>Needed settings:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MD_DETAIL</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="o">...</span>
</pre></div>
</div>
</div>
<p>Needed files:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span>
<span class="n">TDDOS</span><span class="o">/*</span>
</pre></div>
</div>
</div>
<div class="section" id="example-b-10-1-restart">
<h3>example B.10.1: RESTART<a class="headerlink" href="#example-b-10-1-restart" title="Permalink to this headline">¶</a></h3>
<p>One TDDFT,killed at 10 step.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">A_FIELD</span> <span class="o">=</span> <span class="n">T</span>  <span class="mf">0.1</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span> <span class="o">=</span> <span class="n">T</span> <span class="n">T</span> <span class="mf">1.0</span> <span class="n">T</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>Resart TDDFT.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">A_FIELD</span> <span class="o">=</span> <span class="n">T</span>  <span class="mf">0.1</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span> <span class="o">=</span> <span class="n">T</span> <span class="n">T</span> <span class="mf">1.0</span> <span class="n">T</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot,Ep,Ek plot:</p>
</div>
</div>
<div class="section" id="show-results">
<h2>SHOW_RESULTS<a class="headerlink" href="#show-results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-b-11-1-plot-tddft">
<h3>example B.11.1: plot_tddft<a class="headerlink" href="#example-b-11-1-plot-tddft" title="Permalink to this headline">¶</a></h3>
<p>The file plot_tddft.f90 is in util/. One can check the Module TDDFT
Carrier Cooling for details.(<a class="reference external" href="http://www.pwmat.com/module-download">http://www.pwmat.com/module-download</a>)</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">A_FIELD</span> <span class="o">=</span> <span class="n">T</span>  <span class="mf">0.1</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span> <span class="o">=</span> <span class="n">T</span> <span class="n">T</span> <span class="mf">0.1</span> <span class="n">T</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p>plot_TDDFT.f90 &amp; OUT.TDDFT1:</p>
<p>TDDFT/example B.11.1:ifort plot_TDDFT.f90 -o plot_TDDFT.x</p>
<p>TDDFT/example B.11.1:./plot_TDDFT.x</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">there</span> <span class="ow">is</span> <span class="n">Cmat</span><span class="p">,</span> <span class="n">plot</span> <span class="n">E</span><span class="p">,</span><span class="n">DOS</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Cmat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span>
<span class="n">there</span> <span class="n">are</span> <span class="n">nkpt</span><span class="p">,</span><span class="n">islda</span> <span class="n">spin</span>           <span class="mi">1</span>           <span class="mi">1</span>
<span class="nb">input</span> <span class="n">ikpt</span><span class="p">,</span><span class="n">iislda</span> <span class="n">to</span> <span class="n">plot</span>
<span class="mi">1</span> <span class="mi">1</span>
<span class="n">there</span> <span class="n">are</span>           <span class="mi">26</span>  <span class="n">psi_j</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Cmat</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="nb">input</span> <span class="n">one</span> <span class="n">j</span> <span class="n">to</span> <span class="n">plot</span>
<span class="mi">5</span>
<span class="n">there</span> <span class="n">are</span>           <span class="mi">26</span>  <span class="n">adiabatic</span> <span class="n">state</span> <span class="n">phi_i</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="ow">in</span> <span class="n">Cmat</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="nb">input</span> <span class="n">a</span> <span class="n">window</span> <span class="p">[</span><span class="n">mst1</span><span class="p">,</span><span class="n">mst2</span><span class="p">]</span> <span class="n">to</span> <span class="n">plot</span>
<span class="mi">1</span> <span class="mi">10</span>
<span class="n">Cmat</span> <span class="ow">is</span> <span class="n">written</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">TDDFT</span><span class="o">.</span><span class="n">Cmat</span>
</pre></div>
</div>
</div>
<p>plot plot.TDDFT.Cmat</p>
</div>
<div class="section" id="example-b-11-2-tddos">
<h3>example B.11.2: TDDOS/*<a class="headerlink" href="#example-b-11-2-tddos" title="Permalink to this headline">¶</a></h3>
<p>we can use OUT.EIGEN.* , OUT.WG.* to run JOB=DOS with PWmat.
OUT.EIGEN.* and OUT.WG.* are adiabatic eigen energys and adiabatic
wavefunctions.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">TDDFT</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">A_FIELD</span> <span class="o">=</span> <span class="n">T</span>  <span class="mf">0.1</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">TDDFT_TIME</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">1.</span><span class="n">d0</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">TDDFT</span> <span class="o">=</span> <span class="n">T</span> <span class="n">T</span> <span class="mf">1.0</span> <span class="n">T</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span>ls TDDOS/</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUT</span><span class="o">.</span><span class="n">EIGEN</span><span class="o">.</span><span class="mf">0.100000E+01</span>  <span class="n">OUT</span><span class="o">.</span><span class="n">RHO</span><span class="o">.</span><span class="mf">0.100000E+01</span>  <span class="n">OUT</span><span class="o">.</span><span class="n">WG</span><span class="o">.</span><span class="mf">0.100000E+01</span>
<span class="n">OUT</span><span class="o">.</span><span class="n">OCC_ADIA</span><span class="o">.</span><span class="mf">0.100000E+01</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp OUT.EIGEN.0.100000E+01 OUT.EIGEN</p>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp OUT.WG.0.100000E+01 IN.WG</p>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp OUT.OCC_ADIA.0.100000E+01 IN.OCC_ADIA</p>
<p>etot.input for DOS [the job=dos will read OUT.EIGEN implicitly]:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">dos</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="ow">in</span><span class="o">.</span><span class="n">wg</span><span class="o">=</span><span class="n">t</span>
</pre></div>
</div>
</div>
<p>we get file DOS.totalspin.</p>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp DOS.totalspin DOS.totalspin.tot</p>
<p>Use IN.OCC_AIDA = T, PWmat will read file IN.OCC_ADIA and we will get
occupied desity of adiabatic states.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">double</span>
<span class="n">convergece</span><span class="o">=</span><span class="n">difficult</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">dos</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="ow">in</span><span class="o">.</span><span class="n">wg</span><span class="o">=</span><span class="n">t</span>
<span class="ow">in</span><span class="o">.</span><span class="n">occ_adia</span><span class="o">=</span><span class="n">t</span>
</pre></div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> cp DOS.totalspin DOS.totalspin.occ</p>
<p>plot DOS.totalspin.occ DOS.totalspin.tot,</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gnuplot&gt; plot &quot;DOS.totalspin.occ&quot; u 1:($2) w filledcurve lc rgb &quot;blue&quot;
         title &quot;DOS.occ&quot;,&quot;DOS.totalspin.tot&quot; u 1:2 w l lc rgb &quot;grey&quot;
         title &quot;DOS&quot;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="stability">
<h2>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h2>
<p>One can try to adjust the CONVERGENCE, PRECISION, DT(of MD_DETAIL) to
get more stable result. DT for TDDFT is recommended to be
<span class="math notranslate nohighlight">\(\le 0.1fs\)</span></p>
<div class="section" id="energy-diverge-problem">
<h3>Energy diverge Problem<a class="headerlink" href="#energy-diverge-problem" title="Permalink to this headline">¶</a></h3>
<p>Without external potential, the total energy may blow up in the process
of TDDFT.</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
<span class="n">Lattice</span> <span class="n">vector</span>
<span class="mf">5.65</span>      <span class="mf">0.0000000000</span>      <span class="mf">0.0000000000</span>
<span class="mf">0.0000000000</span>      <span class="mf">5.65</span>      <span class="mf">0.0000000000</span>
<span class="mf">0.0000000000</span>      <span class="mf">0.0000000000</span>      <span class="mf">5.65</span>
<span class="n">Position</span><span class="p">,</span> <span class="n">move_x</span><span class="p">,</span> <span class="n">move_y</span><span class="p">,</span> <span class="n">move_z</span>
<span class="mi">31</span>  <span class="mf">0.010000000000</span>  <span class="mf">0.000000000000</span>  <span class="mf">0.000000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">31</span>  <span class="mf">0.000000000000</span>  <span class="mf">0.501000000000</span>  <span class="mf">0.502000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">31</span>  <span class="mf">0.500000000000</span>  <span class="mf">0.000000000000</span>  <span class="mf">0.500000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">31</span>  <span class="mf">0.500000000000</span>  <span class="mf">0.500000000000</span>  <span class="mf">0.000000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">33</span>  <span class="mf">0.250000000000</span>  <span class="mf">0.250000000000</span>  <span class="mf">0.250000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">33</span> <span class="o">-</span><span class="mf">0.250000000000</span> <span class="o">-</span><span class="mf">0.250000000000</span>  <span class="mf">0.250000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">33</span> <span class="o">-</span><span class="mf">0.250000000000</span>  <span class="mf">0.250000000000</span> <span class="o">-</span><span class="mf">0.250000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
<span class="mi">33</span>  <span class="mf">0.250000000000</span> <span class="o">-</span><span class="mf">0.250000000000</span> <span class="o">-</span><span class="mf">0.250000000000</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot plot:</p>
<p>Methods to fix this are as follows.</p>
<div class="section" id="a-use-smaller-dtmd">
<h4>a. use smaller dtMD<a class="headerlink" href="#a-use-smaller-dtmd" title="Permalink to this headline">¶</a></h4>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot plot:</p>
</div>
<div class="section" id="b-use-proper-adiabatic-window">
<h4>b. use proper adiabatic window<a class="headerlink" href="#b-use-proper-adiabatic-window" title="Permalink to this headline">¶</a></h4>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>           <span class="mi">1</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">tddft</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp1</span>   <span class="o">=</span> <span class="mi">31</span><span class="o">-</span><span class="n">Ga</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="ow">in</span><span class="o">.</span><span class="n">psp2</span>   <span class="o">=</span> <span class="mi">33</span><span class="o">-</span><span class="n">As</span><span class="o">.</span><span class="n">LDA</span><span class="o">.</span><span class="n">fhi</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">TDDFT_DETAIL</span> <span class="o">=</span>  <span class="mi">4</span>      <span class="mi">26</span>      <span class="mi">26</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot plot:</p>
</div>
<div class="section" id="c-use-high-accuracy-or-convergence-difficult">
<h4>c. use high accuracy(or convergence=difficult)<a class="headerlink" href="#c-use-high-accuracy-or-convergence-difficult" title="Permalink to this headline">¶</a></h4>
<p>55 Ag atoms.</p>
<p>etot.input.low_accuracy</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>   <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>         <span class="o">=</span>  <span class="n">xatom</span>
<span class="n">JOB</span>             <span class="o">=</span>  <span class="n">TDDFT</span>
<span class="n">MD_DETAIL</span>       <span class="o">=</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>         <span class="o">=</span>  <span class="n">vwr</span><span class="o">.</span><span class="n">Ag</span><span class="o">+</span><span class="n">U</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>etot.input.high_accuracy</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>   <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>         <span class="o">=</span>  <span class="n">xatom</span>
<span class="n">JOB</span>             <span class="o">=</span>  <span class="n">TDDFT</span>
<span class="n">MD_DETAIL</span>       <span class="o">=</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>         <span class="o">=</span>  <span class="n">vwr</span><span class="o">.</span><span class="n">Ag</span><span class="o">+</span><span class="n">U</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">E_ERROR</span>         <span class="o">=</span>   <span class="mf">1.00E-005</span>
<span class="n">RHO_ERROR</span>       <span class="o">=</span>   <span class="mf">1.00E-005</span>
</pre></div>
</div>
</div>
<p>MDSTEPS–Etot plot:</p>
</div>
</div>
</div>
<div class="section" id="add-field-x-1">
<span id="id813"></span><h2>add_field.x<a class="headerlink" href="#add-field-x-1" title="Permalink to this headline">¶</a></h2>
<p>The program add_field.x in util can be used to get IN.VEXT_TDDFT. Check
detail:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">pwmat</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">util_add_field</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="job-namd">
<span id="section-namd"></span><h2>JOB=NAMD<a class="headerlink" href="#job-namd" title="Permalink to this headline">¶</a></h2>
<p>Non-adiabatic molecular dynamics (NAMD). Like TDDFT, NAMD is a way to
simulate the carrier dynamics. It is more suitable for large systems
where it is difficult to carry out a full TDDFT simulation. It ignores
the feedback from the carrier movement to the nuclear movement, or the
electron structure change of other electrons. The idea is that, the rest
of the electron (besides this carrier) can be described by the occupied
valence states (as in a usual Born-Oppenheimer MD). So, the nuclear
movement, as well as the electronic structure during the movement, are
described exactly as BO-MD. Such a BO-MD movement can be described by a
time dependent Hamiltonian H(t). Thus, NAMD is a by-product of the usual
BO-MD. The purpose is to study a carrier dynamics of wave function
<span class="math notranslate nohighlight">\(\psi(t)\)</span>, for the carrier riding on the BO-MD Hamiltonian H(t).
This is equivalent to say the occupation of <span class="math notranslate nohighlight">\(\psi(t)\)</span> is zero (so
there is no feedback from <span class="math notranslate nohighlight">\(\psi(t)\)</span> to nuclear movement and H(t)).
<span class="math notranslate nohighlight">\(\psi(t)\)</span> satisfies the time dependent Schrodinger’s equation
<span class="math notranslate nohighlight">\(i \partial \psi(t)/\partial \psi(t) = H(t) \psi(t)\)</span>, or its
variance including effects like surface hopping, Boltzmann correction,
or wave function collapsing. There are many problems where we are only
interested in the dynamics of this additional electron, but not the
nuclear movement or the response from the other electron, then this can
be the method to study such problem.</p>
<p>To carry out one NAMD study, one first does JOB=NAMD, which is exactly
the same as JOB=MD, also using MD_DETAIL to carry out the simulation.
However, the JOB=NAMD will output files OUT.NAMD and ugioallxxxxx, as
controlled by NAMD_DETAIL. It can also use external potential etc, as
input from TDDFT_SPACE, TDDFT_TIME, TDDFT_STIME, TDDFT_AFIELD. In
“MD_DETAIL=iMD,…”, it can only use iMD=1 (Verlet algorithm), but it
can also use iMD=11, as a RESTART. For the RESTART, OUT.WG from previous
run must be copied to IN.WG, and set IN.WG=T in etot.input. Also,
OUT.RHO can be copied into IN.RHO. Secondly, final.config from last NAMD
run should be used (or copied to) as input IN.ATOM file. Lastly, a
proper TDDFT_STIME (in the unit of <span class="math notranslate nohighlight">\(fs\)</span>) should also be set to the
end time of last NAMD run (e.g., TDDFT_STIME=1000) in etot.input. : For
the NAMD RESTART job, the time length DT in MD_DETAIL can not be
changed! In the rerun, the output will be appendix into the original
OUT.NAMD and ugioallxxxxx.</p>
<p>After the PWmat JOB=NAMD is finished, one can use NAMD_Boltzman.f in the
utility directory to carry out the actual Non-adiabatic dynamics.
Multiple runs can be carried out to explore different scenarios.</p>
<div class="section" id="namd-boltzman-f">
<h3>NAMD_Boltzman.f<a class="headerlink" href="#namd-boltzman-f" title="Permalink to this headline">¶</a></h3>
<p>This utility code is a open-source utility code to carry out NA-MD using
the JOB=NAMD output OUT.NAMD. The input file NAMD.input has the
following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100     ! MDstep: should be the same as from MDstep
        !         in &quot;MD_DETAIL=iMD,MDstep,dtMD,T1,T2&quot;
        !         in etot.input
21      ! nstates: mst2-mst1+1, from &quot;NAMD_DETAIL =
        !          mst2,mst1,mout&quot; in etot.input
1.0     ! dtMD (fs): should be the same as dtMD
        !            in etot.input
1  300  0.3  !  e(1)/h(-1), temperature(kevin),
             !  win_Boltz(eV), the temperature
             !  can be diff from T1,T2
5       ! mout: should be the same as ``NAMD_DETAIL
        !       = mst1,mst2,mout&#39;&#39; in etot.input
</pre></div>
</div>
</div>
<p>The win_Boltz is to define a window, when |E_i1-E_i2| smaller than
this window, then the transition between these two states will be
multiplied by a Boltzman factor to restore the detail balance between
these two states. If this wind_Boltz is zero, then no Boltzman factor is
added.</p>
<p>Like in the TDDFT simulation, the wave function <span class="math notranslate nohighlight">\(\psi(t)\)</span> will be
expanded by the adiabatic states <span class="math notranslate nohighlight">\(\phi_i(t)\)</span> (from the BO-MD eigen
states) <span class="math notranslate nohighlight">\(\psi(t)=\sum_{i=m_1,m_2} C_i(t) \phi_i(t)\)</span>. The initial
coefficient <span class="math notranslate nohighlight">\(C_i(t=0)\)</span> will be input from NAMD.cc_init. It has a
format like:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">21</span>     <span class="c1"># nstate=mst2-mst1+1</span>
<span class="mf">0.707</span><span class="p">,</span><span class="mf">0.0</span>  <span class="c1"># C_1(0)</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>  <span class="c1"># C_2(0)</span>
<span class="mf">0.707</span><span class="p">,</span><span class="mf">0.0</span>  <span class="c1"># C_3(0)</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>  <span class="c1"># C_4(0)</span>
<span class="o">.......</span>
</pre></div>
</div>
</div>
<p>The output of the NAMD_Boltzman.f run is reported in NAMD.graph.aveE,
NAMD.graph.eigen, NAMD.graph.cc. While the NAMD.graph.eigen reports the
individual adiabatic state <span class="math notranslate nohighlight">\(\phi_i(t)\)</span> eigen energies
<span class="math notranslate nohighlight">\(E_i(t)\)</span>, NAMD.graph.aveE reports the energy of <span class="math notranslate nohighlight">\(\psi(t)\)</span> as
a function of time t. NAMD.graph.cc reports the expansion coefficients
<span class="math notranslate nohighlight">\(C_i(t)\)</span> as a function of time. These data can be plotted, or
plotted using gnuplot with plot.db or plot2.db (<span class="math notranslate nohighlight">\(&gt;\)</span> gnuplot
plot.db)</p>
<p>Finally, the wave function <span class="math notranslate nohighlight">\(\psi(t)\)</span> can also be plotted in real
space <span class="math notranslate nohighlight">\(\psi(r)\)</span> with an interval mout*dtMD (defined in
NAMD.input). This can be done running NAMD_psi.x.</p>
</div>
<div class="section" id="example-b-14-2-namd">
<h3>example B.14.2: NAMD<a class="headerlink" href="#example-b-14-2-namd" title="Permalink to this headline">¶</a></h3>
<p>step1. run PWmat etot.input:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>           <span class="mi">1</span>
<span class="n">IN</span><span class="o">.</span><span class="n">ATOM</span>   <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">config</span>
<span class="n">JOB</span>       <span class="o">=</span> <span class="n">NAMD</span>
<span class="n">MD_DETAIL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span>
<span class="n">NAMD_DETAIL</span> <span class="o">=</span> <span class="mi">295</span><span class="p">,</span><span class="mi">315</span><span class="p">,</span><span class="mi">5</span>
<span class="n">NUM_BAND</span>  <span class="o">=</span> <span class="mi">335</span>
<span class="n">TDDFT_TIME</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="n">TDDFT_SPACE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">5.</span>
<span class="n">TDDFT_STIME</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP1</span>   <span class="o">=</span> <span class="n">Ga</span><span class="o">.</span><span class="n">nc</span><span class="o">.</span><span class="n">pbe</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP2</span>   <span class="o">=</span> <span class="n">As</span><span class="o">.</span><span class="n">nc</span><span class="o">.</span><span class="n">pbe</span><span class="o">.</span><span class="n">UPF</span>
<span class="n">IN</span><span class="o">.</span><span class="n">PSP3</span>   <span class="o">=</span> <span class="n">Cu</span><span class="o">.</span><span class="n">nc</span><span class="o">.</span><span class="n">pbe</span><span class="o">.</span><span class="n">UPF</span>
</pre></div>
</div>
</div>
<p>step2. run NAMD_Boltzman.x NAMD.input</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100     ! nstep
21      ! nstates
1.0     ! dt (fs)
1  300  0.3  !  e(1)/h(-1), temperature, win_Boltz(eV)
5       ! mout
</pre></div>
</div>
</div>
<p>NAMD.cc_init</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">21</span>
<span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
</pre></div>
</div>
</div>
<p>plot NAMD.graph.eigen,NAMD.graph.avE</p>
<p>plot NAMD.graph.cc</p>
<p>plot wavefunction use NAMD_psi.x</p>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> NAMD_psi.x</p>
<p>plot wavefunction use plot_wg.x</p>
<p><span class="math notranslate nohighlight">\(&gt;\)</span> plot_wg.x</p>
</div>
</div>
<div class="section" id="in-occ-t">
<h2>IN.OCC_T<a class="headerlink" href="#in-occ-t" title="Permalink to this headline">¶</a></h2>
<p>If we have:</p>
<p>IN.OCC_T = T</p>
<p>Then, it will read in file IN.OCC_T (and IN.OCC_T2 if spin=2), and it
will ignore the imth_Fermi flag In the SCF_ITERx_x line.</p>
<p>Inside IN.OCC_T, we currently have the following format:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nline</span><span class="p">,</span> <span class="n">nkpt</span>
<span class="o">****</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span> <span class="o">*****</span>
<span class="n">Istate</span><span class="p">,</span> <span class="n">iformula</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a5</span>
<span class="n">Xxxxx</span>
<span class="n">nlines</span>
<span class="o">****</span> <span class="n">kpt</span><span class="o">=</span> <span class="mi">2</span> <span class="o">******</span>
<span class="n">Istate</span><span class="p">,</span><span class="n">iformula</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span>
<span class="n">Xxxxx</span>
</pre></div>
</div>
</div>
<p>One example is:</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span>
<span class="o">***</span> <span class="n">kpt</span><span class="o">=</span><span class="mi">1</span> <span class="o">****</span>
<span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
<span class="o">****</span><span class="n">kpt</span><span class="o">=</span><span class="mi">2</span> <span class="o">****</span>
<span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
<p>The nline indicate how many states (bands) one need the time-dependent
occ(t) correction. Nkpt is the number of k-points.</p>
<p>The istate is the index for one band ( psi_istate ) which needs time
dependent modification for occ(t).</p>
<p>Iformula is the flag for formula. A1,a2,a3,a4,a5 are five parameter.</p>
<p>We have the following two formula:</p>
<p>Iformula=1</p>
<p>For time <span class="math notranslate nohighlight">\(&lt;\)</span> a1: Occ(t,istate)=occ(0,istate)+(time/a1)*a2</p>
<p>For time <span class="math notranslate nohighlight">\(&gt;=\)</span> a1: Occ(t,istate)=occ(0,istate)+a2</p>
<p>Iformula=2</p>
<p>For time <span class="math notranslate nohighlight">\(&lt;\)</span>a1,
Occ(t,istate)=occ(0,istate)+(1-cos(pi*time/a1/2)**2)*a2</p>
<p>For time <span class="math notranslate nohighlight">\(&gt;=\)</span>a1: Occ(t,istate)=occ(0,istate)+a2</p>
<p>So, at this moment, a3,a4,a5 are never used.</p>
<p>This change of occ(i) is used to describe some electron state is
suddenly removed (or added) to the system from some specific states. It
is different from the use of IN.OCC. In IN.OCC, a selfconsistent
solution is achieved making some state empty or occupied not according
to Fermi-Dirac distribution. But the solution of IN.OCC is the
occupation of pure eigen states in the H(N-1) (remove one electron) or
H(N+1) (add one electron) Hamiltonian. For the use of IN.OCC_T, it could
be that the original H(N) eigen state psi_istate is removed, so at
H(N-1), the states which is removed (or still occupied) might not be the
eigen states of H(N-1) (but they might be close to the eigen states of
H(N), if parameter a1 is short enough)</p>
</div>
<div class="section" id="in-tddftopt">
<h2>IN.TDDFTOPT<a class="headerlink" href="#in-tddftopt" title="Permalink to this headline">¶</a></h2>
<p>IN.TDDFTOPT = T/F</p>
<p>In file IN.TDDFTOPT one can set:</p>
<ol class="arabic simple">
<li><p>OUT.MDDIPOLE.RSPACE=T/F, default=T.</p></li>
</ol>
<p>If T, write file MDDIPOLE.RSPACE each time step.</p>
<ol class="arabic simple" start="2">
<li><p>OUT.MDDIPOLE.KSPACE=T/F, default=F.</p></li>
</ol>
<p>If T, write file MDDIPOLE.KSPACE each time step.</p>
<ol class="arabic simple" start="3">
<li><p>TDDFT_SEED, default=12345.</p></li>
</ol>
<p>Random seed for initializing the wavefunctions and velocities. If
TDDFT_SEED=-1, the random seed will be set using the system_clock(). If
this is not set, a default 12345 will be used.</p>
<p>4. Besides the TDDFT_SAPCE and TDDFT_TIME, One can use file IN.TDDFTOPT
to input external potential by setting TD_EFIELD or TD_EFIELD_LIST_*.
The details are as follows.</p>
<p>(unit: energys–Hartree, coordinates—fractional in [0,1], time — fs)</p>
<div class="spacing docutils container">
<p>1.2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TD_EFIELD</span><span class="o">=</span><span class="n">efield_type</span> <span class="n">num_pars</span> <span class="n">pars_list</span>
<span class="n">TD_EFIELD_LIST_1</span><span class="o">=</span><span class="n">efield_type</span> <span class="n">num_pars</span> <span class="n">pars_list</span>
<span class="n">TD_EFIELD_LIST_2</span><span class="o">=</span><span class="n">efield_type</span> <span class="n">num_pars</span> <span class="n">pars_list</span>
<span class="n">TD_EFIELD_LIST_3</span><span class="o">=</span><span class="n">efield_type</span> <span class="n">num_pars</span> <span class="n">pars_list</span>
<span class="o">...</span>
<span class="n">TD_EFIELD_LIST_20</span><span class="o">=</span><span class="n">efield_type</span> <span class="n">num_pars</span> <span class="n">pars_list</span>

<span class="o">---</span><span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">-------</span><span class="c1">#---[efield_type num_pars pars_list]---------#</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span>     <span class="p">[</span><span class="n">nontd_linear_x</span> <span class="mi">4</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span>     <span class="p">[</span><span class="n">nontd_linear_y</span> <span class="mi">4</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span>     <span class="p">[</span><span class="n">nontd_linear_z</span> <span class="mi">4</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="n">Er</span><span class="o">*</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">order</span><span class="p">,</span><span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">=</span><span class="n">Emax</span> <span class="k">if</span> <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">&gt;</span><span class="n">Emax</span>
                    <span class="p">[</span><span class="n">nontd_well_poly</span> <span class="mi">6</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">order</span><span class="p">,</span><span class="n">Er</span><span class="p">,</span><span class="n">Emax</span><span class="p">]</span>
<span class="o">-------------------------------------------------------------</span><span class="c1">#</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">delta</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_kick_x</span> <span class="mi">5</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">delta</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_kick_y</span> <span class="mi">5</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">delta</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_kick_z</span> <span class="mi">5</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
<span class="o">-------------------------------------------------------------</span><span class="c1">#</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_x</span> <span class="mi">6</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_y</span> <span class="mi">6</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_z</span> <span class="mi">6</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">]</span>
<span class="o">-------------------------------------------------------------</span><span class="c1">#</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_xz</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_yz</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_xy</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_zy</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_yx</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_gaussian_sin_zx</span> <span class="mi">9</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
<span class="o">------------------------------------------------------------</span><span class="c1">#</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_xz</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_yz</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">Ex</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_xy</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ex</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_zy</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">Ey</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_yx</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ey</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
 <span class="n">E</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="n">Ez</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">td_cos_zx</span> <span class="mi">7</span> <span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">Ez</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">phi</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="more-output-files">
<h2>MORE OUTPUT FILES<a class="headerlink" href="#more-output-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mddipole-rspace">
<h3>MDDIPOLE.RSPACE<a class="headerlink" href="#mddipole-rspace" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[P_{\sigma}(t)=\int \rho(r,t)*\sigma d^3r, \sigma \in {x,y,z}\]</div>
</div>
<div class="section" id="mddipole-kspace">
<h3>MDDIPOLE.KSPACE<a class="headerlink" href="#mddipole-kspace" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{\partial P(t)}{\partial t}\]</div>
</div>
<div class="section" id="mdint-rhovext">
<h3>MDINT.RHOVEXT<a class="headerlink" href="#mdint-rhovext" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\int \rho(r,t)*V_{external}(r,t) d^3r\]</div>
<div class="thebibliography docutils container">
<p>999</p>
<p><strong>PWmat Reference</strong></p>
<p>Jia, W., Fu, J., Cao, Z., Wang, L., Chi, X., Gao, W. &amp; Wang, L. W.
(2013). <em>Fast plane wave density functional theory molecular dynamics
calculations on multi-GPU machines. Journal of Computational Physics.
251, 102-115.</em></p>
<p>Jia, W., Fu, J., Cao, Z., Wang, L., Chi, X., Gao, W. &amp; Wang, L. W.
(2013). <em>The analysis of a plane wave pseudopotential density
functional theory code on a GPU machine. Computer Physics
Communications. 184(1), 9-18.</em></p>
<p>Zhi Wang, Shu-Shen Li, and Lin-Wang Wang. <em>Effcient Real-Time
Time-Dependent Density Density Functional Theory Method and its
Application to a Collision of an Ion with a 2D Material. Physical
Review Letters. 114, 063903(2015).</em></p>
<p>Verlet, Loup. <em>Computer “Experiments” on Classical Fluids. I.
Thermodynamical Properties of Lennard Jones Molecules. Physical
Review. 159, 98-103(1967)).</em></p>
<p>A. Brünger, C. L. Brooks III, M. Karplus. <em>Stochastic boundary
conditions fro molecular dynamics simulations of ST2 water. Chem.
Phys. Letters, 1984, 105 (5) 495-500.</em></p>
<p>Nose, S. <em>A unified formulation of the constant temperature
molecular-dynamics methods. Journal of Chemical Physics. 81,
1(1984).</em></p>
<p>Hoover, William G. <em>Canonical dynamics: Equilibrium phase-space
distribution. Phys. Rev. A. 31, 3(1985).</em></p>
<p>Berendsen <em>to be filled later</em></p>
<p>Berendsen <em>to be filled later, for cell scaling</em></p>
<p>M. Parrinello, A. Rahman. <em>Polymorphic transitions in single
crystals: A new molecular dynamics method. Journal of Applied Physics
52, 7182 (1981).</em></p>
<p>D.Quigley, M.I.J. Probert. <em>Constant pressure Langevin dynamics:
theory and application. Computer Physics Communications 169(2005)
322-325.</em></p>
<p>G.J.Martyna, J.T. Tobias, M.L. Klein. <em>Constant pressure modecular
dynamics algorithms, J. Chem. Phys. 101(5)(1994) 4177-4189.</em></p>
<p>O. Andreussi, I. Dabo and N. Marzari. <em>Revised self-consistent
continuum solvation in electronic-structure calculations. J. Chem.
Phys. 136, 064102(2012).</em></p>
<p>Reed, Fried, and Joannopoulos. <em>Phys.Rev.Lett., 90, 235503 (2003).</em></p>
<p>K. Letchworth-Weaver, T.A. Arias <em>Joint density functional theory of
the electrode-electolyte interface: Application to fixed electrode
potentials, interfacial capacitances, and potentials of zero charge.
Phys. Rev. B 86, 075140 (2012).</em></p>
<p>H. Jonsson, G. Mills and K. W. Jacobsen. <em>’Nudged Elastic Band Method
for Finding Minimum Energy Paths of Transitions’ in ’Classical and
Quantum Dynamics in Condensed Phase Simulations’, ed. B. J. Berne, G.
Ciccotti and D.F.Coker(World Scientific, 1998).</em></p>
<p>G. Henkelman and H. Jonsson, <em>Improved Tangent Estimate in the NEB
method for Finding Minimum Energy Paths and Saddle Points, J. Chem.
Phys. 113, 9978 (2000)</em></p>
<p>G. Henkelman, B. P. Uberuaga and H. Jonsson, <em>A Climbing-Image NEB
Method for Finding Saddle Points and Minimum Energy Paths, J. Chem.
Phys. 113, 9901 (2000)</em></p>
<p>EsbenL.Kolsbjerg,MichaelN.Groves,and Bjork Hammer, <em>An automated
nudged elastic band method, J. Chem. Phys. 145, 094107 (2016)</em></p>
<p>Erik Bitzek,Pekka Koskinen,Franz Gahler,Michael Moseler,and Peter
Gumbsch , <em>Structural Relaxation Made Simple,PRL 97, 170201 (2006)</em></p>
<p>Miguel A. L. Marques, Micael J. T. Oliveira, Tobias Burnus. <em>LIBXC: a
library of exchange and correlation functionals for density
functional theory. Comput. Phys. Commun. 183, 2272(2012).</em></p>
<p>Susi Lehtola, Conrad Steigemann, Micael J. T. Oliveira, Miguel A. L.
Marques. <em>Recent developments in LIBXC-A comprehensive library of
functional for density functional theory. Software X, 7, 1(2018).</em></p>
<p>P Gomes Dacosta, O H Nielsen and K Kunc. <em>Stress theorem in the
determination of static equilibrium by the density functional method.
J. Phys. C: Solid State Phys. 19, 3163-3172(1986)</em></p>
<p>S. Grimme, J. Antony, S. Ehrlich, and S. Krieg. <em>A consistent and
accurate ab initio parametrization of density functional dispersion
correction (dft-d) for the 94 elements H-Pu. J. Chem. Phys. 132,
154104 (2010).</em></p>
<p>Kiran Mathew, Ravishankar Sundararaman, Kendra Letchworth-Weaver, T.
A. Arias, and Richard G. Hennig.<em>Implicit solvation model for
density-functional study of nanocrystal surfaces and reaction
pathways. The Journal of Chemical Physics 140, 084106 (2014).</em></p>
<p>Oliviero Andreussi, Ismaila Dabo, and Nicola Marzari. <em>Revised
self-consistent continuum solvation in electronic-structure
calculations. The Journal of Chemical Physics 136, 064102 (2012).</em></p>
<p>G. Fisicaro, L. Genovese, O. Andreussi, N. Marzari, S. Goedecker. <em>A
generalized Poisson and Poisson-Boltzmann solver for electrostatic
environments. The Journal of Chemical Physics 144, 014103 (2016).</em></p>
<p>J.Ma, L.-W. Wang. <em>Using Wannier functions to improve solid band gap
predictions in density functional theory. Sci. Rep. 6, 24924 (2016).</em></p>
<p>M. Cococcioni, S. de Gironcoli. <em>Linear response approach to the
calculation of the effective interaction Parameters in the LDA+U
method, Phys. Rev. B, 71, 035105 (2005).</em></p>
<p>Fan Zheng, Hieu H. Pham, Lin-Wang Wang. <em>Effects of the c-Si/a-SiO2
interfacial atomic structure on its band alignment: an ab initio
study, Phys. Chem. Chem. Phys., 19, 32617 (2017).</em></p>
<p>I. Souza, J. Í<span class="math notranslate nohighlight">\(\tilde{n}iguez\)</span>, and D. Vanderbilt.
<em>First-Principles Approach to Insulators in Finite Electric Fields,
Phys. Rev. Lett, 89, 117602 (2002).</em></p>
<ol class="upperalpha simple">
<li><p>Pieper, M. Kreutzer, A. Alvermann, M. Galgon, H. Fehske, G. Hager,</p></li>
</ol>
<p>B. Lang, G. Wellein. <em>High-performance implementation of Chebyshev
filter diagonalization for interior eigenvalue computations, J. Comp.
Phys. 325 (2016) 226–243</em></p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../PWmat.html" class="btn btn-neutral float-left" title="PWmat" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, LongXun.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>